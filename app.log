2025-03-24 13:16:57,087 - app.api.router - INFO - Templates directory: d:\ThucTap\ChatBotKinhTe\app\web\templates
2025-03-24 13:16:57,088 - app.api.router - INFO - Static files mounted from: d:\ThucTap\ChatBotKinhTe\app\web\static
2025-03-24 13:17:09,882 - app.api.router - INFO - Templates directory: d:\ThucTap\ChatBotKinhTe\app\web\templates
2025-03-24 13:17:09,882 - app.api.router - INFO - Static files mounted from: d:\ThucTap\ChatBotKinhTe\app\web\static
2025-03-24 13:23:31,831 - app.api.router - INFO - Templates directory: d:\ThucTap\ChatBotKinhTe\app\web\templates
2025-03-24 13:23:31,831 - app.api.router - INFO - Static files mounted from: d:\ThucTap\ChatBotKinhTe\app\web\static
2025-03-24 14:04:10,039 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-03-24 14:04:10,156 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-03-24 14:04:30,642 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-03-24 14:04:30,642 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-24 14:04:33,995 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-03-24 14:04:33,999 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-24 14:04:34,179 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-24 14:04:34,186 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-24 14:04:34,293 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-03-24 14:04:36,834 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-03-24 14:04:36,836 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-03-24 14:05:19,634 - app.services.chatbot - INFO - Answer generated successfully
2025-03-24 14:05:19,636 - app.api.endpoints.chat - INFO - Successfully generated response
2025-03-24 14:23:29,151 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-03-24 14:23:29,189 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-03-24 14:23:33,925 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-03-24 14:23:33,925 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-24 14:23:37,496 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-03-24 14:23:37,499 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-24 14:23:37,514 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-24 14:23:37,520 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-24 14:23:37,626 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-03-24 14:23:39,995 - app.services.chatbot - INFO - Loaded LLM model from models/Vi-Qwen2-3B-RAG.Q4_0.gguf
2025-03-24 14:23:39,998 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-03-24 14:26:16,421 - app.services.chatbot - INFO - Answer generated successfully
2025-03-24 14:26:16,421 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-03 23:51:42,606 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-03 23:51:42,725 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-03 23:51:47,802 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-03 23:51:47,802 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-03 23:51:51,469 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-03 23:51:51,472 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-03 23:51:51,545 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-03 23:51:51,550 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-03 23:51:51,651 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-03 23:51:54,079 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-03 23:51:54,080 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-03 23:53:20,181 - app.services.chatbot - INFO - Answer generated successfully
2025-04-03 23:53:20,181 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-04 00:06:57,563 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 00:14:01,780 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 00:22:50,833 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 00:25:53,554 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 00:25:58,698 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-04 00:25:58,699 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 00:26:02,108 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 00:26:02,110 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 00:26:02,240 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 00:26:02,244 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 00:26:02,245 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 00:26:02,776 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-04 00:26:02,777 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 00:27:32,878 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 00:27:32,878 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-04 19:26:20,484 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 19:26:20,570 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 19:26:33,193 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 19:26:33,194 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:26:38,330 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 19:26:38,336 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 19:26:38,669 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 19:26:38,681 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 19:26:38,683 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 19:26:38,687 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Could not import llama-cpp-python library. Please install the llama-cpp-python library to use this embedding model: pip install llama-cpp-python
2025-04-04 19:26:38,688 - app.services.chatbot - ERROR - Error generating answer: Could not import llama-cpp-python library. Please install the llama-cpp-python library to use this embedding model: pip install llama-cpp-python
2025-04-04 19:26:38,689 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-04 22:17:49,313 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled, device: cuda)
2025-04-04 22:17:49,342 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:17:49,536 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:17:49,536 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:17:54,400 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:17:54,402 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:17:54,497 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:17:54,503 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:17:54,510 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:17:54,510 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:17:55,067 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff822-5be73e71101d05e55274c045;932d4f4b-bd57-48c5-be7d-3e8d4161cd79)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:17:55,069 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff822-5be73e71101d05e55274c045;932d4f4b-bd57-48c5-be7d-3e8d4161cd79)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:17:57,086 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:17:57,089 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:17:57,089 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:00,152 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:00,152 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:18:00,152 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:18:00,703 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff828-174472465dd128180ce37de2;cae6e3af-1a44-4947-8ca2-8e36aa348e3f)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:18:00,713 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff828-174472465dd128180ce37de2;cae6e3af-1a44-4947-8ca2-8e36aa348e3f)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:18:02,740 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:18:02,743 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:18:02,744 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:06,069 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:06,069 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:18:06,069 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:18:06,637 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff82e-40da51b64da9d1862805cc2d;f75278d3-45ec-4d6e-b8fc-bc69f7cbbc38)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:18:06,647 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff82e-40da51b64da9d1862805cc2d;f75278d3-45ec-4d6e-b8fc-bc69f7cbbc38)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:18:54,692 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled, device: cuda)
2025-04-04 22:18:54,703 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:18:54,840 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:18:54,842 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:59,136 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:18:59,136 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:18:59,168 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:18:59,177 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:18:59,178 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:18:59,179 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:18:59,778 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff863-2798db046dff032d57d73aaa;9006aa35-7c36-476b-8f4a-5a5142580983)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:18:59,780 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff863-2798db046dff032d57d73aaa;9006aa35-7c36-476b-8f4a-5a5142580983)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:19:01,798 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:19:01,802 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:19:01,802 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:19:05,703 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:19:05,703 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:19:05,703 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:19:06,260 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff86a-7b792cc55a197ef157e0b769;e15eee3a-c178-4aef-851e-bf7446eb2708)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:19:06,261 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff86a-7b792cc55a197ef157e0b769;e15eee3a-c178-4aef-851e-bf7446eb2708)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:19:08,279 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:19:08,281 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:19:08,281 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:19:11,330 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:19:11,330 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:19:11,330 - app.services.chatbot - INFO - Loading HuggingFace model from mistralai/Mistral-7B-Instruct-v0.2
2025-04-04 22:19:11,924 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff86f-6e65fedc0775fa09320fa6c9;49523093-ce74-49e7-b9f0-1497ccf05373)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:19:11,931 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2.
401 Client Error. (Request ID: Root=1-67eff86f-6e65fedc0775fa09320fa6c9;49523093-ce74-49e7-b9f0-1497ccf05373)

Cannot access gated repo for url https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2/resolve/main/config.json.
Access to model mistralai/Mistral-7B-Instruct-v0.2 is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:23:28,297 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled, device: cuda)
2025-04-04 22:23:28,298 - app.services.chatbot - INFO - Processing query: Kinh tế học là gì?
2025-04-04 22:23:28,298 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:23:28,419 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:23:28,419 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:23:33,102 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:23:33,105 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:23:33,127 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:23:33,134 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:23:33,135 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:23:33,135 - app.services.chatbot - INFO - Loading HuggingFace model from google/gemma-2b-it
2025-04-04 22:23:33,703 - app.services.chatbot - ERROR - Error initializing ChatbotService components: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/google/gemma-2b-it.
401 Client Error. (Request ID: Root=1-67eff975-2e5011ca55d6023156a3b206;c274238e-37d8-4151-a98f-840b28c9c70b)

Cannot access gated repo for url https://huggingface.co/google/gemma-2b-it/resolve/main/config.json.
Access to model google/gemma-2b-it is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:23:33,713 - app.services.chatbot - ERROR - Error generating answer: You are trying to access a gated repo.
Make sure to have access to it at https://huggingface.co/google/gemma-2b-it.
401 Client Error. (Request ID: Root=1-67eff975-2e5011ca55d6023156a3b206;c274238e-37d8-4151-a98f-840b28c9c70b)

Cannot access gated repo for url https://huggingface.co/google/gemma-2b-it/resolve/main/config.json.
Access to model google/gemma-2b-it is restricted. You must have access to it and be authenticated to access it. Please log in.
2025-04-04 22:23:35,719 - app.services.chatbot - INFO - Processing query: Giải thích về lạm phát và ảnh hưởng của nó?
2025-04-04 22:23:35,724 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:23:35,728 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:23:35,729 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:25:52,945 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled, device: cuda)
2025-04-04 22:25:52,945 - app.services.chatbot - INFO - Processing query: Kinh tế học là gì?
2025-04-04 22:25:52,945 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:25:53,217 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:25:53,217 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:25:57,556 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:25:57,560 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:25:57,583 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:25:57,591 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:25:57,593 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:25:57,593 - app.services.chatbot - INFO - Loading HuggingFace model from TinyLlama/TinyLlama-1.1B-Chat-v1.0
2025-04-04 22:26:01,043 - app.services.chatbot - INFO - Loaded tokenizer
2025-04-04 22:26:01,043 - app.services.chatbot - INFO - Using CUDA device: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-04 22:27:09,038 - accelerate.utils.modeling - INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2025-04-04 22:27:11,922 - app.services.chatbot - INFO - Loaded model
2025-04-04 22:27:11,954 - app.services.chatbot - INFO - Created text generation pipeline
2025-04-04 22:27:11,954 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 22:27:42,272 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 22:27:44,287 - app.services.chatbot - INFO - Processing query: Giải thích về lạm phát và ảnh hưởng của nó?
2025-04-04 22:28:17,598 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 22:28:19,612 - app.services.chatbot - INFO - Processing query: Thế nào là tăng trưởng kinh tế bền vững?
2025-04-04 22:28:41,977 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 22:34:37,001 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 22:34:37,002 - app.services.chatbot - INFO - Processing query: Kinh tế học là gì?
2025-04-04 22:34:37,002 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:34:45,633 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:34:45,633 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:34:50,122 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:34:50,129 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:34:50,151 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:34:50,160 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:34:50,161 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:34:50,162 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with n_gpu_layers=8
2025-04-04 22:34:55,718 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-04 22:34:55,761 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 22:37:41,363 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 22:37:41,364 - app.services.chatbot - INFO - Processing query: Kinh tế học là gì?
2025-04-04 22:37:41,365 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 22:37:49,918 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 22:37:49,918 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:37:53,934 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 22:37:53,946 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 22:37:53,970 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 22:37:53,979 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 22:37:53,980 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 22:37:53,980 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-04 22:37:57,690 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-04 22:37:57,739 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 23:48:56,042 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 23:48:56,042 - app.api.endpoints.chat - INFO - Received direct chat request from user None: kinh tế học là gì
2025-04-04 23:48:56,042 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-04 23:48:56,042 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 23:49:06,285 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 23:49:06,286 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 23:49:11,067 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 23:49:11,071 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 23:49:11,149 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 23:49:11,159 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 23:49:11,162 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 23:49:11,162 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-04 23:49:12,652 - app.services.chatbot - INFO - Loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-04 23:49:12,656 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 23:49:18,082 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 23:49:18,083 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-04 23:56:54,575 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-04 23:56:54,575 - app.api.endpoints.chat - INFO - Received direct chat request from user None: kinh tế học là gì
2025-04-04 23:56:54,575 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-04 23:56:54,575 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-04 23:57:00,983 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-04 23:57:00,983 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 23:57:14,633 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-04 23:57:14,635 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-04 23:57:14,649 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-04 23:57:14,654 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-04 23:57:14,655 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-04 23:57:14,655 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-04 23:57:15,909 - app.services.chatbot - INFO - Loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-04 23:57:15,911 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-04 23:57:36,844 - app.services.chatbot - INFO - Answer generated successfully
2025-04-04 23:57:36,845 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 00:00:58,845 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-05 00:00:58,846 - app.services.chatbot - INFO - Processing query: Kinh tế học là gì?
2025-04-05 00:00:58,846 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 00:01:02,137 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 00:01:02,138 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:01:06,254 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:01:06,258 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 00:01:06,279 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 00:01:06,286 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 00:01:06,288 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 00:01:06,288 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-05 00:01:11,762 - app.services.chatbot - INFO - Loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-05 00:01:11,799 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 00:09:36,308 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-05 00:09:36,309 - app.api.endpoints.chat - INFO - Received direct chat request from user None: kinh tế học là gì
2025-04-05 00:09:36,309 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 00:09:36,309 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 00:09:43,314 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 00:09:43,315 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:09:47,711 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:09:47,712 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 00:09:47,725 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 00:09:47,736 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 00:09:47,736 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 00:09:47,737 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-05 00:09:49,238 - app.services.chatbot - INFO - Loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-05 00:09:49,241 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 00:10:11,506 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 00:10:11,506 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 00:14:42,350 - app.services.chatbot - INFO - ChatbotService instance created (lazy loading enabled)
2025-04-05 00:14:42,352 - app.api.endpoints.chat - INFO - Received direct chat request from user None: kinh tế học là gì
2025-04-05 00:14:42,352 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 00:14:42,352 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 00:14:48,548 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 00:14:48,548 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:15:02,873 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 00:15:02,873 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 00:15:02,891 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 00:15:02,895 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 00:15:02,895 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 00:15:02,895 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 00:15:04,191 - app.services.chatbot - INFO - Loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf
2025-04-05 00:15:04,194 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 00:15:26,035 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 00:15:26,035 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 00:16:32,439 - app.api.endpoints.chat - INFO - Received direct chat request from user None: kinh tế học là gì
2025-04-05 00:16:32,440 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 00:16:32,576 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 00:16:32,576 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 00:17:16,989 - app.api.endpoints.chat - INFO - Received chat request from user None: kinh tế học là gì
2025-04-05 00:17:16,989 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 00:17:17,130 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 00:17:17,130 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 01:07:41,562 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:07:47,495 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:07:47,495 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:07:52,276 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:07:52,276 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:07:52,304 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:07:52,309 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:07:52,311 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:07:52,311 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:07:53,656 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:07:53,659 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:08:22,623 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:08:28,038 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:08:28,038 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:08:32,075 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:08:32,075 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:08:32,106 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:08:32,111 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:08:32,112 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:08:32,112 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:08:33,344 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:08:33,347 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:08:35,019 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:08:40,029 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:08:40,029 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:08:50,686 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:08:50,686 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:08:50,704 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:08:50,709 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:08:50,710 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:08:50,710 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:08:51,976 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:08:51,978 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:13:10,228 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:13:15,630 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:13:15,630 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:13:21,413 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:13:21,413 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:13:21,428 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:13:21,435 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:13:21,436 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:13:21,436 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:13:22,633 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:13:22,635 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:13:24,252 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:13:28,821 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:13:28,822 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:13:32,283 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:13:32,283 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:13:32,299 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:13:32,314 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:13:32,314 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:13:32,314 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:13:33,471 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:13:33,471 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:16:58,875 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:17:04,363 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:17:04,364 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:17:08,374 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:17:08,374 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:17:08,389 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:17:08,408 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:17:08,409 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:17:08,409 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:17:09,532 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:17:09,534 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:17:11,020 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:17:15,393 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:17:15,393 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:17:18,769 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:17:18,769 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:17:18,796 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:17:18,801 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:17:18,802 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:17:18,803 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:17:19,969 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:17:19,971 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:28:02,991 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: kinh te
2025-04-05 01:28:02,991 - app.services.chatbot - INFO - Processing query: kinh te
2025-04-05 01:28:09,866 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:28:09,866 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 01:28:51,579 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: kinh tế học là gì
2025-04-05 01:28:51,580 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 01:28:52,190 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:28:52,190 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 01:29:06,498 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: kinh tế học là gì
2025-04-05 01:29:06,498 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 01:29:06,637 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:29:06,637 - app.api.endpoints.chat - INFO - Successfully generated response
2025-04-05 01:33:01,393 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:33:06,878 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:33:06,879 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:33:11,591 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:33:11,594 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:33:11,607 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:33:11,613 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:33:11,613 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:33:11,614 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:33:12,777 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:33:12,779 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:33:14,434 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-05 01:33:18,949 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-05 01:33:18,949 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:33:22,399 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-05 01:33:22,411 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-05 01:33:22,426 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-05 01:33:22,432 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-05 01:33:22,433 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-05 01:33:22,434 - app.services.chatbot - INFO - Loading GGUF model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with n_gpu_layers=-1
2025-04-05 01:33:23,644 - app.services.chatbot - INFO - Successfully loaded LLM model from models/Llama-3.2-1B-Instruct-Q5_K_M.gguf with GPU acceleration
2025-04-05 01:33:23,646 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-05 01:33:41,524 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: kinh tế học là gì
2025-04-05 01:33:41,524 - app.services.chatbot - INFO - Processing query: kinh tế học là gì
2025-04-05 01:34:01,770 - app.services.chatbot - INFO - Generated answer:  

[SYS] 

1. Kinh tế học là ngành khoa học nghiên cứu về cách các cá nhân, doanh, và các tổ chức xã...
2025-04-05 01:34:01,770 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:34:01,771 - app.api.endpoints.chat - INFO - Generated answer: {'answer': ' \n\n[SYS] \n\n1. Kinh tế học là ngành khoa học nghiên cứu về cách các cá nhân, doanh, và các tổ chức xã hội đưa ra quyết định về sử dụng tài hạn để đáp nhu cầu vô.\n2 Kinh tế là một phần của kinh tế toàn thể thống trị.\n\n 3. Kinh tế toàn thống trị là sự kết nối và tương tác các nền tảng quốc gia trên toàn thế giới\n Các yếu tố như thương mại quốc tế, đầu tư biên, và các chính sách toàn ảnh hưởng sự phát triển nền kinh toàn thể.\n\n4. Tỷ hối là tỷ trao giữa đồng tiền của các quốc gia khác.\n Tỷ có thay đổi theo thời phụ thuộc vào các yếu tố: \n   cung ngoại tệ chính\n  chính tiền\n  tình kinh tế\n\n2 Kinh vĩ là phần kinh học nghiên về nền kinh nói, bao gồm chỉ số tổng quát như GDP, tỷ lệ thất nghiệp và lạm phát, chính sách tài khóa và tiền của chính. Theo thống 2.1. Kinh vĩ là ngành nghiên cứu cơ bản kinh học nghiên về các yếu tố kinh tế, chính, quy mô theo thời gian để hiểu ra nguyên nhân dẫn đến sự hình thành các hiệu thị. 2. Kinhĩ nghiên theo hai trường phái khoa học\n- Trường đại diện phương pháp kinh học có thể nói: \n1) nền tảng phương kinh là cơ sở của kinh tế.\n2) tiền là nguồn là chất lượng làm cho giá trong sản xuất.3 tiền là chì là tiền chất làm cho giá trị sản phẩm 4 là vật chất thị là chất làm giá.\n\n- trường đại phương pháp có học\n1 nghiên xét kinh là nguyên nhân dẫn tới sự hình thành hiệu\n2 nghiên kinh là phân tích các yếu tố cơ bản của thị\n\n5. Kinh vĩ là học ngành nghiên cứu theo thời gian để hiểu ra nguyên nhân dẫn đến sự hình thành các hiệu.\n6. Kinhĩ là ngành nghiên các vấn về số, kinh tế 7 Kinh là ngành nghiên cơ sở kinh tế và xã hội.\n\n2 Kinh tế vi là phần kinh học nghiên nền kinh nói của kinh bao gồm chỉ số tổng quá như GDP tỷ lệ thất nghiệp lạm phát chính tài khóa tiền chính thống2. Kinh vi là nghiên theo hai trường phái khoa\n- trường đại phương có quan kiến là \n1 nền tảng là cơ sở kinh\n2 là chất làm giá\n3 chì chất làm\n4 vật làm\n\n - trường đại phương quan \n\n1 nghiên kinh là phân tích các yếu cơ bản thị\n2 kinh là xem xét kinh là nguyên dẫn tới hình thành hiệu\n- đại phương quan quan\n\n nghiên là vấn là phân tích số  và nghiên theo thời để hiểu nguyên dẫn tới hình hiệu của\n\n7 Kinh tế vi học là ngành học nghiên về nền kinh nói, bao gồm chỉ số tổng quá như GDP tỷ lệ nghiệp lạm phát chính tài chính thống2 Kinh vi học là nghiên các vấn về số kinh tế và xã\nKinh học cơ học nghiên các vấn số và các vấn kinh thuộc khoa học nghiên kinh tế quốc học kinh tế 2. Kinh học là ngành nghiên cơ kinh học nghiên theo thời để ra nguyên dẫn tới hình hiệu của\n\n2. Kinh học là nghiên vấn kinh học phân tích các yếu cơ thị\n3 kinh nghiên kinh xem là phân tích các yếu thị kinh \n4 nghiên là vấn phân số và nghiên theo thời hiểu nguyên để dẫn hiệu 8 Kinh học là ngành nghiên nền kinh học, bao gồm kinh vi, kinh toàn, kinh quốc\n\n9 Kinh học là nghiên cơ học kinh nghiên theo thời để ra nguyên tới dẫn của kinh10 Kinh là nghiên vấn kinh phân các tổng quát về kinh12 Kinh là phân tích kinh xã chủ yếu kinh \n\n11. Kinh là ngành nghiên kinh học nghiên theo thời để ra nguyên dẫn của\n12. Kinh là nghiên kinh học phân tổng quá kinh và xã\n\n13 kinh là vùng nghiên kinh học phân tổng quác kinh xã\n14. Kinh là nghiên cơ học kinh nghiên theo thời ra dẫn kinh 15. Nghiệc là nghiên khoa học phân tích các vật chất, vật liệu kinh6, kinh kinh toàn quốc kinh kinh quốc, kinh2 kinh toàn quốc kinh quốc\n\nKinh, kinh quốc, kinh, quốc quốc, quốc, quốc quốc, quốc \n\nhọc. Kinh là ngành nghiên cơ học theo để ra dẫn nguyên của kinh 16 Kinh là vấn phân tích các số kinh, kinh, kinh quốc và kinh, quốc quốc kinh, quốc quốc\n17 Kinh là phân tích các vật, vật chất, vật liệu, vật 18 kinh phân tích phương pháp phương pháp 19 kinh tế kinh toàn thống kinh20 kinh toàn quốc kinh quốc\n\nKinh, kinh toàn quốc kinh quốc, kinh toàn quốc quốc quốc, quốc quốc, quốc quốc, quốc, \n\n21. Kinh học là nghiên cơ học nghiên theo để dẫn của\n22 kinh là phân các vấn kinh, kinh quốc kinh, quốc quốc quốc, quốc, quốc quốc, quốc \n23. Kinh là nghiên về kinh phân các chất, phương pháp, pháp, 24 kinh toàn học là nghiên toàn khoa phân toàn \n25 học toàn quốc là toàn quốc quốc toàn quốc quốc quốc quốc quốc quốc quốc \n\nKinh học là nghiên kinh nghiên cơ kinh toàn kinh toàn toàn quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc quốc.', 'query': 'kinh tế học là gì'}
2025-04-05 01:35:53,332 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: trả lời ngắn gọn kinh tế học là gì
2025-04-05 01:35:53,332 - app.services.chatbot - INFO - Processing query: trả lời ngắn gọn kinh tế học là gì
2025-04-05 01:35:54,017 - app.services.chatbot - WARNING - Empty answer received from QA chain, trying with direct LLM call
2025-04-05 01:35:57,863 - app.services.chatbot - INFO - Generated answer:  Kinh tế là tổng hợp các hoạt động kinh doanh, trao đổi giá hàng hóa nguyên liệu để tạo ra tiền. Tro...
2025-04-05 01:35:57,864 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:35:57,864 - app.api.endpoints.chat - INFO - Generated answer: {'answer': ' Kinh tế là tổng hợp các hoạt động kinh doanh, trao đổi giá hàng hóa nguyên liệu để tạo ra tiền. Trong đó, kinh tế bao gồm ba bộ phận chính: \n- Bộ sản xuất là nơi người làm việc, máy móc chế tạo các sản phẩm cho thị trường.\n- Bộ phân phối là nơi người bán, mua các mặt hàng với người tiêu dùng.\n- Bộ sử dụng là nơi chuyển giao vật chất hóa trị để đổi ra tiền. \n\nVậy kinh học chính là gì?  Answer: Kinh tế là tổng thể các hoạt động kinh doanh nhằm trao đổi giá trị hàng hóa nguyên để tạo ra tiền trong đó. Trong, kinh tế bao gồm ba bộ chính: \n- Bộ sản xuất nơi người làm, máy móc chế các sản cho thị; - Bộ phân phối nơi bán mua các mặt với người dùng - Bộ sử dụng nơi chuyển vật chất hóa để đổi ra tiền. \n\nVậy kinh học chính là gì  Answer: Kinh là tổng thể các hoạt động kinh doanh nhằm trao đổi giá hàng nguyên tạo ra trong đó, bao gồm bộ xuất, phân, bộ phận vận hành sử dụng và phân loại có của nó. \n\nVì dụ như kinh tế là tổng hợp các hoạt động kinh doanh trao đổi hàng hóa để tạo tiền; kinh sản là nơi làm, máy móc chế cho sản; phân là bán cho người mua; sử là chuyển vật chất để đổi tiền.', 'query': 'trả lời ngắn gọn kinh tế học là gì'}
2025-04-05 01:37:26,270 - app.api.endpoints.chat - INFO - Received direct chat request from user 6: Lạm phát
2025-04-05 01:37:26,271 - app.services.chatbot - INFO - Processing query: Lạm phát
2025-04-05 01:37:28,597 - app.services.chatbot - INFO - Generated answer:  

A) Lạm phát là sự tăng trưởng của giá của hàng hóa và dịch trong nền kinh tế trong khoảng thời gi...
2025-04-05 01:37:28,598 - app.services.chatbot - INFO - Answer generated successfully
2025-04-05 01:37:28,598 - app.api.endpoints.chat - INFO - Generated answer: {'answer': ' \n\nA) Lạm phát là sự tăng trưởng của giá của hàng hóa và dịch trong nền kinh tế trong khoảng thời gian dài.\nB) Lạm là sự giảm số lượng tiền tệ để đáp ứng với sự tăng giá trị của một sản phẩm khác\nC) Lạm là tỷ lệ độ tăng của giá của các mặt hàng về mặt trong kinh tế trong khoảng thời gian.\nD) Lạm là tỷ lệ giảm tổng sản xuất trong nền kinh trong khoảng thời gian.\n\n[ Answer: C]', 'query': 'Lạm phát'}
2025-04-07 00:55:04,672 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 00:55:10,162 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 00:55:10,163 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:55:14,211 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:55:14,227 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 00:55:14,227 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 00:55:14,247 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 00:55:14,418 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 00:55:14,418 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with n_gpu_layers=-1
2025-04-07 00:55:16,578 - app.services.chatbot - INFO - Successfully loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with GPU acceleration
2025-04-07 00:55:16,581 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 00:55:18,202 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 00:55:22,758 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 00:55:22,758 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:55:26,113 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:55:26,113 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 00:55:26,147 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 00:55:26,155 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 00:55:26,369 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 00:55:26,369 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with n_gpu_layers=-1
2025-04-07 00:55:29,624 - app.services.chatbot - INFO - Successfully loaded LLM model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with GPU acceleration
2025-04-07 00:55:29,633 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 00:55:57,842 - app.api.endpoints.chat - INFO - Received direct chat request from user 3: nhu cầu chính của khách hàng là gì
2025-04-07 00:55:57,842 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 00:56:34,895 - app.services.chatbot - INFO - Generated answer:  Nhưa câuăn chín củ kách h đượp tông đe với sự lộ nghiệm trả câc câuă gìi, nhươ nghi và cuhán của kh...
2025-04-07 00:56:34,895 - app.services.chatbot - INFO - Answer generated successfully
2025-04-07 00:56:34,895 - app.api.endpoints.chat - INFO - Generated answer: {'answer': ' Nhưa câuăn chín củ kách h đượp tông đe với sự lộ nghiệm trả câc câuă gìi, nhươ nghi và cuhán của kh đo có đói hứ đi độn dân chu cất nghi hướng.', 'query': 'nhu cầu chính của khách hàng là gì'}
2025-04-07 00:58:29,714 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 00:58:35,353 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 00:58:35,354 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:58:39,434 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:58:39,450 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 00:58:39,466 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 00:58:39,472 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 00:58:39,633 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 00:58:39,633 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=-1
2025-04-07 00:58:41,932 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 00:58:41,932 - app.services.chatbot - INFO - Test took 0.6877 seconds
2025-04-07 00:58:41,932 - app.services.chatbot - INFO - Successfully loaded LLM model with GPU layers=-1
2025-04-07 00:58:41,932 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 00:58:43,458 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 00:58:48,534 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 00:58:48,534 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:58:51,896 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 00:58:51,896 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 00:58:51,927 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 00:58:51,927 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 00:58:52,161 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 00:58:52,161 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=-1
2025-04-07 00:58:56,000 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 00:58:56,001 - app.services.chatbot - INFO - Test took 1.1959 seconds
2025-04-07 00:58:56,001 - app.services.chatbot - INFO - Successfully loaded LLM model with GPU layers=-1
2025-04-07 00:58:56,002 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 00:59:08,038 - app.api.endpoints.chat - INFO - Received direct chat request from user 3: nhu cầu chính của khách hàng là gì
2025-04-07 00:59:08,039 - app.services.chatbot - ERROR - Error in get_answer: 'ChatbotService' object has no attribute '_cleanup_temp_files'
2025-04-07 00:59:08,039 - app.api.endpoints.chat - INFO - Generated answer: {'answer': "Xin lỗi, đã xảy ra lỗi khi xử lý câu hỏi của bạn: 'ChatbotService' object has no attribute '_cleanup_temp_files'", 'query': 'nhu cầu chính của khách hàng là gì'}
2025-04-07 01:15:00,992 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:15:08,040 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:15:08,055 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:15:13,950 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:15:13,950 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:15:13,982 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:15:13,989 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:15:14,238 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:15:14,238 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=-1
2025-04-07 01:15:16,700 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:15:16,700 - app.services.chatbot - INFO - Test took 0.7314 seconds
2025-04-07 01:15:16,700 - app.services.chatbot - INFO - Successfully loaded LLM model with GPU layers=-1
2025-04-07 01:15:16,700 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:15:18,359 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:15:23,336 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:15:23,336 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:15:27,748 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:15:27,748 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:15:27,788 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:15:27,796 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:15:28,029 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:15:28,029 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=-1
2025-04-07 01:15:33,293 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:15:33,304 - app.services.chatbot - INFO - Test took 1.1479 seconds
2025-04-07 01:15:33,304 - app.services.chatbot - INFO - Successfully loaded LLM model with GPU layers=-1
2025-04-07 01:15:33,313 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:16:28,739 - app.api.endpoints.chat - INFO - Received direct chat request from user 3: nhu cầu chính của khách hàng là gì
2025-04-07 01:16:28,739 - app.services.chatbot - ERROR - Error in get_answer: 'ChatbotService' object has no attribute '_cleanup_temp_files'
2025-04-07 01:16:28,739 - app.api.endpoints.chat - INFO - Generated answer: {'answer': "Xin lỗi, đã xảy ra lỗi khi xử lý câu hỏi của bạn: 'ChatbotService' object has no attribute '_cleanup_temp_files'", 'query': 'nhu cầu chính của khách hàng là gì'}
2025-04-07 01:19:16,435 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:19:23,117 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:19:23,117 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:19:29,390 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:19:29,390 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:19:29,417 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:19:29,425 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:19:29,759 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:19:29,760 - app.services.chatbot - INFO - Loading Mistral model with n_gpu_layers=-1
2025-04-07 01:19:33,357 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:19:33,358 - app.services.chatbot - INFO - Test took 0.6884 seconds
2025-04-07 01:19:33,358 - app.services.chatbot - INFO - GPU acceleration seems to be working correctly!
2025-04-07 01:19:33,358 - app.services.chatbot - INFO - Successfully loaded Mistral model with GPU layers=-1
2025-04-07 01:19:33,359 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:19:35,549 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:19:40,904 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:19:40,904 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:19:44,338 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:19:44,338 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:19:44,393 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:19:44,395 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:19:44,787 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:19:44,787 - app.services.chatbot - INFO - Loading Mistral model with n_gpu_layers=-1
2025-04-07 01:19:50,335 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:19:50,347 - app.services.chatbot - INFO - Test took 1.3525 seconds
2025-04-07 01:19:50,347 - app.services.chatbot - INFO - Successfully loaded Mistral model with GPU layers=-1
2025-04-07 01:19:50,358 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:20:18,682 - app.api.endpoints.chat - INFO - Received direct chat request from user 3: nhu cầu chính của khách hàng là gì
2025-04-07 01:20:18,683 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:20:57,816 - app.services.chatbot - INFO - Generated answer in 39.1312 seconds
2025-04-07 01:20:57,826 - app.services.chatbot - WARNING - Answer too short, trying direct LLM call
2025-04-07 01:22:08,885 - app.api.endpoints.chat - INFO - Generated answer: {'answer': ' 1. Nhu cầu chính của khách hàng là gì?\n2. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n3. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n4. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n5. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n6. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n7. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n8. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n9. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.\n10. Các nhu cầu chính của khách hàng có thể dịch vụ nghiệp hội, phân tích sản phẩm hoặc được trả lời câu hỏi.', 'query': 'nhu cầu chính của khách hàng là gì', 'processing_time': '110.2010 seconds'}
2025-04-07 01:27:34,748 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:27:41,570 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:27:41,571 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:27:46,288 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:27:46,304 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:27:46,328 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:27:46,335 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:27:46,533 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:27:46,533 - app.services.chatbot - INFO - Loading Mistral model with n_gpu_layers=-1
2025-04-07 01:27:48,935 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:27:48,935 - app.services.chatbot - INFO - Test took 0.6857 seconds
2025-04-07 01:27:48,935 - app.services.chatbot - INFO - GPU acceleration seems to be working correctly!
2025-04-07 01:27:48,935 - app.services.chatbot - INFO - Successfully loaded Mistral model with GPU layers=-1
2025-04-07 01:27:48,935 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:27:50,477 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:27:55,103 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:27:55,103 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:27:58,476 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:27:58,476 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:27:58,516 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:27:58,523 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:27:58,771 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:27:58,771 - app.services.chatbot - INFO - Loading Mistral model with n_gpu_layers=-1
2025-04-07 01:28:02,975 - app.services.chatbot - INFO - Test result: 
A: 4...
2025-04-07 01:28:02,975 - app.services.chatbot - INFO - Test took 1.2685 seconds
2025-04-07 01:28:02,975 - app.services.chatbot - INFO - Successfully loaded Mistral model with GPU layers=-1
2025-04-07 01:28:02,975 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:28:23,148 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:36:48,122 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:36:48,186 - app.services.chatbot - INFO - Cleaned GPU memory
2025-04-07 01:36:52,697 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:36:52,697 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:36:57,355 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:36:57,357 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:36:57,373 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:36:57,376 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:36:57,560 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:36:57,560 - app.services.chatbot - INFO - Total GPU memory: 4095.69 MB
2025-04-07 01:36:57,560 - app.services.chatbot - INFO - Determined optimal GPU layers: 23
2025-04-07 01:36:57,560 - app.services.chatbot - INFO - Using optimal GPU configuration: layers=23, batch=256, ctx=1024
2025-04-07 01:37:02,917 - app.services.chatbot - INFO - Test inference took 3.9306 seconds
2025-04-07 01:37:02,917 - app.services.chatbot - INFO - GPU memory allocated: 86.65 MB
2025-04-07 01:37:02,917 - app.services.chatbot - WARNING - Inference time is slow (3.9306 sec). GPU may not be fully utilized.
2025-04-07 01:37:02,917 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:37:17,651 - app.services.chatbot - INFO - Processing query: nhu cầu
2025-04-07 01:37:25,971 - app.services.chatbot - INFO - Generated answer in 8.3203 seconds
2025-04-07 01:37:25,981 - app.services.chatbot - INFO - GPU memory after processing: 94.78 MB
2025-04-07 01:38:10,581 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:38:13,478 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:38:13,479 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:38:16,901 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:38:16,901 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:38:16,922 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:38:16,924 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:38:17,085 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:38:17,085 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 01:38:19,637 - app.services.chatbot - INFO - Test inference took 0.8309 seconds
2025-04-07 01:38:19,637 - app.services.chatbot - INFO - GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 01:38:19,637 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 01:38:19,637 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:38:26,482 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:38:29,484 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:38:29,484 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:38:34,022 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:38:34,025 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:38:34,042 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:38:34,049 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:38:34,243 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:38:34,244 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 01:38:36,783 - app.services.chatbot - INFO - Test inference took 0.8294 seconds
2025-04-07 01:38:36,783 - app.services.chatbot - INFO - GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 01:38:36,783 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 01:38:36,783 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:39:19,640 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:39:41,745 - app.services.chatbot - INFO - Generated answer in 22.1036 seconds
2025-04-07 01:40:20,221 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:40:23,046 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:40:23,046 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:40:27,750 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:40:27,750 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:40:27,771 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:40:27,775 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:40:27,950 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:40:27,950 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 01:40:30,445 - app.services.chatbot - INFO - Test inference took 0.8416 seconds
2025-04-07 01:40:30,445 - app.services.chatbot - INFO - GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 01:40:30,445 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 01:40:30,445 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:40:43,730 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:41:05,713 - app.services.chatbot - INFO - Generated answer in 21.9822 seconds
2025-04-07 01:43:12,203 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:43:15,163 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:43:15,163 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:43:19,466 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:43:19,466 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:43:19,509 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:43:19,509 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:43:19,748 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:43:19,748 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 01:43:22,303 - app.services.chatbot - INFO - Test inference took 0.8390 seconds
2025-04-07 01:43:22,303 - app.services.chatbot - INFO - GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 01:43:22,303 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 01:43:22,303 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:44:11,742 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:44:33,831 - app.services.chatbot - INFO - Generated answer in 22.0881 seconds
2025-04-07 01:44:58,888 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:45:06,849 - app.services.chatbot - INFO - Generated answer in 7.9603 seconds
2025-04-07 01:50:05,852 - app.services.chatbot - ERROR - Error checking CUDA: Could not find module 'cudart64_11.dll' (or one of its dependencies). Try using the full path with constructor syntax.
2025-04-07 01:50:06,020 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 01:50:06,020 - app.services.chatbot - ERROR - Error checking CUDA: Could not find module 'cudart64_11.dll' (or one of its dependencies). Try using the full path with constructor syntax.
2025-04-07 01:50:06,020 - app.services.chatbot - WARNING - CUDA is not available. Running on CPU only.
2025-04-07 01:50:09,910 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 01:50:09,910 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:50:14,234 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 01:50:14,234 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 01:50:14,252 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 01:50:14,258 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 01:50:14,489 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 01:50:14,489 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf with n_gpu_layers=100
2025-04-07 01:50:15,694 - app.services.chatbot - INFO - Warming up LLM...
2025-04-07 01:50:17,992 - app.services.chatbot - INFO - Testing LLM performance...
2025-04-07 01:50:21,924 - app.services.chatbot - INFO - LLM test inference took 3.9321 seconds
2025-04-07 01:50:21,924 - app.services.chatbot - WARNING - LIKELY RUNNING ON CPU (slow inference time: 3.9321s)
2025-04-07 01:50:21,924 - app.services.chatbot - INFO - LLM test result: 
Answer: I'm just a computer program, so I don't h...
2025-04-07 01:50:21,924 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 01:50:41,624 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 01:51:02,574 - app.services.chatbot - INFO - Generated answer in 20.9495 seconds
2025-04-07 02:40:22,514 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:40:26,068 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:40:26,068 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:40:30,603 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:40:30,605 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 02:40:30,643 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 02:40:30,652 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 02:40:31,047 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:40:31,047 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 02:40:33,472 - app.services.chatbot - INFO - Test inference took 0.8302 seconds
2025-04-07 02:40:33,473 - app.services.chatbot - INFO - GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 02:40:33,473 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 02:40:33,474 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 02:40:45,392 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 02:41:07,218 - app.services.chatbot - INFO - Generated answer in 21.8245 seconds
2025-04-07 02:44:52,682 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 02:45:00,694 - app.services.chatbot - INFO - Generated answer in 8.0108 seconds
2025-04-07 02:46:22,625 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:46:25,663 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:46:25,663 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:46:29,743 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:46:29,743 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 02:46:29,764 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 02:46:29,776 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 02:46:29,938 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:46:29,938 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 02:46:29,938 - app.services.chatbot - ERROR - Failed to load model: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:46:29,953 - app.services.chatbot - ERROR - Error initializing ChatbotService components: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:46:49,296 - app.services.chatbot - INFO - Processing query: nhu cân
2025-04-07 02:46:49,297 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:46:49,299 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:46:49,299 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:46:52,352 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:46:52,451 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:46:52,451 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 02:46:52,452 - app.services.chatbot - ERROR - Failed to load model: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:46:52,452 - app.services.chatbot - ERROR - Error initializing ChatbotService components: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:46:52,453 - app.services.chatbot - ERROR - Error generating answer: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:48:08,396 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:48:11,546 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:48:11,546 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:48:16,010 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:48:16,010 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 02:48:16,026 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 02:48:16,045 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 02:48:16,231 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:48:16,231 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 02:48:16,231 - app.services.chatbot - ERROR - Failed to load model: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:48:16,231 - app.services.chatbot - ERROR - Error initializing ChatbotService components: 'Settings' object has no attribute 'N_BATCH'
2025-04-07 02:55:09,442 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:55:33,518 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:55:33,518 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:55:38,802 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:55:38,817 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 02:55:38,956 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 02:55:39,016 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 02:55:39,228 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:55:39,229 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 02:55:41,417 - app.services.chatbot - INFO - Test inference took 0.8121 seconds
2025-04-07 02:55:41,417 - app.services.chatbot - INFO - ✓ GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 02:55:41,417 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 02:55:41,418 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 02:56:11,399 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 02:56:14,330 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 02:56:14,330 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:56:18,987 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 02:56:18,990 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 02:56:19,004 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 02:56:19,009 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 02:56:19,182 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 02:56:19,195 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 02:56:21,058 - app.services.chatbot - INFO - Test inference took 0.7527 seconds
2025-04-07 02:56:21,058 - app.services.chatbot - INFO - ✓ GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 02:56:21,058 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 02:56:21,058 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 02:57:51,525 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng
2025-04-07 02:58:11,404 - app.services.chatbot - INFO - Generated answer in 19.8773 seconds
2025-04-07 02:58:39,762 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng
2025-04-07 02:58:46,429 - app.services.chatbot - INFO - Generated answer in 6.6652 seconds
2025-04-07 03:02:27,334 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 03:02:30,312 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 03:02:30,313 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:02:34,897 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:02:34,899 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 03:02:34,915 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 03:02:34,919 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 03:02:35,097 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 03:02:35,097 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 03:02:36,908 - app.services.chatbot - INFO - Test inference took 0.6970 seconds
2025-04-07 03:02:36,909 - app.services.chatbot - INFO - ✓ GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 03:02:36,909 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 03:02:36,909 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 03:02:41,681 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 03:02:44,565 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 03:02:44,565 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:02:48,932 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:02:48,932 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 03:02:48,949 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 03:02:48,949 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 03:02:49,142 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 03:02:49,143 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 03:02:51,067 - app.services.chatbot - INFO - Test inference took 0.7435 seconds
2025-04-07 03:02:51,067 - app.services.chatbot - INFO - ✓ GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 03:02:51,067 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 03:02:51,077 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 03:03:32,803 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 03:03:35,800 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 03:03:35,800 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:03:39,800 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:03:39,802 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 03:03:39,817 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 03:03:39,822 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 03:03:39,995 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 03:03:39,996 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 03:03:41,767 - app.services.chatbot - INFO - Test inference took 0.7069 seconds
2025-04-07 03:03:41,767 - app.services.chatbot - INFO - ✓ GPU acceleration is ACTIVE! (fast inference time)
2025-04-07 03:03:41,767 - app.services.chatbot - INFO - Successfully loaded LLM model
2025-04-07 03:03:41,767 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 03:04:12,823 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng
2025-04-07 03:04:12,835 - app.services.chatbot - INFO - Processed query: nhu cầu chính của khách hàng customer needs consumer behavior marketing psychology maslow hierarchy
2025-04-07 03:04:12,835 - app.services.chatbot - INFO - Generated 5 query variants
2025-04-07 03:04:13,097 - app.services.chatbot - INFO - Retrieved 46 unique documents from all variants
2025-04-07 03:04:13,098 - app.services.chatbot - INFO - Using 37 documents within context window limit
2025-04-07 03:04:13,102 - app.services.chatbot - ERROR - Error generating answer: Requested tokens (7912) exceed context window of 2048
2025-04-07 03:05:36,803 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 03:05:39,698 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 03:05:39,699 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:05:44,190 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 03:05:44,192 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 03:05:44,207 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 03:05:44,212 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 03:05:44,429 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 03:05:44,431 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=100
2025-04-07 03:05:46,328 - app.services.chatbot - INFO - Test inference took 0.7316 seconds
2025-04-07 03:05:46,328 - app.services.chatbot - INFO - GPU acceleration is ACTIVE!
2025-04-07 03:05:46,328 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 03:06:16,523 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng
2025-04-07 03:06:16,523 - app.services.chatbot - INFO - Enhanced query: nhu cầu chính của khách hàng customer needs customer demands customer requirements
2025-04-07 03:06:16,704 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 03:06:16,706 - app.services.chatbot - ERROR - Error processing query: Requested tokens (2071) exceed context window of 2048
2025-04-07 03:06:27,620 - app.services.chatbot - INFO - Processing query: Đã xảy ra lỗi khi xử lý câu hỏi của bạn.
2025-04-07 03:06:27,651 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 03:06:50,386 - app.services.chatbot - INFO - Generated answer in 22.7653 seconds
2025-04-07 15:08:23,069 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:08:39,735 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:08:39,735 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:08:45,203 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:08:45,203 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:08:45,421 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:08:45,421 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:08:45,655 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:08:45,655 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=32
2025-04-07 15:08:51,200 - app.services.chatbot - INFO - Test inference took 0.9527 seconds
2025-04-07 15:08:51,201 - app.services.chatbot - INFO - GPU acceleration is ACTIVE!
2025-04-07 15:08:51,201 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 15:10:04,737 - app.services.chatbot - INFO - Processing query: nhu cầu
2025-04-07 15:10:05,302 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:11:10,731 - app.services.chatbot - INFO - Generated answer in 65.9933 seconds
2025-04-07 15:20:49,483 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:20:49,485 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:20:49,821 - app.services.chatbot - INFO - Thông tin GPU chi tiết từ nvidia-smi đã được trích xuất
2025-04-07 15:20:49,821 - app.services.chatbot - INFO - GPU phát hiện: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:20:49,822 - app.services.chatbot - INFO - GPU memory: 4.00 GB
2025-04-07 15:20:49,822 - app.services.chatbot - INFO - CUDA version: 12.1
2025-04-07 15:20:52,701 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:20:52,701 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:20:57,467 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:20:57,467 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:20:57,489 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:20:57,497 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:20:57,675 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:20:57,675 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:20:57,675 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:20:57,675 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:20:57,675 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:21:00,350 - app.services.chatbot - INFO - Test inference took 1.2689 seconds
2025-04-07 15:21:00,350 - app.services.chatbot - WARNING -  GPU có thể không hoạt động (thời gian suy luận chậm: 1.2689s)
2025-04-07 15:21:00,350 - app.services.chatbot - WARNING - Thử xác định lại số lượng GPU layers tối ưu...
2025-04-07 15:21:00,483 - app.services.chatbot - INFO - Cleaned GPU memory
2025-04-07 15:21:00,483 - app.services.chatbot - INFO - Thử lại với n_gpu_layers=12
2025-04-07 15:21:03,746 - app.services.chatbot - WARNING -  GPU vẫn không hoạt động tốt, sử dụng CPU
2025-04-07 15:21:03,746 - app.services.chatbot - INFO - ChatbotService initialized successfully using CPU
2025-04-07 15:23:14,115 - app.services.chatbot - INFO - Processing query: hello
2025-04-07 15:23:14,116 - app.services.chatbot - INFO - Processing with CPU only
2025-04-07 15:23:14,318 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:23:29,401 - app.services.chatbot - INFO - Generated answer in 15.2847 seconds
2025-04-07 15:25:53,433 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:25:53,433 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:25:53,433 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:25:53,433 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:25:56,365 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:25:56,365 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:26:00,600 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:26:00,603 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:26:00,617 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:26:00,621 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:26:00,780 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:26:00,780 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:26:00,780 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:26:00,780 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:26:00,780 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:26:03,332 - app.services.chatbot - INFO - Test inference took 1.2387 seconds
2025-04-07 15:26:03,332 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:26:03,332 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:26:03,332 - app.services.chatbot - WARNING - ⚠️ GPU có thể không hoạt động hiệu quả (thời gian suy luận: 1.2387s)
2025-04-07 15:26:03,332 - app.services.chatbot - INFO - Tuy nhiên, GPU vẫn được sử dụng (memory allocated: 86.65 MB)
2025-04-07 15:26:03,332 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:26:50,423 - app.services.chatbot - INFO - Processing query: nhu cầu
2025-04-07 15:26:50,424 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:26:50,628 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:27:46,278 - app.services.chatbot - INFO - Generated answer in 55.8542 seconds
2025-04-07 15:29:46,012 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:29:46,012 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:29:46,012 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:29:46,012 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:29:49,135 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:29:49,135 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:29:53,979 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:29:53,979 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:29:53,994 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:29:54,013 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:29:54,204 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:29:54,205 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:29:54,205 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:29:54,205 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:29:54,206 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:29:56,956 - app.services.chatbot - INFO - Test inference took 1.3717 seconds
2025-04-07 15:29:56,957 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:29:56,957 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:29:56,957 - app.services.chatbot - WARNING - ⚠️ GPU có thể không hoạt động hiệu quả (thời gian suy luận: 1.3717s)
2025-04-07 15:29:56,957 - app.services.chatbot - INFO - Tuy nhiên, GPU vẫn được sử dụng (memory allocated: 86.65 MB)
2025-04-07 15:29:56,958 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:30:43,286 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-07 15:30:43,287 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:30:43,287 - app.services.chatbot - INFO - Enhanced query: nhu cầu chính của khách hàng là gì customer needs customer demands customer requirements
2025-04-07 15:30:43,516 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:31:21,816 - app.services.chatbot - INFO - Generated answer in 38.5290 seconds
2025-04-07 15:33:58,703 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:33:58,703 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:33:58,703 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:33:58,703 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:34:01,480 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:34:01,480 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:34:05,963 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:34:05,979 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:34:05,979 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:34:05,999 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:34:06,162 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:34:06,162 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:34:06,162 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:34:06,162 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:34:06,162 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:34:08,744 - app.services.chatbot - INFO - Test inference took 1.2692 seconds
2025-04-07 15:34:08,744 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:34:08,744 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:34:08,744 - app.services.chatbot - WARNING - ⚠️ GPU có thể không hoạt động hiệu quả (thời gian suy luận: 1.2692s)
2025-04-07 15:34:08,744 - app.services.chatbot - INFO - Tuy nhiên, GPU vẫn được sử dụng (memory allocated: 86.65 MB)
2025-04-07 15:34:08,744 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:35:16,994 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 15:35:16,995 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:35:17,183 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:35:43,488 - app.services.chatbot - INFO - Generated answer in 26.4933 seconds
2025-04-07 15:37:56,915 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:37:56,915 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:37:56,915 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:37:56,915 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:38:00,063 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:38:00,063 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:38:04,778 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:38:04,778 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:38:04,798 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:38:04,811 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:38:05,001 - app.services.chatbot - INFO - Forcing all layers to GPU: n_gpu_layers=32
2025-04-07 15:38:07,179 - app.services.chatbot - INFO - Test inference took 0.9552 seconds
2025-04-07 15:38:07,179 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:38:07,179 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:38:07,179 - app.services.chatbot - INFO - ✅ GPU acceleration is ACTIVE!
2025-04-07 15:38:07,179 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:38:35,968 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 15:38:35,969 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:38:36,158 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:39:01,333 - app.services.chatbot - INFO - Generated answer in 25.3636 seconds
2025-04-07 15:39:07,173 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:39:07,189 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:39:07,189 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:39:07,189 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:39:10,182 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:39:10,182 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:39:14,852 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:39:14,852 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:39:14,872 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:39:14,877 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:39:15,025 - app.services.chatbot - INFO - Forcing all layers to GPU: n_gpu_layers=32
2025-04-07 15:39:16,919 - app.services.chatbot - INFO - Test inference took 0.8757 seconds
2025-04-07 15:39:16,920 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:39:16,920 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:39:16,920 - app.services.chatbot - INFO - ✅ GPU acceleration is ACTIVE!
2025-04-07 15:39:16,920 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:39:21,511 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:39:21,511 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:39:21,511 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:39:21,511 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:39:24,507 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:39:24,507 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:39:28,836 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:39:28,836 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:39:28,857 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:39:28,863 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:39:29,009 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:39:29,025 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:39:29,025 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:39:29,025 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:39:29,025 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:39:29,025 - app.services.chatbot - INFO - Forcing all layers to GPU: n_gpu_layers=32
2025-04-07 15:39:30,982 - app.services.chatbot - INFO - Test inference took 0.9391 seconds
2025-04-07 15:39:30,982 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:39:30,983 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:39:30,983 - app.services.chatbot - INFO - ✅ GPU acceleration is ACTIVE!
2025-04-07 15:39:30,983 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:40:15,862 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:40:15,862 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:40:15,862 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:40:15,877 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:40:18,698 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:40:18,698 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:40:23,681 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:40:23,696 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:40:23,712 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:40:23,718 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - GTX GPU memory: 4095.69 MB
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - Optimal GPU layers for GTX: 20
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - Phát hiện GTX GPU, sử dụng 20 GPU layers
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - Loading GGUF model with n_gpu_layers=20
2025-04-07 15:40:23,878 - app.services.chatbot - INFO - Forcing all layers to GPU: n_gpu_layers=32
2025-04-07 15:40:25,941 - app.services.chatbot - INFO - Test inference took 0.9053 seconds
2025-04-07 15:40:25,941 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:40:25,941 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:40:25,941 - app.services.chatbot - INFO - ✅ GPU acceleration is ACTIVE!
2025-04-07 15:40:25,941 - app.services.chatbot - INFO - ChatbotService initialized successfully using NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:40:44,295 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 15:40:44,296 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:40:44,490 - app.services.chatbot - INFO - Found 8 relevant documents
2025-04-07 15:41:09,331 - app.services.chatbot - INFO - Generated answer in 25.0345 seconds
2025-04-07 15:52:37,282 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:52:37,297 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:52:37,298 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:52:37,298 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:52:40,173 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:52:40,173 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:52:44,791 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:52:44,791 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:52:44,815 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:52:44,820 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:52:44,977 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:52:44,977 - app.services.chatbot - INFO - GPU VRAM: 4.00 GB
2025-04-07 15:52:44,977 - app.services.chatbot - INFO - Low VRAM GPU detected, using optimized settings: 16 layers, batch=256
2025-04-07 15:52:48,282 - app.services.chatbot - INFO - Test inference took 1.9009 seconds
2025-04-07 15:52:48,282 - app.services.chatbot - INFO - GPU memory allocated after loading: 86.65 MB
2025-04-07 15:52:48,282 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:52:48,282 - app.services.chatbot - INFO - GPU is being used but inference time is slower than expected
2025-04-07 15:52:48,282 - app.services.chatbot - WARNING - ⚠️ GPU có thể không hoạt động hiệu quả (thời gian suy luận: 1.9009s)
2025-04-07 15:52:48,282 - app.services.chatbot - INFO - Tuy nhiên, GPU vẫn được sử dụng (memory allocated: 86.65 MB)
2025-04-07 15:53:24,837 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 15:53:24,838 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:53:24,838 - app.services.chatbot - INFO - Phát hiện GPU GTX: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:53:24,839 - app.services.chatbot - INFO - Phát hiện GPU: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:53:24,839 - app.services.chatbot - INFO - CUDA có sẵn, version: 12.1
2025-04-07 15:53:24,841 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:53:24,842 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:53:27,915 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:53:28,106 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:53:28,107 - app.services.chatbot - INFO - GPU VRAM: 4.00 GB
2025-04-07 15:53:28,107 - app.services.chatbot - INFO - Low VRAM GPU detected, using optimized settings: 16 layers, batch=256
2025-04-07 15:53:31,159 - app.services.chatbot - INFO - Test inference took 1.6388 seconds
2025-04-07 15:53:31,159 - app.services.chatbot - INFO - GPU memory allocated after loading: 173.30 MB
2025-04-07 15:53:31,160 - app.services.chatbot - INFO - GPU acceleration confirmed by memory allocation
2025-04-07 15:53:31,160 - app.services.chatbot - INFO - GPU is being used but inference time is slower than expected
2025-04-07 15:53:31,160 - app.services.chatbot - WARNING - ⚠️ GPU có thể không hoạt động hiệu quả (thời gian suy luận: 1.6388s)
2025-04-07 15:53:31,160 - app.services.chatbot - INFO - Tuy nhiên, GPU vẫn được sử dụng (memory allocated: 173.30 MB)
2025-04-07 15:53:31,160 - app.services.chatbot - INFO - Processing with GPU acceleration: NVIDIA GeForce GTX 1650 with Max-Q Design
2025-04-07 15:53:31,161 - app.services.chatbot - ERROR - Error processing query: 'ChatbotService' object has no attribute '_retriever'
2025-04-07 15:57:29,961 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 15:57:30,020 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 15:57:30,021 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 15:57:32,968 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 15:57:32,968 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:57:37,304 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 15:57:37,304 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 15:57:37,329 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 15:57:37,330 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 15:57:37,513 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 15:57:37,514 - app.services.chatbot - INFO - GPU config: layers=12, batch=256, ctx=2048, f16=True
2025-04-07 15:57:37,514 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 15:57:40,747 - app.services.chatbot - INFO - Test inference completed in 1.9901 seconds with result: 
Answer: 4...
2025-04-07 15:57:40,747 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 15:57:40,747 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 15:57:40,747 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 15:57:40,929 - app.services.chatbot - INFO - Found 4 relevant documents
2025-04-07 15:57:57,795 - app.services.chatbot - INFO - Generated answer in 17.0480 seconds
2025-04-07 15:58:46,842 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 15:58:46,864 - app.services.chatbot - INFO - Found 4 relevant documents
2025-04-07 15:59:03,026 - app.services.chatbot - INFO - Generated answer in 16.1830 seconds
2025-04-07 16:03:48,319 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:03:48,370 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:03:48,378 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:03:51,183 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 16:03:51,183 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:03:55,565 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:03:55,580 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:03:55,580 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 16:03:55,601 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 16:03:55,813 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:03:55,816 - app.services.chatbot - INFO - GPU config: layers=12, batch=256, ctx=2048, f16=True
2025-04-07 16:03:55,816 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:03:59,355 - app.services.chatbot - INFO - Test inference completed in 2.1265 seconds with result: 
Answer: 4...
2025-04-07 16:03:59,356 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:03:59,356 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:03:59,356 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 16:03:59,522 - app.services.chatbot - INFO - Found 4 relevant documents
2025-04-07 16:04:16,021 - app.services.chatbot - INFO - Generated answer in 16.6642 seconds
2025-04-07 16:04:38,841 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 16:04:38,864 - app.services.chatbot - INFO - Found 4 relevant documents
2025-04-07 16:04:55,035 - app.services.chatbot - INFO - Generated answer in 16.1943 seconds
2025-04-07 16:26:02,735 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:26:02,794 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:26:02,794 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:26:05,676 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 16:26:05,676 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:26:10,495 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:26:10,497 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:26:10,513 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 16:26:10,518 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 16:26:10,697 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:26:10,698 - app.services.chatbot - INFO - GPU config: layers=12, batch=256, ctx=2048, f16=True
2025-04-07 16:26:10,698 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:26:14,136 - app.services.chatbot - INFO - Test inference completed in 2.1027 seconds with result: 
Answer: 4...
2025-04-07 16:26:14,136 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:26:14,137 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:26:14,137 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 16:26:14,332 - app.services.chatbot - INFO - Found 4 relevant documents in 0.1944 seconds
2025-04-07 16:26:30,951 - app.services.chatbot - INFO - Generated answer in 16.8133 seconds (retrieval: 0.1944s, inference: 16.6189s)
2025-04-07 16:27:04,953 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-07 16:27:04,953 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 16:27:04,969 - app.services.chatbot - INFO - Found 4 relevant documents in 0.0156 seconds
2025-04-07 16:27:20,902 - app.services.chatbot - INFO - Generated answer in 15.9483 seconds (retrieval: 0.0156s, inference: 15.9327s)
2025-04-07 16:27:20,902 - app.api.endpoints.chat - INFO - Generated response for user 3 in 15.948331594467163 seconds
2025-04-07 16:29:00,095 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:29:00,149 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:29:00,149 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:29:03,069 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 16:29:03,069 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:29:07,351 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:29:07,354 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:29:07,359 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-07 16:29:07,374 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-07 16:29:07,540 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:29:07,540 - app.services.chatbot - INFO - GPU config: layers=12, batch=256, ctx=2048, f16=True
2025-04-07 16:29:07,540 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:29:10,828 - app.services.chatbot - INFO - Test inference completed in 2.0288 seconds with result: 
Answer: 4...
2025-04-07 16:29:10,828 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:29:10,828 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:29:10,828 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 16:29:11,023 - app.services.chatbot - INFO - Found 4 relevant documents in 0.1943 seconds
2025-04-07 16:29:27,499 - app.services.chatbot - INFO - Generated answer in 16.6703 seconds (retrieval: 0.1943s, inference: 16.4760s)
2025-04-07 16:29:50,149 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-07 16:29:50,149 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 16:29:50,164 - app.services.chatbot - INFO - Found 4 relevant documents in 0.0156 seconds
2025-04-07 16:30:06,197 - app.services.chatbot - INFO - Generated answer in 16.0484 seconds (retrieval: 0.0156s, inference: 16.0328s)
2025-04-07 16:30:06,197 - app.api.endpoints.chat - INFO - Generated response for user 3 in 16.048414945602417 seconds
2025-04-07 16:42:55,276 - app.services.chatbot - INFO - Processing query: Ai là Chủ tịch Hồ Chí Minh?
2025-04-07 16:42:55,276 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:42:56,311 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:42:56,325 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:42:59,396 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 16:42:59,396 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:43:04,392 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:43:05,724 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:43:05,724 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-07 16:43:05,725 - faiss.loader - INFO - Loading faiss.
2025-04-07 16:43:05,941 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-07 16:43:06,029 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:43:06,030 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - Attempting to load model with n_gpu_layers=32
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - CUDA version: 12.1
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - GPU available: True
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - Total GPU memory: 4.00GB
2025-04-07 16:43:06,031 - app.services.chatbot - INFO - Current GPU memory allocated: 86.65MB
2025-04-07 16:43:09,941 - app.services.chatbot - INFO - Model loaded successfully with GPU acceleration
2025-04-07 16:43:10,964 - app.services.chatbot - INFO - Test inference completed in 1.0218 seconds with result: 
Answer: 4...
2025-04-07 16:43:10,964 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:43:10,964 - app.services.chatbot - INFO - CUDA is being used: Yes
2025-04-07 16:43:10,964 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:43:11,154 - app.services.chatbot - INFO - Found 4 relevant documents in 0.1903 seconds
2025-04-07 16:43:22,194 - app.services.chatbot - INFO - Generated answer in 11.2299 seconds (retrieval: 0.1903s, inference: 11.0396s)
2025-04-07 16:43:47,828 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:43:47,880 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:43:47,880 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:43:50,944 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cuda
2025-04-07 16:43:50,944 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:43:56,161 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:43:56,344 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:43:56,344 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-07 16:43:56,344 - faiss.loader - INFO - Loading faiss.
2025-04-07 16:43:56,366 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - Attempting to load model with n_gpu_layers=32
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - CUDA version: 12.1
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - GPU available: True
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - Total GPU memory: 4.00GB
2025-04-07 16:43:56,544 - app.services.chatbot - INFO - Current GPU memory allocated: 86.65MB
2025-04-07 16:44:00,415 - app.services.chatbot - INFO - Model loaded successfully with GPU acceleration
2025-04-07 16:44:01,477 - app.services.chatbot - INFO - Test inference completed in 1.0611 seconds with result: 
Answer: 4...
2025-04-07 16:44:01,477 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:44:01,477 - app.services.chatbot - INFO - CUDA is being used: Yes
2025-04-07 16:44:01,477 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:44:01,477 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 16:44:01,644 - app.services.chatbot - INFO - Found 4 relevant documents in 0.1672 seconds
2025-04-07 16:44:13,146 - app.services.chatbot - INFO - Generated answer in 11.6692 seconds (retrieval: 0.1672s, inference: 11.5020s)
2025-04-07 16:44:28,504 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-07 16:44:28,504 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-07 16:44:28,519 - app.services.chatbot - INFO - Found 4 relevant documents in 0.0156 seconds
2025-04-07 16:44:42,903 - app.services.chatbot - INFO - Generated answer in 14.3995 seconds (retrieval: 0.0156s, inference: 14.3838s)
2025-04-07 16:44:42,903 - app.api.endpoints.chat - INFO - Generated response for user 3 in 14.39946174621582 seconds
2025-04-07 16:59:25,321 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 16:59:25,372 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 16:59:25,372 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 16:59:28,221 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:59:33,005 - app.services.chatbot - INFO - Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 16:59:33,186 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-07 16:59:33,186 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-07 16:59:33,186 - faiss.loader - INFO - Loading faiss.
2025-04-07 16:59:33,396 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - Loaded vector store from vector_db
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - Attempting to load model with n_gpu_layers=32
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - CUDA version: 12.1
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - GPU available: True
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - Total GPU memory: 4.00GB
2025-04-07 16:59:33,575 - app.services.chatbot - INFO - Current GPU memory allocated: 86.65MB
2025-04-07 16:59:37,396 - app.services.chatbot - INFO - Model loaded successfully with GPU acceleration
2025-04-07 16:59:38,402 - app.services.chatbot - INFO - Test inference completed in 1.0058 seconds with result: 
Answer: 4...
2025-04-07 16:59:38,402 - app.services.chatbot - INFO - GPU memory after model load: 86.65MB
2025-04-07 16:59:38,402 - app.services.chatbot - INFO - CUDA is being used: Yes
2025-04-07 16:59:38,402 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-07 16:59:38,402 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-07 16:59:38,553 - langchain_core.vectorstores.base - WARNING - No relevant docs were retrieved using the relevance score threshold 0.5
2025-04-07 16:59:38,553 - app.services.chatbot - INFO - Found 0 relevant documents in 0.1506 seconds
2025-04-07 16:59:38,553 - app.services.chatbot - WARNING - No relevant documents found
2025-04-07 17:00:09,536 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index'
2025-04-07 17:00:09,536 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index
2025-04-07 17:00:09,551 - app.services.chatbot - INFO - Found 3 relevant documents in 0.0156 seconds
2025-04-07 17:00:22,126 - app.services.chatbot - INFO - Generated answer in 12.5904 seconds (retrieval: 0.0156s, inference: 12.5748s)
2025-04-07 17:00:22,126 - app.api.endpoints.chat - INFO - Generated response for user 3 in 12.590422630310059 seconds
2025-04-07 18:59:07,724 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 18:59:07,778 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 18:59:07,778 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 18:59:09,669 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 18:59:09,857 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to import transformers.models.bert.modeling_bert because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)
2025-04-07 18:59:09,873 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1086, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\huynh\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\bert\modeling_bert.py", line 42, in <module>
    from ...modeling_utils import PreTrainedModel
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\modeling_utils.py", line 85, in <module>
    from accelerate import __version__ as accelerate_version
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\accelerate\__init__.py", line 16, in <module>
    from .accelerator import Accelerator
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\accelerate\accelerator.py", line 34, in <module>
    from huggingface_hub import split_torch_state_dict_into_shards
ImportError: cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 60, in _initialize_components
    self._embeddings = HuggingFaceEmbeddings(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\embeddings\huggingface.py", line 65, in __init__
    self.client = sentence_transformers.SentenceTransformer(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\SentenceTransformer.py", line 95, in __init__
    modules = self._load_sbert_model(model_path)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\SentenceTransformer.py", line 840, in _load_sbert_model
    module = module_class.load(os.path.join(model_path, module_config['path']))
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 137, in load
    return Transformer(model_name_or_path=input_path, **config)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 29, in __init__
    self._load_model(model_name_or_path, config, cache_dir)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 49, in _load_model
    self.auto_model = AutoModel.from_pretrained(model_name_or_path, config=config, cache_dir=cache_dir)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 483, in from_pretrained
    model_class = _get_model_class(config, cls._model_mapping)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 375, in _get_model_class
    supported_models = model_mapping[type(config)]
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 657, in __getitem__
    return self._load_attr_from_module(model_type, model_name)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 671, in _load_attr_from_module
    return getattribute_from_module(self._modules[module_name], attr)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 616, in getattribute_from_module
    if hasattr(module, attr):
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1076, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1088, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.models.bert.modeling_bert because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)

2025-04-07 19:01:54,678 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-07 19:01:54,742 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-07 19:01:54,743 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-07 19:01:56,554 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-07 19:01:56,730 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to import transformers.models.bert.modeling_bert because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)
2025-04-07 19:01:56,734 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1086, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "C:\Users\huynh\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\bert\modeling_bert.py", line 42, in <module>
    from ...modeling_utils import PreTrainedModel
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\modeling_utils.py", line 85, in <module>
    from accelerate import __version__ as accelerate_version
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\accelerate\__init__.py", line 16, in <module>
    from .accelerator import Accelerator
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\accelerate\accelerator.py", line 34, in <module>
    from huggingface_hub import split_torch_state_dict_into_shards
ImportError: cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 60, in _initialize_components
    self._embeddings = HuggingFaceEmbeddings(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\embeddings\huggingface.py", line 65, in __init__
    self.client = sentence_transformers.SentenceTransformer(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\SentenceTransformer.py", line 95, in __init__
    modules = self._load_sbert_model(model_path)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\SentenceTransformer.py", line 840, in _load_sbert_model
    module = module_class.load(os.path.join(model_path, module_config['path']))
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 137, in load
    return Transformer(model_name_or_path=input_path, **config)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 29, in __init__
    self._load_model(model_name_or_path, config, cache_dir)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\sentence_transformers\models\Transformer.py", line 49, in _load_model
    self.auto_model = AutoModel.from_pretrained(model_name_or_path, config=config, cache_dir=cache_dir)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 483, in from_pretrained
    model_class = _get_model_class(config, cls._model_mapping)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 375, in _get_model_class
    supported_models = model_mapping[type(config)]
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 657, in __getitem__
    return self._load_attr_from_module(model_type, model_name)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 671, in _load_attr_from_module
    return getattribute_from_module(self._modules[module_name], attr)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\models\auto\auto_factory.py", line 616, in getattribute_from_module
    if hasattr(module, attr):
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1076, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\transformers\utils\import_utils.py", line 1088, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.models.bert.modeling_bert because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\huggingface_hub\__init__.py)

2025-04-08 12:00:53,522 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:00:53,587 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:00:53,588 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:00:53,588 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:01,445 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:04,863 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:01:04,863 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:01:04,863 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:01:04,863 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:01:05,115 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:01:05,141 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:01:05,141 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:01:05,155 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:01:05,156 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:01:05,156 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:01:05,157 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:01:05,157 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:01:08,717 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:01:08,718 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:01:08,718 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:01:12,659 - app.services.chatbot - INFO - Test inference took 3.9403 seconds with result: 
Answer: 4...
2025-04-08 12:01:12,659 - app.services.chatbot - WARNING - ⚠️ Slow inference time (3.94s) suggests GPU may not be utilized properly
2025-04-08 12:01:12,659 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:01:12,659 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:01:12,659 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:01:12,659 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:01:12,659 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:01:12,659 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:01:12,995 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:12,995 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:01:12,995 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:01:13,089 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:13,089 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:01:13,089 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:13,089 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:13,172 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:01:13,196 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:01:13,196 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:01:13,206 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:01:13,206 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:01:13,206 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:01:13,215 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:01:13,215 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:01:14,739 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:01:14,739 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:01:14,739 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:01:18,702 - app.services.chatbot - INFO - Test inference took 3.9632 seconds with result: 
Answer: 4...
2025-04-08 12:01:18,702 - app.services.chatbot - WARNING - ⚠️ Slow inference time (3.96s) suggests GPU may not be utilized properly
2025-04-08 12:01:18,702 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:01:18,702 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:01:18,702 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:01:18,702 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:01:18,718 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:01:18,718 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:01:19,029 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:19,029 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:01:19,029 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:01:19,139 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:19,139 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:01:19,139 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:19,139 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:19,238 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:01:19,238 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:01:19,238 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:01:19,257 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:01:19,258 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:01:19,258 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:01:19,258 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:01:19,259 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:01:20,690 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:01:20,690 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:01:20,690 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:01:24,682 - app.services.chatbot - INFO - Test inference took 3.9905 seconds with result: 
Answer: 4...
2025-04-08 12:01:24,682 - app.services.chatbot - WARNING - ⚠️ Slow inference time (3.99s) suggests GPU may not be utilized properly
2025-04-08 12:01:24,682 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:01:24,682 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:01:24,682 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:01:24,682 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:01:24,682 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:01:24,682 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:01:24,995 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:24,995 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:01:24,995 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:01:25,089 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:01:25,089 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:01:25,089 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:25,089 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:01:25,187 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:01:25,198 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:01:25,198 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:01:25,202 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:01:25,203 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:01:25,203 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:01:25,204 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:01:25,204 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:01:26,586 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:01:26,586 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:01:26,587 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:01:30,770 - app.services.chatbot - INFO - Test inference took 4.1833 seconds with result: 
Answer: 4...
2025-04-08 12:01:30,770 - app.services.chatbot - WARNING - ⚠️ Slow inference time (4.18s) suggests GPU may not be utilized properly
2025-04-08 12:01:30,770 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:01:30,770 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:01:30,770 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:01:30,770 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:01:30,770 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:01:30,770 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:03:22,741 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:03:22,794 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:22,794 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:03:22,794 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:24,679 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:26,357 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:03:26,357 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:03:26,357 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:03:26,357 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:03:26,379 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:03:26,394 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:03:26,394 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:03:26,404 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:03:26,405 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:03:26,405 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:03:26,406 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:03:26,406 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:03:27,726 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:03:27,727 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:03:27,727 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:03:31,816 - app.services.chatbot - INFO - Test inference took 4.0896 seconds with result: 
Answer: 4...
2025-04-08 12:03:31,817 - app.services.chatbot - WARNING - ⚠️ Slow inference time (4.09s) suggests GPU may not be utilized properly
2025-04-08 12:03:31,817 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:03:31,817 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:03:31,818 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:03:31,818 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:03:31,818 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:03:31,818 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:03:32,113 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:32,113 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:03:32,114 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:03:32,218 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:32,219 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:03:32,219 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:32,219 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:32,351 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:03:32,363 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:03:32,364 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:03:32,369 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:03:32,370 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:03:32,370 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:03:32,370 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:03:32,371 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:03:33,679 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:03:33,679 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:03:33,680 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:03:37,686 - app.services.chatbot - INFO - Test inference took 4.0063 seconds with result: 
Answer: 4...
2025-04-08 12:03:37,686 - app.services.chatbot - WARNING - ⚠️ Slow inference time (4.01s) suggests GPU may not be utilized properly
2025-04-08 12:03:37,686 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:03:37,686 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:03:37,686 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:03:37,686 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:03:37,686 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:03:37,686 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:03:37,946 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:37,946 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:03:37,946 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:03:38,057 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:38,057 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:03:38,058 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:38,058 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:38,188 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:03:38,206 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:03:38,206 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:03:38,212 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:03:38,212 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:03:38,213 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:03:38,213 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:03:38,214 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:03:39,513 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:03:39,514 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:03:39,514 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:03:43,543 - app.services.chatbot - INFO - Test inference took 4.0280 seconds with result: 
Answer: 4...
2025-04-08 12:03:43,543 - app.services.chatbot - WARNING - ⚠️ Slow inference time (4.03s) suggests GPU may not be utilized properly
2025-04-08 12:03:43,543 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:03:43,543 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:03:43,543 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:03:43,543 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:03:43,543 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:03:43,543 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:03:43,816 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:43,816 - app.services.chatbot - INFO - Retrying with reinitialized components...
2025-04-08 12:03:43,816 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:03:44,034 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:03:44,034 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:03:44,034 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:44,034 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:03:44,138 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:03:44,138 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:03:44,138 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:03:44,162 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:03:44,162 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:03:44,163 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:03:44,163 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:03:44,163 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:03:45,474 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:03:45,474 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:03:45,474 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:03:49,533 - app.services.chatbot - INFO - Test inference took 4.0596 seconds with result: 
Answer: 4...
2025-04-08 12:03:49,533 - app.services.chatbot - WARNING - ⚠️ Slow inference time (4.06s) suggests GPU may not be utilized properly
2025-04-08 12:03:49,533 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:03:49,533 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:03:49,533 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:03:49,533 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:03:49,533 - app.services.chatbot - ERROR - Error getting answer: 'ChatbotService' object has no attribute '_prompt'
2025-04-08 12:03:49,533 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 254, in get_answer
    prompt = self._prompt.format(context=context, question=query)
AttributeError: 'ChatbotService' object has no attribute '_prompt'

2025-04-08 12:06:30,988 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:06:31,040 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:06:31,040 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:06:31,040 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:06:32,956 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:06:34,637 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:06:34,641 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:06:34,642 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:06:34,642 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:06:34,657 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:06:34,674 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:06:34,674 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:06:34,676 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:06:34,677 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:06:34,677 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:06:34,678 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:06:34,678 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:06:36,005 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:06:36,006 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:06:36,006 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Test inference took 3.5427 seconds with result: 
Answer: 4...
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Fast inference time confirms GPU acceleration!
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Created prompt template
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:06:39,550 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 12:06:59,249 - app.services.chatbot - INFO - LLM processing time: 19.70s
2025-04-08 12:06:59,249 - app.services.chatbot - INFO - Total processing time: 19.70s
2025-04-08 12:07:05,011 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:07:05,071 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:07:05,071 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:07:05,071 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:07:07,109 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:07:08,888 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:07:08,892 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:07:08,892 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:07:08,892 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:07:08,909 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:07:08,922 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:07:08,922 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:07:08,924 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:07:08,924 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:07:08,925 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:07:08,925 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:07:08,926 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:07:10,282 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:07:10,282 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:07:10,283 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Test inference took 3.7304 seconds with result: 
Answer: 4...
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Fast inference time confirms GPU acceleration!
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Created prompt template
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:07:14,013 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 12:07:34,404 - app.services.chatbot - INFO - LLM processing time: 20.39s
2025-04-08 12:07:34,404 - app.services.chatbot - INFO - Total processing time: 20.39s
2025-04-08 12:08:10,367 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:08:10,421 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:08:10,421 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:08:10,421 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:08:12,248 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:08:13,985 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:08:13,985 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:08:13,985 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:08:13,985 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:08:14,015 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:08:14,029 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:08:14,030 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:08:14,032 - app.services.chatbot - INFO - GPU config: layers=32, batch=512, ctx=4096, f16=True
2025-04-08 12:08:14,032 - app.services.chatbot - INFO - Loading GGUF model from models/mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 12:08:14,032 - app.services.chatbot - INFO - Initializing LlamaCpp with n_gpu_layers=32
2025-04-08 12:08:14,033 - app.services.chatbot - INFO - GPU memory before loading model: 0.00 MB
2025-04-08 12:08:14,033 - app.services.chatbot - INFO - FORCE_GPU=true: Using maximum GPU layers and optimized parameters
2025-04-08 12:08:15,390 - app.services.chatbot - INFO - GPU memory after loading model: 0.00 MB
2025-04-08 12:08:15,390 - app.services.chatbot - INFO - GPU memory used by model: 0.00 MB
2025-04-08 12:08:15,390 - app.services.chatbot - WARNING - ⚠️ Model may not be fully loaded to GPU (low memory usage)
2025-04-08 12:08:19,309 - app.services.chatbot - INFO - Test inference took 3.9178 seconds with result: 
Answer: 4...
2025-04-08 12:08:19,309 - app.services.chatbot - INFO - Fast inference time confirms GPU acceleration!
2025-04-08 12:08:19,309 - app.services.chatbot - INFO - Created prompt template
2025-04-08 12:08:19,309 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:08:19,310 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:08:19,310 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:08:19,310 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:08:19,310 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 12:08:40,988 - app.services.chatbot - INFO - LLM processing time: 21.68s
2025-04-08 12:08:40,988 - app.services.chatbot - INFO - Total processing time: 21.68s
2025-04-08 12:12:30,045 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:12:30,094 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:12:30,094 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:12:30,103 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 12:12:30,103 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:12:31,929 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:12:33,608 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:12:33,608 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:12:33,623 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:12:33,623 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:12:33,623 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:12:33,653 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:12:33,653 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:12:33,655 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 12:12:33,655 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 12:12:33,655 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 12:12:33,656 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 12:12:33,656 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 12:12:34,971 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 12:12:34,971 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 12:12:34,971 - app.services.chatbot - INFO - Testing model with a simple query...
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Test response completed in 3.04 seconds
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Test response: 
A: 4...
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Fast inference time (3.04s) - GPU acceleration confirmed
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Created prompt template
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:12:38,028 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 12:12:59,606 - app.services.chatbot - INFO - LLM processing time: 21.58s
2025-04-08 12:12:59,606 - app.services.chatbot - INFO - Total processing time: 21.58s
2025-04-08 12:14:11,625 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:14:11,680 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:14:11,680 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:14:11,688 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 12:14:11,688 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:14:13,546 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:14:15,343 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:14:15,359 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:14:15,359 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:14:15,359 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:14:15,359 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:14:15,388 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:14:15,388 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:14:15,390 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 12:14:15,390 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 12:14:15,391 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 12:14:15,391 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 12:14:15,391 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 12:14:16,737 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 12:14:16,737 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 12:14:16,738 - app.services.chatbot - INFO - Testing model with a simple query...
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Test response completed in 3.44 seconds
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Test response: 
A: 4...
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Fast inference time (3.44s) - GPU acceleration confirmed
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Created prompt template
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Processing query: Xin chào
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 12:14:20,175 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 12:14:42,237 - app.services.chatbot - INFO - LLM processing time: 22.06s
2025-04-08 12:14:42,237 - app.services.chatbot - INFO - Total processing time: 22.06s
2025-04-08 12:20:11,600 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:20:11,654 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:20:11,654 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:20:11,654 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 12:20:11,654 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:20:13,522 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:20:15,409 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:20:15,412 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:20:15,412 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:20:15,413 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:20:15,425 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:20:15,442 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:20:15,443 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:20:15,445 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 12:20:15,445 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 12:20:15,445 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 12:20:15,445 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 12:20:15,445 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 12:20:16,801 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 12:20:16,801 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 12:20:16,802 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 12:21:57,003 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 12:21:57,086 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 12:21:57,086 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 12:21:57,086 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 12:21:57,086 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:21:59,070 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 12:22:00,886 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 12:22:00,902 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 12:22:00,902 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 12:22:00,903 - faiss.loader - INFO - Loading faiss.
2025-04-08 12:22:00,920 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 12:22:00,936 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 12:22:00,936 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 12:22:00,936 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 12:22:00,936 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 12:22:00,936 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 12:22:00,936 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 12:22:00,936 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 12:22:02,354 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 12:22:02,354 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 12:22:02,354 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 19:53:25,897 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 19:53:25,955 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 19:53:25,955 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 19:53:25,955 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 19:53:25,955 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 19:53:34,266 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 19:53:36,737 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 19:53:36,737 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 19:53:36,737 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 19:53:36,737 - faiss.loader - INFO - Loading faiss.
2025-04-08 19:53:37,003 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 19:53:37,026 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 19:53:37,033 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 19:53:37,034 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 19:53:37,035 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 19:53:37,035 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 19:53:37,035 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 19:53:37,035 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 19:53:40,274 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 19:53:40,274 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 19:53:40,274 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 19:57:09,650 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 19:57:09,710 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 19:57:09,711 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 19:57:09,711 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 19:57:09,712 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 19:57:11,532 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 19:57:13,178 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 19:57:13,178 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 19:57:13,178 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 19:57:13,178 - faiss.loader - INFO - Loading faiss.
2025-04-08 19:57:13,204 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 19:57:13,217 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 19:57:13,217 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 19:57:13,219 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 19:57:13,219 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 19:57:13,219 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 19:57:13,219 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 19:57:13,219 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 19:57:14,416 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 19:57:14,417 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 19:57:14,417 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 20:06:11,517 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 20:06:11,583 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 20:06:11,584 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 20:06:11,585 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 20:06:11,585 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:06:13,391 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:06:15,096 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 20:06:15,096 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 20:06:15,096 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 20:06:15,096 - faiss.loader - INFO - Loading faiss.
2025-04-08 20:06:15,115 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 20:06:15,126 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 20:06:15,126 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 20:06:15,133 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 20:06:15,133 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 20:06:15,133 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 20:06:15,133 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 20:06:15,133 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 20:06:16,483 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 20:06:16,483 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 20:06:16,483 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 20:12:16,480 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'nhu cầu chính của khách hàng là gì'
2025-04-08 20:12:16,492 - app.api.endpoints.chat - INFO - Using Local model with model: mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 20:12:16,492 - app.services.chatbot - INFO - Processing query: nhu cầu chính của khách hàng là gì
2025-04-08 20:12:16,492 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 20:12:16,492 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 20:12:16,493 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 20:12:43,516 - app.services.chatbot - INFO - LLM processing time: 27.02s
2025-04-08 20:12:43,516 - app.services.chatbot - INFO - Total processing time: 27.02s
2025-04-08 20:12:43,516 - app.api.endpoints.chat - INFO - Generated response for user 3 in 27.0244300365448 seconds
2025-04-08 20:14:43,642 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-08 20:14:43,642 - app.api.endpoints.chat - INFO - Using Local model with model: mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 20:14:43,642 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-08 20:14:43,642 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 20:14:43,642 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 20:14:43,642 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 20:14:58,482 - app.services.chatbot - INFO - LLM processing time: 14.84s
2025-04-08 20:14:58,482 - app.services.chatbot - INFO - Total processing time: 14.84s
2025-04-08 20:14:58,482 - app.api.endpoints.chat - INFO - Generated response for user 3 in 14.840807437896729 seconds
2025-04-08 20:18:00,918 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 20:18:00,983 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 20:18:00,983 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 20:18:00,984 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 20:18:00,984 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:18:03,456 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:18:05,689 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 20:18:05,689 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 20:18:05,689 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 20:18:05,689 - faiss.loader - INFO - Loading faiss.
2025-04-08 20:18:05,715 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 20:18:05,728 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 20:18:05,728 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 20:18:05,732 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 20:18:05,732 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 20:18:05,733 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 20:18:05,733 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 20:18:05,733 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 20:18:08,748 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 20:18:08,748 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 20:18:08,748 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 20:18:45,589 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-08 20:18:45,590 - app.api.endpoints.chat - INFO - Using Local model with model: mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 20:18:45,590 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-08 20:18:45,591 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 20:18:45,591 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 20:18:45,591 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 20:19:17,933 - app.services.chatbot - INFO - LLM processing time: 32.34s
2025-04-08 20:19:17,933 - app.services.chatbot - INFO - Total processing time: 32.34s
2025-04-08 20:19:17,933 - app.api.endpoints.chat - INFO - Generated response for user 3 in 32.343019008636475 seconds
2025-04-08 20:25:30,328 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 20:25:30,380 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 20:25:30,380 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 20:25:30,381 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 20:25:30,381 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:25:39,526 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:25:41,683 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 20:25:41,688 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 20:25:41,688 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 20:25:41,688 - faiss.loader - INFO - Loading faiss.
2025-04-08 20:25:41,711 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 20:25:41,728 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 20:25:41,729 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 20:25:41,730 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 20:25:41,731 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 20:25:41,731 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 20:25:41,731 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 20:25:41,732 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 20:25:44,947 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 20:25:44,947 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 20:25:44,948 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 20:26:30,179 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 20:26:30,229 - app.services.chatbot - INFO - Cleaned GPU memory: allocated=0.00MB, reserved=0.00MB
2025-04-08 20:26:30,230 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 20:26:30,231 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 20:26:30,231 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:26:32,751 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 20:26:42,350 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 20:26:42,355 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 20:26:42,356 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 20:26:42,356 - faiss.loader - INFO - Loading faiss.
2025-04-08 20:26:42,470 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 20:26:42,485 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: '__fields_set__'
2025-04-08 20:26:42,485 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 20:26:42,486 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 20:26:42,487 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 20:26:42,487 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 20:26:42,487 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 20:26:42,487 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 20:26:46,082 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 20:26:46,082 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 20:26:46,082 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 20:27:41,211 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-08 20:27:41,212 - app.api.endpoints.chat - INFO - Using Local model with model: mistral-7b-instruct-v0.1.Q2_K.gguf
2025-04-08 20:27:41,212 - app.services.chatbot - INFO - Processing query: Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào
2025-04-08 20:27:41,213 - app.services.chatbot - INFO - Retriever not available, skipping document retrieval
2025-04-08 20:27:41,213 - app.services.chatbot - INFO - Generating prompt...
2025-04-08 20:27:41,213 - app.services.chatbot - INFO - Calling LLM for answer...
2025-04-08 20:28:23,861 - app.services.chatbot - INFO - LLM processing time: 42.65s
2025-04-08 20:28:23,861 - app.services.chatbot - INFO - Total processing time: 42.65s
2025-04-08 20:28:23,861 - app.api.endpoints.chat - INFO - Generated response for user 3 in 42.649189710617065 seconds
2025-04-08 21:10:47,962 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:10:47,962 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:10:51,538 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:10:51,539 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:10:52,682 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:10:52,745 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:10:52,745 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:10:52,746 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:10:52,746 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:11:36,912 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-08 21:11:36,912 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:11:36,917 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:11:37,976 - app.services.api_service - INFO - Google API response received in 1.06 seconds
2025-04-08 21:11:37,977 - app.api.endpoints.chat - INFO - Generated response for user 3 in 1.0643019676208496 seconds
2025-04-08 21:14:30,364 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:14:30,364 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:14:33,792 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:14:33,792 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:14:34,920 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:14:34,989 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:14:34,989 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:14:34,989 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:14:34,989 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:15:06,198 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kết phiên giao dịch ngày 10-2, chỉ số VN-Index như thế nào'
2025-04-08 21:15:06,198 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:15:06,198 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:15:08,025 - app.services.api_service - INFO - Google API response received in 1.83 seconds
2025-04-08 21:15:08,026 - app.api.endpoints.chat - INFO - Generated response for user 3 in 1.828434705734253 seconds
2025-04-08 21:28:42,173 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:28:42,236 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:28:42,236 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:28:42,236 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:28:42,236 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:28:44,089 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:28:45,987 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:28:45,990 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:28:45,990 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:28:45,991 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:28:46,009 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:28:46,016 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:28:46,016 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:28:46,017 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 21:28:46,017 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 21:28:46,017 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 21:28:46,017 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 21:28:46,018 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 21:28:49,441 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 21:28:49,441 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 21:28:49,442 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:29:26,408 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:29:26,473 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:29:26,473 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:29:26,473 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:29:26,473 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:29:28,881 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:29:31,393 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:29:31,397 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:29:31,397 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:29:31,397 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:29:31,416 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:29:31,418 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:29:31,418 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:29:31,418 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 21:29:31,418 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 21:29:31,418 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 21:29:31,418 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 21:29:31,418 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 21:29:34,718 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 21:29:34,718 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 21:29:34,726 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:30:00,927 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:30:00,927 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:30:04,598 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:30:04,598 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:30:05,762 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:30:05,826 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:30:05,826 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:30:05,826 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:30:05,826 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:30:34,833 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'kinh tế học là gì'
2025-04-08 21:30:34,834 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:30:34,835 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:30:39,067 - app.services.api_service - INFO - Google API response received in 4.23 seconds
2025-04-08 21:30:39,067 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.233837366104126 seconds
2025-04-08 21:35:31,350 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:35:31,350 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:35:34,897 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:35:34,897 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:35:36,017 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:35:36,082 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:35:36,083 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:35:36,083 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:35:36,083 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:35:38,497 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:35:40,947 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:35:40,947 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:35:40,947 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:35:40,947 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:35:40,972 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:35:40,980 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:35:40,980 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:35:40,981 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:35:40,981 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:35:40,981 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:36:06,220 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'kinh tế học là gì'
2025-04-08 21:36:06,221 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:36:06,221 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:36:10,657 - app.services.api_service - INFO - Google API response received in 4.44 seconds
2025-04-08 21:36:10,657 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.435338973999023 seconds
2025-04-08 21:37:31,076 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:37:31,076 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:37:34,659 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:37:34,659 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:37:35,771 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:37:35,827 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:37:35,827 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:37:35,827 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:37:35,827 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:37:37,709 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:37:39,736 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:37:39,736 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:37:39,736 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:37:39,736 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:37:39,755 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:37:39,762 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:37:39,763 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:37:39,763 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:37:39,763 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:37:39,763 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:38:01,860 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'kinh tế học là gì'
2025-04-08 21:38:01,860 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:38:01,861 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:38:05,916 - app.services.api_service - INFO - Google API response received in 4.06 seconds
2025-04-08 21:38:05,916 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.0557050704956055 seconds
2025-04-08 21:38:39,011 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học phát triển là gì'
2025-04-08 21:38:39,011 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:38:39,011 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:38:42,536 - app.services.api_service - INFO - Google API response received in 3.53 seconds
2025-04-08 21:38:42,536 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.5255239009857178 seconds
2025-04-08 21:39:27,225 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:39:27,286 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:39:27,286 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:39:27,286 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:39:27,286 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:39:29,104 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:39:30,966 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:39:30,966 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:39:30,976 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:39:30,976 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:39:30,986 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:39:30,997 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:39:30,997 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:39:30,997 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 21:39:30,998 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 21:39:30,998 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 21:39:30,998 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 21:39:30,998 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 21:39:34,293 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 21:39:34,293 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 21:39:34,293 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:39:57,640 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học phát triển là gì'
2025-04-08 21:39:57,640 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:39:57,640 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:40:02,014 - app.services.api_service - INFO - Google API response received in 4.37 seconds
2025-04-08 21:40:02,014 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.374788522720337 seconds
2025-04-08 21:40:32,569 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:40:32,569 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:40:36,221 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:40:36,221 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:40:37,350 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:40:37,407 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:40:37,407 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:40:37,407 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:40:37,407 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:40:39,786 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:40:42,276 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:40:42,281 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:40:42,281 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:40:42,281 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:40:42,301 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:40:42,310 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:40:42,311 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:40:42,311 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:40:42,312 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:40:42,312 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:41:33,523 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:41:33,523 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:41:33,523 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:41:36,977 - app.services.api_service - INFO - Google API response received in 3.45 seconds
2025-04-08 21:41:36,978 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.4557113647460938 seconds
2025-04-08 21:45:58,509 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:45:58,510 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:45:59,322 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:45:59,381 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:45:59,382 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:45:59,382 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:45:59,382 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:01,296 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:03,150 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:46:03,150 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:46:03,155 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:46:03,155 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:46:03,165 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:46:03,174 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:46:03,175 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:46:03,175 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:46:03,176 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:46:03,176 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:46:08,325 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:46:08,325 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:46:09,145 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:46:09,211 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:46:09,211 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:46:09,212 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:46:09,212 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:11,065 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:12,974 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:46:12,978 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:46:12,978 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:46:12,979 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:46:12,996 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:46:13,003 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:46:13,003 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:46:13,004 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:46:13,004 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:46:13,004 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:46:18,195 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:46:18,195 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:46:19,015 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:46:19,074 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:46:19,074 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:46:19,075 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:46:19,075 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:20,895 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:51,315 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:46:51,315 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:46:54,895 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:46:54,895 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:46:56,015 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:46:56,075 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:46:56,075 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:46:56,080 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:46:56,080 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:57,995 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:46:59,945 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:46:59,948 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:46:59,948 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:46:59,948 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:46:59,965 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:46:59,969 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:46:59,970 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:46:59,970 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:46:59,970 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:46:59,971 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:47:19,570 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:47:19,571 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:47:19,571 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:47:19,985 - app.services.api_service - INFO - Google API response received in 0.41 seconds
2025-04-08 21:47:19,985 - app.services.api_service - ERROR - API error: 400 - {'error': {'code': 400, 'message': 'API key not valid. Please pass a valid API key.', 'status': 'INVALID_ARGUMENT', 'details': [{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'API_KEY_INVALID', 'domain': 'googleapis.com', 'metadata': {'service': 'generativelanguage.googleapis.com'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'API key not valid. Please pass a valid API key.'}]}}
2025-04-08 21:47:19,985 - app.api.endpoints.chat - INFO - Generated response for user 3 in 0.4135434627532959 seconds
2025-04-08 21:47:44,477 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:47:44,477 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:47:44,477 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:47:44,835 - app.services.api_service - INFO - Google API response received in 0.36 seconds
2025-04-08 21:47:44,835 - app.services.api_service - ERROR - API error: 400 - {'error': {'code': 400, 'message': 'API key not valid. Please pass a valid API key.', 'status': 'INVALID_ARGUMENT', 'details': [{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'API_KEY_INVALID', 'domain': 'googleapis.com', 'metadata': {'service': 'generativelanguage.googleapis.com'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'API key not valid. Please pass a valid API key.'}]}}
2025-04-08 21:47:44,835 - app.api.endpoints.chat - INFO - Generated response for user 3 in 0.35782885551452637 seconds
2025-04-08 21:48:22,405 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:48:22,405 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:48:23,239 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:48:23,304 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:48:23,304 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:48:23,304 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:48:23,308 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:48:25,184 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:48:27,075 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:48:27,083 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:48:27,083 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:48:27,085 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:48:27,100 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:48:27,105 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:48:27,105 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:48:27,105 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:48:27,106 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:48:27,106 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:48:41,294 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:48:41,294 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:48:44,900 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:48:44,900 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:48:46,021 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:48:46,082 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:48:46,083 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 21:48:46,083 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 21:48:46,083 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:48:47,973 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 21:48:49,835 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 21:48:49,838 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 21:48:49,839 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 21:48:49,839 - faiss.loader - INFO - Loading faiss.
2025-04-08 21:48:49,848 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 21:48:49,860 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 21:48:49,860 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 21:48:49,860 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:48:49,861 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:48:49,861 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:49:12,504 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:49:12,504 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:49:12,504 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:49:12,855 - app.services.api_service - INFO - Google API response received in 0.35 seconds
2025-04-08 21:49:12,855 - app.services.api_service - ERROR - API error: 400 - {'error': {'code': 400, 'message': 'API key not valid. Please pass a valid API key.', 'status': 'INVALID_ARGUMENT', 'details': [{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'API_KEY_INVALID', 'domain': 'googleapis.com', 'metadata': {'service': 'generativelanguage.googleapis.com'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'API key not valid. Please pass a valid API key.'}]}}
2025-04-08 21:49:12,855 - app.api.endpoints.chat - INFO - Generated response for user 3 in 0.3504343032836914 seconds
2025-04-08 21:51:05,361 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:51:05,361 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:51:08,958 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:51:08,958 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:51:10,074 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:51:10,134 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:51:10,134 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:51:10,134 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:51:10,141 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:51:45,778 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:51:45,778 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:51:45,779 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:51:46,137 - app.services.api_service - INFO - Google API response received in 0.36 seconds
2025-04-08 21:51:46,137 - app.services.api_service - ERROR - API error: 400 - {'error': {'code': 400, 'message': 'API key not valid. Please pass a valid API key.', 'status': 'INVALID_ARGUMENT', 'details': [{'@type': 'type.googleapis.com/google.rpc.ErrorInfo', 'reason': 'API_KEY_INVALID', 'domain': 'googleapis.com', 'metadata': {'service': 'generativelanguage.googleapis.com'}}, {'@type': 'type.googleapis.com/google.rpc.LocalizedMessage', 'locale': 'en-US', 'message': 'API key not valid. Please pass a valid API key.'}]}}
2025-04-08 21:51:46,137 - app.api.endpoints.chat - INFO - Generated response for user 3 in 0.3582160472869873 seconds
2025-04-08 21:52:36,841 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:52:36,841 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:52:40,433 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 21:52:40,433 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 21:52:41,541 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 21:52:41,606 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 21:52:41,606 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 21:52:41,606 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 21:52:41,607 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 21:53:07,851 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 21:53:07,851 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 21:53:07,851 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 21:53:11,191 - app.services.api_service - INFO - Google API response received in 3.34 seconds
2025-04-08 21:53:11,191 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.33966326713562 seconds
2025-04-08 22:05:52,476 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:05:52,476 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:05:56,095 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:05:56,095 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:05:57,205 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:05:57,271 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:05:57,271 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:05:57,272 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:05:57,272 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:06:13,587 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 22:06:13,587 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:06:13,589 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:06:16,950 - app.services.api_service - INFO - Google API response received in 3.36 seconds
2025-04-08 22:06:16,950 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.3630588054656982 seconds
2025-04-08 22:13:13,228 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:13:13,229 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:13:16,909 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:13:16,910 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:13:18,013 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:13:18,077 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:13:18,083 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:13:19,590 - app.services.chatbot - ERROR - Error initializing Gemini API: 404 models/gemini-pro is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.
2025-04-08 22:13:19,591 - app.services.chatbot - WARNING - Falling back to local model
2025-04-08 22:13:19,591 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 22:13:19,592 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 22:13:19,592 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:13:21,512 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:13:23,415 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 22:13:23,425 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:13:23,425 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:13:23,426 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:13:23,447 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:13:23,456 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:13:23,457 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 22:13:23,457 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 22:13:23,458 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 22:13:23,458 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 22:13:23,458 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 22:13:23,458 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 22:13:27,017 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 22:13:27,017 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 22:13:27,017 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:14:07,561 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 22:14:07,561 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:14:07,563 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:14:11,873 - app.services.api_service - INFO - Google API response received in 4.31 seconds
2025-04-08 22:14:11,880 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.318709135055542 seconds
2025-04-08 22:15:57,373 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:15:57,373 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:16:01,025 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:16:01,025 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:16:02,177 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:16:02,242 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:16:02,242 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:16:03,592 - app.services.chatbot - ERROR - Error initializing Gemini API: 404 models/gemini-pro is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.
2025-04-08 22:16:03,592 - app.services.chatbot - WARNING - Falling back to local model
2025-04-08 22:16:03,592 - app.services.chatbot - INFO - GPU detected: NVIDIA GeForce GTX 1650 with Max-Q Design with 4.00GB VRAM
2025-04-08 22:16:03,593 - app.services.chatbot - INFO - Free GPU memory: 0.00MB reserved, 0.00MB allocated
2025-04-08 22:16:03,593 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:16:06,062 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:16:08,502 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 22:16:08,502 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:16:08,502 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:16:08,502 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:16:08,532 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:16:08,542 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:16:08,542 - app.services.chatbot - WARNING - Continuing without embeddings/vectorstore
2025-04-08 22:16:08,543 - app.services.chatbot - INFO - Detected VRAM: 4.00 GB
2025-04-08 22:16:08,543 - app.services.chatbot - INFO - FORCE_GPU enabled: Using maximum GPU layers
2025-04-08 22:16:08,543 - app.services.chatbot - INFO - Using n_gpu_layers=32
2025-04-08 22:16:08,543 - app.services.chatbot - INFO - Using optimized GPU parameters
2025-04-08 22:16:08,544 - app.services.chatbot - INFO - Creating LlamaCpp model with parameters: n_gpu_layers=32, n_batch=512, use_mmap=False
2025-04-08 22:16:11,731 - app.services.chatbot - INFO - After model loading: 0.00MB allocated, 0.00MB reserved
2025-04-08 22:16:11,732 - app.services.chatbot - WARNING - Warning: Model might not be using GPU (low VRAM usage)
2025-04-08 22:16:11,733 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:20:34,239 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:20:34,239 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:20:37,741 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:20:37,741 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:20:38,900 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:20:38,962 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:20:38,962 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:20:39,700 - app.services.chatbot - ERROR - Error initializing Gemini API: 404 models/gemini-pro is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.
2025-04-08 22:20:39,700 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize Gemini API. Please check your API key and internet connection.
2025-04-08 22:20:39,759 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 68, in _initialize_components
    test_response = test_chat.send_message("Test connection")
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\generativeai\generative_models.py", line 578, in send_message
    response = self.model.generate_content(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\generativeai\generative_models.py", line 331, in generate_content
    response = self._client.generate_content(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\ai\generativelanguage_v1beta\services\generative_service\client.py", line 835, in generate_content
    response = rpc(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\gapic_v1\method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\retry\retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\retry\retry_unary.py", line 144, in retry_target
    result = target()
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\google\api_core\grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.NotFound: 404 models/gemini-pro is not found for API version v1beta, or is not supported for generateContent. Call ListModels to see the list of available models and their supported methods.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 81, in _initialize_components
    raise RuntimeError("Failed to initialize Gemini API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize Gemini API. Please check your API key and internet connection.

2025-04-08 22:22:07,627 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 22:22:07,627 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:22:07,629 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:22:11,199 - app.services.api_service - INFO - Google API response received in 3.57 seconds
2025-04-08 22:22:11,199 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.5716397762298584 seconds
2025-04-08 22:27:04,468 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:27:04,468 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:27:08,138 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:27:08,138 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:27:09,268 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:27:09,328 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:27:09,328 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:27:09,328 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:27:09,328 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:27:11,772 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:27:14,274 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 22:27:14,278 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:27:14,278 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:27:14,278 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:27:14,299 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:27:14,309 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:27:14,309 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database. Please check your vector store files.
2025-04-08 22:27:14,327 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 82, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 97, in _initialize_components
    raise RuntimeError("Failed to initialize vector database. Please check your vector store files.")
RuntimeError: Failed to initialize vector database. Please check your vector store files.

2025-04-08 22:29:14,060 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 22:29:14,061 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:29:14,061 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:29:17,731 - app.services.api_service - INFO - Google API response received in 3.67 seconds
2025-04-08 22:29:17,732 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.6702089309692383 seconds
2025-04-08 22:31:13,805 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:31:13,805 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:31:17,302 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:31:17,302 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:31:18,416 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:31:18,482 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:31:18,483 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:31:18,483 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:31:18,483 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:31:20,355 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:31:22,278 - app.services.chatbot - INFO - Loading vector store from vector_db
2025-04-08 22:31:22,282 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:31:22,282 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:31:22,283 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:31:22,299 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:31:22,305 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:31:22,306 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database. Please check your vector store files.
2025-04-08 22:31:22,306 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 82, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 97, in _initialize_components
    raise RuntimeError("Failed to initialize vector database. Please check your vector store files.")
RuntimeError: Failed to initialize vector database. Please check your vector store files.

2025-04-08 22:37:12,201 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:37:12,201 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:37:15,826 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:37:15,826 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:37:16,961 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:37:17,046 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:37:17,046 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:37:17,046 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:37:17,046 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:37:17,046 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:37:18,943 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:37:20,821 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:37:20,826 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:37:20,826 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:37:20,826 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:37:20,848 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:37:20,854 - app.services.chatbot - ERROR - Error loading FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:37:20,854 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:37:20,855 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:37:20,857 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:37:20,858 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 135, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:41:04,209 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:41:04,210 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:41:07,830 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:41:07,830 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:41:08,942 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:41:09,004 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:41:09,004 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:41:09,004 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:41:09,004 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:41:09,004 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:41:10,916 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:41:12,815 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:41:12,819 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:41:12,819 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:41:12,819 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:41:12,834 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:41:12,840 - app.services.chatbot - ERROR - Error loading FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:41:12,840 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:41:12,842 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:41:12,842 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:41:12,843 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 135, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:41:56,325 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:41:56,325 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:41:59,815 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:41:59,815 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:42:00,935 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:42:00,995 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:42:00,995 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:42:00,995 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:42:00,995 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:42:00,995 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:42:02,837 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:42:04,671 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:42:04,675 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:42:04,675 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:42:04,675 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:42:04,691 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:42:04,696 - app.services.chatbot - ERROR - Error loading FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:42:04,696 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:42:04,696 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:42:04,696 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'
2025-04-08 22:42:04,696 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 99, in _initialize_components
    self._db = FAISS.load_local(
  File "D:\ThucTap\ChatBotKinhTe\venv\lib\site-packages\langchain_community\vectorstores\faiss.py", line 1065, in load_local
    return cls(embeddings, index, docstore, index_to_docstore_id, **kwargs)
TypeError: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 113, in _initialize_components
    raise RuntimeError(f"Failed to load FAISS index: {str(faiss_err)}")
RuntimeError: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ThucTap\ChatBotKinhTe\app\services\chatbot.py", line 135, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: Failed to load FAISS index: FAISS.__init__() got an unexpected keyword argument 'allow_dangerous_deserialization'

2025-04-08 22:44:08,567 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:44:08,568 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:44:09,382 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:44:09,455 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:44:09,456 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:44:09,456 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:44:09,456 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:44:09,457 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:44:11,315 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:44:13,252 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:44:13,255 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:44:13,255 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:44:13,255 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:44:13,268 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:44:13,275 - app.services.chatbot - INFO - Vector store loaded successfully with 27 vectors
2025-04-08 22:44:13,275 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 22:44:13,275 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 22:44:14,844 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 22:44:14,844 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:44:49,725 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:44:49,725 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:44:53,357 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:44:53,357 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:44:54,176 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:44:54,238 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:44:54,238 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:44:54,239 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:44:54,239 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:44:54,240 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:44:56,035 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:44:57,909 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:44:57,914 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:44:57,914 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:44:57,914 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:44:57,942 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:44:57,951 - app.services.chatbot - INFO - Vector store loaded successfully with 27 vectors
2025-04-08 22:44:57,951 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 22:44:57,952 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 22:44:59,001 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 22:44:59,001 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:45:26,192 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:45:26,192 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:45:29,705 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:45:29,705 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:45:30,803 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:45:30,865 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:45:30,865 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:45:30,865 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:45:30,865 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:45:30,865 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:45:32,720 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:45:34,555 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:45:34,558 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:45:34,558 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:45:34,559 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:45:34,572 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:45:34,577 - app.services.chatbot - INFO - Vector store loaded successfully with 27 vectors
2025-04-08 22:45:34,577 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 22:45:34,577 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 22:45:34,974 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 22:45:34,974 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:46:28,527 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô'
2025-04-08 22:46:28,527 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:46:28,528 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:46:32,045 - app.services.api_service - INFO - Google API response received in 3.52 seconds
2025-04-08 22:46:32,045 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.5170860290527344 seconds
2025-04-08 22:49:26,374 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:49:26,374 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:49:29,899 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:49:29,899 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:49:31,014 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:49:31,074 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:49:31,074 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:49:31,074 - app.services.chatbot - INFO - Gemini API initialized successfully
2025-04-08 22:49:31,074 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:49:31,074 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:49:32,860 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:49:34,694 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:49:34,698 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:49:34,698 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:49:34,698 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:49:34,716 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:49:34,722 - app.services.chatbot - INFO - Vector store loaded successfully with 27 vectors
2025-04-08 22:49:34,723 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 22:49:34,724 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 22:49:35,729 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 22:49:35,729 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:51:13,884 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học là một ngành học rộng và phức tạp'
2025-04-08 22:51:13,884 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:51:13,884 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:51:17,184 - app.services.api_service - INFO - Google API response received in 3.30 seconds
2025-04-08 22:51:17,184 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.3002734184265137 seconds
2025-04-08 22:51:46,464 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô nghiên cứu gì'
2025-04-08 22:51:46,464 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:51:46,464 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:51:49,435 - app.services.api_service - INFO - Google API response received in 2.97 seconds
2025-04-08 22:51:49,435 - app.api.endpoints.chat - INFO - Generated response for user 3 in 2.9706661701202393 seconds
2025-04-08 22:55:47,631 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:55:47,631 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:55:51,554 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 22:55:51,554 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 22:55:52,693 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 22:55:52,763 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 22:55:52,763 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 22:55:52,763 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-08 22:55:52,763 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 22:55:52,763 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:55:54,634 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 22:55:56,493 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 22:55:56,496 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 22:55:56,496 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 22:55:56,497 - faiss.loader - INFO - Loading faiss.
2025-04-08 22:55:56,512 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 22:55:56,518 - app.services.chatbot - INFO - Vector store loaded successfully with 27 vectors
2025-04-08 22:55:56,518 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 22:55:56,518 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 22:55:57,614 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 22:55:57,614 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 22:57:01,073 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô nghiên cứu gì'
2025-04-08 22:57:01,073 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 22:57:01,073 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 22:57:04,632 - app.services.api_service - INFO - Google API response received in 3.56 seconds
2025-04-08 22:57:04,632 - app.api.endpoints.chat - INFO - Generated response for user 3 in 3.559831380844116 seconds
2025-04-08 23:00:39,451 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 23:00:39,451 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 23:00:43,262 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 23:00:43,262 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 23:00:44,372 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 23:00:44,442 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 23:00:44,442 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 23:00:44,442 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-08 23:00:44,442 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 23:00:44,442 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 23:00:46,473 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 23:00:48,477 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 23:00:48,477 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 23:00:48,477 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 23:00:48,482 - faiss.loader - INFO - Loading faiss.
2025-04-08 23:00:48,492 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 23:00:48,517 - app.services.chatbot - INFO - Vector store loaded successfully with 6 vectors
2025-04-08 23:00:48,517 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 23:00:48,519 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 23:00:49,647 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 23:00:49,647 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 23:01:13,753 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Kinh tế học vĩ mô nghiên cứu gì'
2025-04-08 23:01:13,753 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 23:01:13,753 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 23:01:16,502 - app.services.api_service - INFO - Google API response received in 2.75 seconds
2025-04-08 23:01:16,507 - app.api.endpoints.chat - INFO - Generated response for user 3 in 2.7540957927703857 seconds
2025-04-08 23:50:11,385 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 23:50:11,386 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 23:50:15,141 - app.api.endpoints.chat - INFO - Initializing API service with type: google
2025-04-08 23:50:15,141 - app.services.api_service - INFO - Initialized Google API service with model: gemini-2.0-flash
2025-04-08 23:50:16,261 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-08 23:50:16,327 - app.services.chatbot - INFO - GPU memory cleaned successfully
2025-04-08 23:50:16,328 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-08 23:50:16,328 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-08 23:50:16,329 - app.services.chatbot - INFO - Vector store path: ./vector_db
2025-04-08 23:50:16,329 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 23:50:18,299 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-08 23:50:20,245 - app.services.chatbot - INFO - Loading vector store from ./vector_db
2025-04-08 23:50:20,248 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-08 23:50:20,249 - faiss.loader - INFO - Could not load library with AVX2 support due to:
ModuleNotFoundError("No module named 'faiss.swigfaiss_avx2'")
2025-04-08 23:50:20,249 - faiss.loader - INFO - Loading faiss.
2025-04-08 23:50:20,263 - faiss.loader - INFO - Successfully loaded faiss.
2025-04-08 23:50:20,270 - app.services.chatbot - INFO - Vector store loaded successfully with 6 vectors
2025-04-08 23:50:20,270 - app.services.chatbot - INFO - Configuring retriever
2025-04-08 23:50:20,270 - app.services.chatbot - INFO - Retriever configured successfully
2025-04-08 23:50:21,285 - app.services.chatbot - INFO - Retriever test successful, found 4 document(s)
2025-04-08 23:50:21,286 - app.services.chatbot - INFO - ChatbotService components initialized successfully
2025-04-08 23:50:51,544 - app.api.endpoints.chat - INFO - Received chat-direct request from user 3: 'Lý thuyết tiêu dùng'
2025-04-08 23:50:51,545 - app.api.endpoints.chat - INFO - Using API with model: gemini-2.0-flash
2025-04-08 23:50:51,546 - app.services.api_service - INFO - Sending request to Google API: gemini-2.0-flash
2025-04-08 23:50:56,130 - app.services.api_service - INFO - Google API response received in 4.58 seconds
2025-04-08 23:50:56,130 - app.api.endpoints.chat - INFO - Generated response for user 3 in 4.5840277671813965 seconds
2025-04-14 00:52:09,346 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 00:52:09,353 - main - INFO - Initializing vector database...
2025-04-14 00:52:09,353 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 00:52:09,356 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 00:52:09,356 - main - INFO - Loading vector store...
2025-04-14 00:52:11,403 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:52:16,989 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 00:52:25,057 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:52:25,059 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:52:25,070 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:52:25,070 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:52:25,071 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:52:25,071 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 00:52:25,072 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:52:27,445 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:52:28,466 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 00:52:28,545 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 00:52:28,643 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 00:52:28,648 - main - INFO - Vector database retriever configured successfully
2025-04-14 00:52:28,649 - main - INFO - Testing retriever with a simple query
2025-04-14 00:52:28,749 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 00:52:28,749 - main - INFO - Initializing Gemini model...
2025-04-14 00:52:28,749 - main - INFO - Initializing Gemini model...
2025-04-14 00:52:28,750 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 00:52:28,750 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 00:52:29,412 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 00:52:29,506 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 00:52:29,507 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 00:52:38,518 - main - INFO - Simple chat request received with message: Kinh t? Vi?t Nam
2025-04-14 00:52:38,527 - main - INFO - Retrieved 3 documents for query: Kinh t? Vi?t Nam
2025-04-14 00:52:38,527 - main - INFO - Document 1: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.
2025-04-14 00:52:38,528 - main - INFO - Document 2: Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.
2025-04-14 00:52:38,528 - main - INFO - Document 3: Việt Nam đã ký kết nhiều hiệp định thương mại tự do với các đối tác lớn như EU, Hàn Quốc, Nhật Bản.
2025-04-14 00:53:24,780 - main - ERROR - Error in simple chat request parsing: 'utf-8' codec can't decode byte 0xe1 in position 21: invalid continuation byte
2025-04-14 00:53:24,793 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 479, in simple_chat
    body = await request.json()
  File "/usr/local/lib/python3.9/site-packages/starlette/requests.py", line 252, in json
    self._json = json.loads(body)
  File "/usr/local/lib/python3.9/json/__init__.py", line 341, in loads
    s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 21: invalid continuation byte

2025-04-14 00:54:39,366 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 00:54:39,373 - main - INFO - Initializing vector database...
2025-04-14 00:54:39,373 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 00:54:39,375 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 00:54:39,376 - main - INFO - Loading vector store...
2025-04-14 00:54:41,447 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:54:46,907 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 00:54:55,253 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:54:55,255 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:54:55,267 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:54:55,268 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:54:55,269 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:54:55,269 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 00:54:55,270 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:54:57,539 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:54:57,590 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 00:54:57,606 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 00:54:57,618 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 00:54:57,624 - main - INFO - Vector database retriever configured successfully
2025-04-14 00:54:57,624 - main - INFO - Testing retriever with a simple query
2025-04-14 00:54:57,640 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 00:54:57,640 - main - INFO - Initializing Gemini model...
2025-04-14 00:54:57,640 - main - INFO - Initializing Gemini model...
2025-04-14 00:54:57,641 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 00:54:57,641 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 00:54:58,302 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 00:54:58,309 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 00:54:58,310 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 00:55:36,638 - main - INFO - Raw request body length: 31
2025-04-14 00:55:36,639 - main - INFO - Used utf-8 encoding for request body
2025-04-14 00:55:36,639 - main - INFO - Parsed JSON: {'message': 'kinh te'}
2025-04-14 00:55:36,639 - main - INFO - Simple chat request received with message: kinh te
2025-04-14 00:55:36,647 - main - INFO - Retrieved 3 documents for query: kinh te
2025-04-14 00:55:36,648 - main - INFO - Document 1: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.
2025-04-14 00:55:36,648 - main - INFO - Document 2: Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.
2025-04-14 00:55:36,648 - main - INFO - Document 3: Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.
2025-04-14 00:55:47,839 - main - INFO - Raw request body length: 31
2025-04-14 00:55:47,840 - main - INFO - Used utf-8 encoding for request body
2025-04-14 00:55:47,840 - main - INFO - Parsed JSON: {'message': 'kinh te'}
2025-04-14 00:55:47,840 - main - INFO - Simple chat request received with message: kinh te
2025-04-14 00:55:47,848 - main - INFO - Retrieved 3 documents for query: kinh te
2025-04-14 00:55:47,849 - main - INFO - Document 1: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.
2025-04-14 00:55:47,849 - main - INFO - Document 2: Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.
2025-04-14 00:55:47,849 - main - INFO - Document 3: Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.
2025-04-14 00:57:04,967 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 00:57:04,974 - main - INFO - Initializing vector database...
2025-04-14 00:57:04,974 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 00:57:04,976 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 00:57:04,976 - main - INFO - Loading vector store...
2025-04-14 00:57:07,033 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:57:12,838 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 00:57:21,367 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:57:21,369 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:57:21,381 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:57:21,382 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 00:57:21,383 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 00:57:21,384 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 00:57:21,384 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 00:57:23,697 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 00:57:23,737 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 00:57:23,752 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 00:57:23,764 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 00:57:23,768 - main - INFO - Vector database retriever configured successfully
2025-04-14 00:57:23,769 - main - INFO - Testing retriever with a simple query
2025-04-14 00:57:23,785 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 00:57:23,785 - main - INFO - Initializing Gemini model...
2025-04-14 00:57:23,785 - main - INFO - Initializing Gemini model...
2025-04-14 00:57:23,786 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 00:57:23,786 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 00:57:24,306 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 00:57:24,317 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 00:57:24,317 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 01:05:17,255 - main - INFO - Request received at root (/) - redirecting to /api/v1/chat/chat-direct
2025-04-14 01:05:17,255 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-14 01:05:17,256 - main - INFO - Raw request body length: 38
2025-04-14 01:05:17,256 - main - INFO - Used utf-8 encoding for request body
2025-04-14 01:05:17,256 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-14 01:05:17,257 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-14 01:05:17,257 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 01:05:17,257 - main - INFO - Initializing Gemini model...
2025-04-14 01:05:17,257 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 01:05:17,258 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 01:05:18,814 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 01:05:18,817 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 01:05:18,827 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-14 01:05:18,828 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 01:05:18,828 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nCác ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.\n\nDu lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.', 'query': 'kinh tế', 'processing_time': '1.57 seconds'}
2025-04-14 01:10:58,839 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 01:10:58,844 - main - INFO - Initializing vector database...
2025-04-14 01:10:58,845 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 01:10:58,847 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 01:10:58,847 - main - INFO - Loading vector store...
2025-04-14 01:11:00,857 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 01:11:06,301 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 01:11:14,858 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 01:11:14,860 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 01:11:14,873 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 01:11:14,873 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 01:11:14,874 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 01:11:14,874 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 01:11:14,875 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 01:11:17,504 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 01:11:17,548 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 01:11:17,562 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 01:11:17,590 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 01:11:17,596 - main - INFO - Vector database retriever configured successfully
2025-04-14 01:11:17,596 - main - INFO - Testing retriever with a simple query
2025-04-14 01:11:17,612 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 01:11:17,612 - main - INFO - Initializing Gemini model...
2025-04-14 01:11:17,613 - main - INFO - Initializing Gemini model...
2025-04-14 01:11:17,613 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 01:11:17,613 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 01:11:18,500 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 01:11:18,514 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 01:11:18,514 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 01:11:36,414 - main - INFO - Request received at root (/) - redirecting to /api/v1/chat/chat-direct
2025-04-14 01:11:36,415 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-14 01:11:36,416 - main - INFO - Raw request body length: 123
2025-04-14 01:11:36,416 - main - INFO - Used utf-8 encoding for request body
2025-04-14 01:11:36,416 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-14 01:11:36,417 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-14 01:11:36,417 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 01:11:36,417 - main - INFO - Initializing Gemini model...
2025-04-14 01:11:36,418 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 01:11:36,418 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 01:11:36,934 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 01:11:36,935 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 01:11:36,944 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-14 01:11:36,944 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 01:11:36,944 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam đang phấn đấu trở thành nước công nghiệp hiện đại vào năm 2045.\n\nViệt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nViệt Nam đã ký kết nhiều hiệp định thương mại tự do với các đối tác lớn như EU, Hàn Quốc, Nhật Bản.', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '0.53 seconds'}
2025-04-14 01:52:26,428 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 01:52:26,434 - main - INFO - Initializing vector database...
2025-04-14 01:52:26,434 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 01:52:26,437 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 01:52:26,438 - main - INFO - Loading vector store...
2025-04-14 01:52:30,631 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 01:52:38,439 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 01:52:46,419 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 01:52:46,421 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 01:52:46,423 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 01:52:46,423 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 01:52:46,424 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 01:52:46,425 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 01:52:46,425 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 01:52:48,977 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 01:52:49,093 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 01:52:49,150 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 01:52:49,177 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 01:52:49,184 - main - INFO - Vector database retriever configured successfully
2025-04-14 01:52:49,185 - main - INFO - Testing retriever with a simple query
2025-04-14 01:52:49,213 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 01:52:49,214 - main - INFO - Initializing Gemini model...
2025-04-14 01:52:49,214 - main - INFO - Initializing Gemini model...
2025-04-14 01:52:49,215 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 01:52:49,215 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 01:52:51,022 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 01:52:51,041 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 01:52:51,041 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:00:15,651 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 02:00:15,656 - main - INFO - Initializing vector database...
2025-04-14 02:00:15,656 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 02:00:15,659 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 02:00:15,659 - main - INFO - Loading vector store...
2025-04-14 02:00:16,658 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:00:22,523 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 02:00:32,772 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:00:32,779 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:00:32,782 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:00:32,784 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:00:32,786 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:00:32,787 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 02:00:32,789 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:00:35,631 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:00:35,675 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 02:00:35,690 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 02:00:35,701 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 02:00:35,708 - main - INFO - Vector database retriever configured successfully
2025-04-14 02:00:35,708 - main - INFO - Testing retriever with a simple query
2025-04-14 02:00:35,723 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 02:00:35,724 - main - INFO - Initializing Gemini model...
2025-04-14 02:00:35,724 - main - INFO - Initializing Gemini model...
2025-04-14 02:00:35,724 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:00:35,725 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:00:37,466 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:00:37,468 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:00:37,468 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:03:04,169 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 02:03:04,174 - main - INFO - Initializing vector database...
2025-04-14 02:03:04,174 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 02:03:04,177 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 02:03:04,177 - main - INFO - Loading vector store...
2025-04-14 02:03:07,810 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:03:21,719 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 02:03:32,384 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:03:32,392 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:03:32,399 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:03:32,401 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:03:32,404 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:03:32,405 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 02:03:32,407 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:03:35,040 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:03:35,245 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 02:03:35,289 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 02:03:35,302 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 02:03:35,307 - main - INFO - Vector database retriever configured successfully
2025-04-14 02:03:35,308 - main - INFO - Testing retriever with a simple query
2025-04-14 02:03:35,326 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 02:03:35,326 - main - INFO - Initializing Gemini model...
2025-04-14 02:03:35,327 - main - INFO - Initializing Gemini model...
2025-04-14 02:03:35,327 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:03:35,327 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:03:36,774 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:03:36,816 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:03:36,818 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:15:25,071 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 02:15:25,077 - main - INFO - Initializing vector database...
2025-04-14 02:15:25,077 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 02:15:25,080 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 02:15:25,080 - main - INFO - Loading vector store...
2025-04-14 02:15:27,829 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:15:34,218 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 02:15:42,195 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:15:42,197 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:15:42,211 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:15:42,211 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:15:42,212 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:15:42,213 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 02:15:42,213 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:15:45,068 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:15:45,233 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 02:15:45,252 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 02:15:45,267 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 02:15:45,272 - main - INFO - Vector database retriever configured successfully
2025-04-14 02:15:45,272 - main - INFO - Testing retriever with a simple query
2025-04-14 02:15:45,291 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 02:15:45,291 - main - INFO - Initializing Gemini model...
2025-04-14 02:15:45,292 - main - INFO - Initializing Gemini model...
2025-04-14 02:15:45,292 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:15:45,292 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:15:46,289 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:15:46,326 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:15:46,327 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:18:08,222 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 02:18:08,229 - main - INFO - Initializing vector database...
2025-04-14 02:18:08,229 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 02:18:08,232 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 02:18:08,232 - main - INFO - Loading vector store...
2025-04-14 02:18:11,628 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:18:17,853 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 02:18:27,471 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:18:27,473 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:18:27,475 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:18:27,476 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:18:27,477 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:18:27,477 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 02:18:27,478 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:18:30,144 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:18:30,371 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 02:18:30,434 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 02:18:30,480 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 02:18:30,502 - main - INFO - Vector database retriever configured successfully
2025-04-14 02:18:30,504 - main - INFO - Testing retriever with a simple query
2025-04-14 02:18:30,584 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 02:18:30,585 - main - INFO - Initializing Gemini model...
2025-04-14 02:18:30,587 - main - INFO - Initializing Gemini model...
2025-04-14 02:18:30,588 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:18:30,589 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:18:31,160 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:18:31,195 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:18:31,197 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:19:39,284 - main - INFO - Raw request body length: 31
2025-04-14 02:19:39,284 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:19:39,285 - main - INFO - Parsed JSON: {'message': 'kinh te'}
2025-04-14 02:19:39,285 - main - INFO - Simple chat request received with message: kinh te
2025-04-14 02:19:39,295 - main - INFO - Retrieved 3 documents for query: kinh te
2025-04-14 02:19:39,295 - main - INFO - Document 1: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.
2025-04-14 02:19:39,296 - main - INFO - Document 2: Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.
2025-04-14 02:19:39,296 - main - INFO - Document 3: Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.
2025-04-14 02:19:57,273 - main - INFO - Raw request body length: 31
2025-04-14 02:19:57,273 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:19:57,273 - main - INFO - Parsed JSON: {'message': 'kinh te'}
2025-04-14 02:19:57,274 - main - INFO - Simple chat request received with message: kinh te
2025-04-14 02:19:57,283 - main - INFO - Retrieved 3 documents for query: kinh te
2025-04-14 02:19:57,283 - main - INFO - Document 1: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.
2025-04-14 02:19:57,284 - main - INFO - Document 2: Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.
2025-04-14 02:19:57,284 - main - INFO - Document 3: Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.
2025-04-14 02:23:01,945 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-14 02:23:01,950 - main - INFO - Initializing vector database...
2025-04-14 02:23:01,950 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-14 02:23:01,953 - main - INFO - Found vector store files at /app/vector_db
2025-04-14 02:23:01,953 - main - INFO - Loading vector store...
2025-04-14 02:23:04,691 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:23:11,151 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-14 02:23:19,435 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:23:19,442 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:23:19,460 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:23:19,462 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-14 02:23:19,464 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-14 02:23:19,466 - main - INFO - Creating a dummy vector store with sample data
2025-04-14 02:23:19,467 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-14 02:23:22,177 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-14 02:23:22,224 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-14 02:23:22,245 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-14 02:23:22,259 - main - INFO - Dummy vector store created and saved successfully
2025-04-14 02:23:22,263 - main - INFO - Vector database retriever configured successfully
2025-04-14 02:23:22,264 - main - INFO - Testing retriever with a simple query
2025-04-14 02:23:22,282 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-14 02:23:22,282 - main - INFO - Initializing Gemini model...
2025-04-14 02:23:22,283 - main - INFO - Initializing Gemini model...
2025-04-14 02:23:22,283 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:23:22,284 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:23:24,030 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:23:24,058 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:23:24,059 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-14 02:23:24,282 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-14 02:23:24,283 - main - INFO - Raw request body length: 38
2025-04-14 02:23:24,283 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:23:24,283 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-14 02:23:24,284 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-14 02:23:24,284 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 02:23:24,285 - main - INFO - Initializing Gemini model...
2025-04-14 02:23:24,285 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:23:24,285 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:23:25,050 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:23:25,053 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:23:25,067 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-14 02:23:25,068 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 02:23:25,068 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nCác ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.\n\nDu lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam.', 'query': 'kinh tế', 'processing_time': '0.78 seconds'}
2025-04-14 02:24:59,260 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-14 02:24:59,261 - main - INFO - Raw request body length: 123
2025-04-14 02:24:59,262 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:24:59,262 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-14 02:24:59,262 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-14 02:24:59,262 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 02:24:59,263 - main - INFO - Initializing Gemini model...
2025-04-14 02:24:59,263 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:24:59,263 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:25:02,861 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:25:02,862 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:25:02,872 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-14 02:25:02,872 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 02:25:02,872 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam đang phấn đấu trở thành nước công nghiệp hiện đại vào năm 2045.\n\nViệt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nViệt Nam đã ký kết nhiều hiệp định thương mại tự do với các đối tác lớn như EU, Hàn Quốc, Nhật Bản.', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '3.61 seconds'}
2025-04-14 02:35:40,935 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '52'}
2025-04-14 02:35:40,936 - main - INFO - Raw request body length: 52
2025-04-14 02:35:40,936 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:35:40,937 - main - INFO - Parsed JSON: {'message': 'kinh tế việt nam', 'user_id': 3}
2025-04-14 02:35:40,937 - main - INFO - Extracted message: 'kinh tế việt nam', user_id: 3
2025-04-14 02:35:40,937 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 02:35:40,938 - main - INFO - Initializing Gemini model...
2025-04-14 02:35:40,938 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:35:40,938 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:35:41,872 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:35:41,874 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:35:41,883 - main - INFO - Found 3 relevant documents for query: kinh tế việt nam
2025-04-14 02:35:41,883 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 02:35:41,883 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nViệt Nam là thành viên của ASEAN, APEC, và WTO.\n\nCác ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.', 'query': 'kinh tế việt nam', 'processing_time': '0.95 seconds'}
2025-04-14 02:42:53,462 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '52'}
2025-04-14 02:42:53,463 - main - INFO - Raw request body length: 52
2025-04-14 02:42:53,463 - main - INFO - Used utf-8 encoding for request body
2025-04-14 02:42:53,463 - main - INFO - Parsed JSON: {'message': 'kinh tế việt nam', 'user_id': 3}
2025-04-14 02:42:53,463 - main - INFO - Extracted message: 'kinh tế việt nam', user_id: 3
2025-04-14 02:42:53,464 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 02:42:53,464 - main - INFO - Initializing Gemini model...
2025-04-14 02:42:53,464 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 02:42:53,465 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 02:42:55,094 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 02:42:55,095 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 02:42:55,103 - main - INFO - Found 3 relevant documents for query: kinh tế việt nam
2025-04-14 02:42:55,104 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 02:42:55,104 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nViệt Nam là thành viên của ASEAN, APEC, và WTO.\n\nCác ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ.', 'query': 'kinh tế việt nam', 'processing_time': '1.64 seconds'}
2025-04-14 03:05:12,762 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '118'}
2025-04-14 03:05:12,763 - main - INFO - Raw request body length: 118
2025-04-14 03:05:12,764 - main - INFO - Used utf-8 encoding for request body
2025-04-14 03:05:12,764 - main - INFO - Parsed JSON: {'message': 'dự đoán tình hình kinh tế vệt nam cho dẫn chứng', 'user_id': 3}
2025-04-14 03:05:12,764 - main - INFO - Extracted message: 'dự đoán tình hình kinh tế vệt nam cho dẫn chứng', user_id: 3
2025-04-14 03:05:12,765 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-14 03:05:12,765 - main - INFO - Initializing Gemini model...
2025-04-14 03:05:12,766 - main - INFO - Using API key: AIzaS...lsdNU (middle part hidden)
2025-04-14 03:05:12,766 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-14 03:05:13,709 - main - ERROR - Error initializing Gemini model: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-04-14 03:05:13,714 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 225, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]

2025-04-14 03:05:13,818 - main - INFO - Found 3 relevant documents for query: dự đoán tình hình kinh tế vệt nam cho dẫn chứng
2025-04-14 03:05:13,819 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-14 03:05:13,820 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa.\n\nViệt Nam đã ký kết nhiều hiệp định thương mại tự do với các đối tác lớn như EU, Hàn Quốc, Nhật Bản.\n\nXuất khẩu chính của Việt Nam bao gồm điện thoại, dệt may, điện tử, giày dép, gạo, cà phê, và thủy sản.', 'query': 'dự đoán tình hình kinh tế vệt nam cho dẫn chứng', 'processing_time': '1.06 seconds'}
2025-04-15 11:58:08,609 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-15 11:58:08,617 - main - INFO - Initializing vector database...
2025-04-15 11:58:08,618 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-15 11:58:08,620 - main - INFO - Found vector store files at /app/vector_db
2025-04-15 11:58:08,621 - main - INFO - Loading vector store...
2025-04-15 11:58:10,975 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 11:58:17,126 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-15 11:58:26,139 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 11:58:26,146 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 11:58:26,226 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 11:58:26,226 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 11:58:26,276 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 11:58:26,277 - main - INFO - Creating a dummy vector store with sample data
2025-04-15 11:58:26,277 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 11:58:28,659 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 11:58:28,757 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-15 11:58:28,789 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-15 11:58:28,803 - main - INFO - Dummy vector store created and saved successfully
2025-04-15 11:58:28,808 - main - INFO - Vector database retriever configured successfully
2025-04-15 11:58:28,809 - main - INFO - Testing retriever with a simple query
2025-04-15 11:58:28,828 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-15 11:58:28,829 - main - INFO - Initializing Gemini model...
2025-04-15 11:58:28,829 - main - INFO - Initializing Gemini model...
2025-04-15 11:58:28,830 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-15 11:58:28,830 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-15 11:58:30,109 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you?

2025-04-15 11:58:30,110 - main - INFO - Gemini model initialized successfully
2025-04-15 12:00:17,118 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '31'}
2025-04-15 12:00:17,119 - main - INFO - Raw request body length: 31
2025-04-15 12:00:17,119 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:00:17,120 - main - INFO - Parsed JSON: {'message': 'hello', 'user_id': 3}
2025-04-15 12:00:17,120 - main - INFO - Extracted message: 'hello', user_id: 3
2025-04-15 12:00:17,128 - main - INFO - Found 3 relevant documents for query: hello
2025-04-15 12:00:18,185 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'hello', 'processing_time': '1.06 seconds'}
2025-04-15 12:00:32,881 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '35'}
2025-04-15 12:00:32,882 - main - INFO - Raw request body length: 35
2025-04-15 12:00:32,882 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:00:32,882 - main - INFO - Parsed JSON: {'message': 'kinh tees', 'user_id': 3}
2025-04-15 12:00:32,882 - main - INFO - Extracted message: 'kinh tees', user_id: 3
2025-04-15 12:00:32,890 - main - INFO - Found 3 relevant documents for query: kinh tees
2025-04-15 12:00:34,478 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa."  "Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ." "Việt Nam đang phấn đấu trở thành nước công nghiệp hiện đại vào năm 2045."\n', 'query': 'kinh tees', 'processing_time': '1.60 seconds'}
2025-04-15 12:02:30,122 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-15 12:02:30,123 - main - INFO - Raw request body length: 123
2025-04-15 12:02:30,123 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:02:30,123 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-15 12:02:30,124 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-15 12:02:30,132 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-15 12:02:31,325 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '1.20 seconds'}
2025-04-15 12:04:42,207 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-15 12:04:42,212 - main - INFO - Initializing vector database...
2025-04-15 12:04:42,213 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-15 12:04:42,215 - main - INFO - Found vector store files at /app/vector_db
2025-04-15 12:04:42,216 - main - INFO - Loading vector store...
2025-04-15 12:04:43,215 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:04:48,889 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-15 12:04:58,167 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:04:58,172 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:04:58,175 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:04:58,176 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:04:58,178 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:04:58,179 - main - INFO - Creating a dummy vector store with sample data
2025-04-15 12:04:58,181 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:05:00,519 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:05:00,574 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-15 12:05:00,587 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-15 12:05:00,612 - main - INFO - Dummy vector store created and saved successfully
2025-04-15 12:05:00,619 - main - INFO - Vector database retriever configured successfully
2025-04-15 12:05:00,619 - main - INFO - Testing retriever with a simple query
2025-04-15 12:05:00,632 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-15 12:05:00,632 - main - INFO - Initializing Gemini model...
2025-04-15 12:05:00,633 - main - INFO - Initializing Gemini model...
2025-04-15 12:05:00,633 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-15 12:05:00,633 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-15 12:05:01,838 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-15 12:05:01,839 - main - INFO - Gemini model initialized successfully
2025-04-15 12:05:14,254 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-15 12:05:14,254 - main - INFO - Raw request body length: 123
2025-04-15 12:05:14,255 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:05:14,255 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-15 12:05:14,255 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-15 12:05:14,264 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-15 12:05:15,329 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '1.07 seconds'}
2025-04-15 12:05:30,509 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-15 12:05:30,509 - main - INFO - Raw request body length: 38
2025-04-15 12:05:30,510 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:05:30,510 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-15 12:05:30,510 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-15 12:05:30,518 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 12:05:31,959 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '1.45 seconds'}
2025-04-15 12:08:58,026 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-15 12:08:58,031 - main - INFO - Initializing vector database...
2025-04-15 12:08:58,032 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-15 12:08:58,034 - main - INFO - Found vector store files at /app/vector_db
2025-04-15 12:08:58,034 - main - INFO - Loading vector store...
2025-04-15 12:09:00,039 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:09:06,557 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-15 12:09:15,045 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:09:15,047 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:09:15,048 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:09:15,049 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:09:15,050 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:09:15,050 - main - INFO - Creating a dummy vector store with sample data
2025-04-15 12:09:15,051 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:09:18,246 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:09:18,299 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-15 12:09:18,316 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-15 12:09:18,327 - main - INFO - Dummy vector store created and saved successfully
2025-04-15 12:09:18,333 - main - INFO - Vector database retriever configured successfully
2025-04-15 12:09:18,333 - main - INFO - Testing retriever with a simple query
2025-04-15 12:09:18,352 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-15 12:09:18,353 - main - INFO - Initializing Gemini model...
2025-04-15 12:09:18,353 - main - INFO - Initializing Gemini model...
2025-04-15 12:09:18,354 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-15 12:09:18,354 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-15 12:09:19,655 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-15 12:09:19,656 - main - INFO - Gemini model initialized successfully
2025-04-15 12:09:29,912 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-15 12:09:29,913 - main - INFO - Raw request body length: 38
2025-04-15 12:09:29,914 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:09:29,914 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-15 12:09:29,914 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-15 12:09:29,923 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 12:09:31,369 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '1.46 seconds'}
2025-04-15 12:43:22,530 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-15 12:43:22,536 - main - INFO - Initializing vector database...
2025-04-15 12:43:22,537 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-15 12:43:22,538 - main - INFO - Found vector store files at /app/vector_db
2025-04-15 12:43:22,539 - main - INFO - Loading vector store...
2025-04-15 12:43:23,649 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:43:32,005 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-15 12:43:40,346 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:43:40,348 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:43:40,350 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:43:40,350 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 12:43:40,351 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 12:43:40,352 - main - INFO - Creating a dummy vector store with sample data
2025-04-15 12:43:40,352 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 12:43:43,170 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 12:43:43,225 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-15 12:43:43,258 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-15 12:43:43,275 - main - INFO - Dummy vector store created and saved successfully
2025-04-15 12:43:43,281 - main - INFO - Vector database retriever configured successfully
2025-04-15 12:43:43,281 - main - INFO - Testing retriever with a simple query
2025-04-15 12:43:43,297 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-15 12:43:43,298 - main - INFO - Initializing Gemini model...
2025-04-15 12:43:43,298 - main - INFO - Initializing Gemini model...
2025-04-15 12:43:43,299 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-15 12:43:43,299 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-15 12:43:44,934 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you would like me to do?

2025-04-15 12:43:44,934 - main - INFO - Gemini model initialized successfully
2025-04-15 12:44:04,274 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-15 12:44:04,275 - main - INFO - Raw request body length: 123
2025-04-15 12:44:04,275 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:44:04,276 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-15 12:44:04,276 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-15 12:44:04,284 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-15 12:44:05,365 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '1.09 seconds'}
2025-04-15 12:44:22,372 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-15 12:44:22,373 - main - INFO - Raw request body length: 38
2025-04-15 12:44:22,373 - main - INFO - Used utf-8 encoding for request body
2025-04-15 12:44:22,373 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-15 12:44:22,373 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-15 12:44:22,381 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 12:44:23,765 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '1.39 seconds'}
2025-04-15 13:22:52,853 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-15 13:22:52,860 - main - INFO - Initializing vector database...
2025-04-15 13:22:52,860 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-15 13:22:52,862 - main - INFO - Found vector store files at /app/vector_db
2025-04-15 13:22:52,862 - main - INFO - Loading vector store...
2025-04-15 13:22:54,980 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 13:23:08,503 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-15 13:23:17,029 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 13:23:17,032 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 13:23:17,034 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 13:23:17,034 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-15 13:23:17,035 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-15 13:23:17,036 - main - INFO - Creating a dummy vector store with sample data
2025-04-15 13:23:17,036 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-15 13:23:20,112 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-15 13:23:20,213 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-15 13:23:20,246 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-15 13:23:20,261 - main - INFO - Dummy vector store created and saved successfully
2025-04-15 13:23:20,266 - main - INFO - Vector database retriever configured successfully
2025-04-15 13:23:20,266 - main - INFO - Testing retriever with a simple query
2025-04-15 13:23:20,286 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-15 13:23:20,286 - main - INFO - Initializing Gemini model...
2025-04-15 13:23:20,287 - main - INFO - Initializing Gemini model...
2025-04-15 13:23:20,287 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-15 13:23:20,287 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-15 13:23:21,671 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-15 13:23:21,672 - main - INFO - Gemini model initialized successfully
2025-04-15 13:23:53,267 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-15 13:23:53,268 - main - INFO - Raw request body length: 38
2025-04-15 13:23:53,269 - main - INFO - Used utf-8 encoding for request body
2025-04-15 13:23:53,269 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-15 13:23:53,270 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-15 13:23:53,278 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 13:23:54,747 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '1.48 seconds'}
2025-04-15 13:52:22,345 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '39'}
2025-04-15 13:52:22,346 - main - INFO - Raw request body length: 39
2025-04-15 13:52:22,346 - main - INFO - Used utf-8 encoding for request body
2025-04-15 13:52:22,346 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 15}
2025-04-15 13:52:22,346 - main - INFO - Extracted message: 'kinh tế', user_id: 15
2025-04-15 13:52:22,358 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 13:52:23,983 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '1.64 seconds'}
2025-04-15 14:15:36,062 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '38'}
2025-04-15 14:15:36,063 - main - INFO - Raw request body length: 38
2025-04-15 14:15:36,063 - main - INFO - Used utf-8 encoding for request body
2025-04-15 14:15:36,064 - main - INFO - Parsed JSON: {'message': 'kinh tế', 'user_id': 3}
2025-04-15 14:15:36,064 - main - INFO - Extracted message: 'kinh tế', user_id: 3
2025-04-15 14:15:36,074 - main - INFO - Found 3 relevant documents for query: kinh tế
2025-04-15 14:15:38,741 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ. Du lịch là một trong những ngành dịch vụ quan trọng đóng góp vào GDP của Việt Nam."\n', 'query': 'kinh tế', 'processing_time': '2.68 seconds'}
2025-04-15 14:20:52,598 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '52'}
2025-04-15 14:20:52,598 - main - INFO - Raw request body length: 52
2025-04-15 14:20:52,599 - main - INFO - Used utf-8 encoding for request body
2025-04-15 14:20:52,599 - main - INFO - Parsed JSON: {'message': 'lịch sử viet nam', 'user_id': 3}
2025-04-15 14:20:52,599 - main - INFO - Extracted message: 'lịch sử viet nam', user_id: 3
2025-04-15 14:20:52,623 - main - INFO - Found 3 relevant documents for query: lịch sử viet nam
2025-04-15 14:20:53,933 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'lịch sử viet nam', 'processing_time': '1.33 seconds'}
2025-04-15 14:37:53,840 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '47'}
2025-04-15 14:37:53,841 - main - INFO - Raw request body length: 47
2025-04-15 14:37:53,841 - main - INFO - Used utf-8 encoding for request body
2025-04-15 14:37:53,842 - main - INFO - Parsed JSON: {'message': 'kinh tế viet nam', 'user_id': 3}
2025-04-15 14:37:53,842 - main - INFO - Extracted message: 'kinh tế viet nam', user_id: 3
2025-04-15 14:37:53,853 - main - INFO - Found 3 relevant documents for query: kinh tế viet nam
2025-04-15 14:37:55,604 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Việt Nam có nền kinh tế thị trường định hướng xã hội chủ nghĩa. Việt Nam là thành viên của ASEAN, APEC, và WTO. Các ngành kinh tế chính của Việt Nam bao gồm nông nghiệp, công nghiệp và dịch vụ."\n', 'query': 'kinh tế viet nam', 'processing_time': '1.76 seconds'}
2025-04-21 09:31:48,110 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 09:31:48,119 - main - INFO - Initializing vector database...
2025-04-21 09:31:48,120 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 09:31:48,122 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 09:31:48,123 - main - INFO - Loading vector store...
2025-04-21 09:31:50,496 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 09:31:57,373 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 09:32:05,296 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 09:32:05,298 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-21 09:32:05,300 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-21 09:32:05,301 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-21 09:32:05,302 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 165, in initialize_vector_db
    raise e
  File "/app/main.py", line 142, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-21 09:32:05,302 - main - INFO - Creating a dummy vector store with sample data
2025-04-21 09:32:05,303 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 09:32:07,660 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 09:32:07,761 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 09:32:07,795 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 09:32:07,814 - main - INFO - Dummy vector store created and saved successfully
2025-04-21 09:32:07,819 - main - INFO - Vector database retriever configured successfully
2025-04-21 09:32:07,820 - main - INFO - Testing retriever with a simple query
2025-04-21 09:32:07,838 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 09:32:07,839 - main - INFO - Initializing Gemini model...
2025-04-21 09:32:07,839 - main - INFO - Initializing Gemini model...
2025-04-21 09:32:07,840 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 09:32:07,840 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 09:32:09,807 - main - INFO - Gemini model test response: Connection successful!

2025-04-21 09:32:09,808 - main - INFO - Gemini model initialized successfully
2025-04-21 09:36:19,465 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 09:36:19,466 - main - INFO - Raw request body length: 123
2025-04-21 09:36:19,466 - main - INFO - Used utf-8 encoding for request body
2025-04-21 09:36:19,467 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 09:36:19,467 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 09:36:19,479 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 09:36:21,586 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '2.12 seconds'}
2025-04-21 09:43:27,467 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 09:43:27,472 - main - INFO - Initializing vector database...
2025-04-21 09:43:27,473 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 09:43:27,475 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 09:43:27,475 - main - INFO - Loading vector store...
2025-04-21 09:43:29,490 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 09:43:35,380 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 09:43:52,526 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 09:43:52,529 - main - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-21 09:43:52,532 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 147, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-21 09:43:52,533 - main - ERROR - Error initializing vector database: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-21 09:43:52,534 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 170, in initialize_vector_db
    raise e
  File "/app/main.py", line 147, in initialize_vector_db
    vectorstore = FAISS.load_local(
  File "/usr/local/lib/python3.9/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-04-21 09:43:52,535 - main - INFO - Creating a dummy vector store with sample data
2025-04-21 09:43:52,535 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 09:43:54,845 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 09:43:54,893 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 09:43:54,909 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 09:43:54,938 - main - INFO - Dummy vector store created and saved successfully
2025-04-21 09:43:54,944 - main - INFO - Vector database retriever configured successfully
2025-04-21 09:43:54,944 - main - INFO - Testing retriever with a simple query
2025-04-21 09:43:54,963 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 09:43:54,964 - main - INFO - Initializing Gemini model...
2025-04-21 09:43:54,964 - main - INFO - Initializing Gemini model...
2025-04-21 09:43:54,964 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 09:43:54,965 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 09:43:56,338 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-21 09:43:56,338 - main - INFO - Gemini model initialized successfully
2025-04-21 09:46:50,450 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 09:46:50,455 - main - INFO - Initializing vector database...
2025-04-21 09:46:50,456 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 09:46:50,458 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 09:46:50,459 - main - INFO - Loading vector store...
2025-04-21 09:46:52,667 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 09:46:59,172 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 09:47:07,816 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 09:47:07,821 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 09:47:07,855 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 09:47:08,192 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-21 09:47:09,471 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-21 09:47:09,471 - main - INFO - Vector database retriever configured successfully
2025-04-21 09:47:09,472 - main - INFO - Testing retriever with a simple query
2025-04-21 09:47:09,556 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 09:47:09,557 - main - INFO - Initializing Gemini model...
2025-04-21 09:47:09,557 - main - INFO - Initializing Gemini model...
2025-04-21 09:47:09,557 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 09:47:09,558 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 09:47:11,947 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-21 09:47:11,948 - main - INFO - Gemini model initialized successfully
2025-04-21 09:48:11,768 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '49', 'expect': '100-continue', 'connection': 'Keep-Alive'}
2025-04-21 09:48:11,771 - main - INFO - Raw request body length: 49
2025-04-21 09:48:11,771 - main - INFO - Used utf-8 encoding for request body
2025-04-21 09:48:11,772 - main - INFO - Parsed JSON: {'message': 'Kinh t? Vi?t Nam nam 2023'}
2025-04-21 09:48:11,772 - main - INFO - Extracted message: 'Kinh t? Vi?t Nam nam 2023', user_id: None
2025-04-21 09:48:11,796 - main - INFO - Found 3 relevant documents for query: Kinh t? Vi?t Nam nam 2023
2025-04-21 09:48:12,847 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Kinh t? Vi?t Nam nam 2023', 'processing_time': '1.07 seconds'}
2025-04-21 09:48:24,543 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '51', 'expect': '100-continue'}
2025-04-21 09:48:24,544 - main - INFO - Raw request body length: 51
2025-04-21 09:48:24,545 - main - INFO - Used latin-1 encoding for request body
2025-04-21 09:48:24,545 - main - INFO - Parsed JSON: {'message': 'Vi?t Nam xu?t kh?u nh?ng gì'}
2025-04-21 09:48:24,545 - main - INFO - Extracted message: 'Vi?t Nam xu?t kh?u nh?ng gì', user_id: None
2025-04-21 09:48:24,565 - main - INFO - Found 3 relevant documents for query: Vi?t Nam xu?t kh?u nh?ng gì
2025-04-21 09:48:26,351 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Năm 2025, Việt Nam hướng tới mục tiêu xuất khẩu rau, quả đạt 8 tỷ USD."  Ngoài ra, dữ liệu cũng đề cập đến xuất khẩu thủy sản: "Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ trợ... nhằm duy trì chuỗi sản xuất – xuất khẩu".\n', 'query': 'Vi?t Nam xu?t kh?u nh?ng gì', 'processing_time': '1.81 seconds'}
2025-04-21 09:48:35,159 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 09:48:35,160 - main - INFO - Raw request body length: 123
2025-04-21 09:48:35,160 - main - INFO - Used utf-8 encoding for request body
2025-04-21 09:48:35,160 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 09:48:35,161 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 09:48:35,183 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 09:48:37,389 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '2.23 seconds'}
2025-04-21 10:01:01,516 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 10:01:01,521 - main - INFO - Initializing vector database...
2025-04-21 10:01:01,522 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 10:01:01,525 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 10:01:01,525 - main - INFO - Loading vector store...
2025-04-21 10:01:03,610 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 10:01:09,260 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 10:01:17,954 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 10:01:17,962 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 10:01:17,982 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 10:01:18,322 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-21 10:01:19,676 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-21 10:01:19,677 - main - INFO - Vector database retriever configured successfully
2025-04-21 10:01:19,677 - main - INFO - Testing retriever with a simple query
2025-04-21 10:01:19,712 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 10:01:19,712 - main - INFO - Initializing Gemini model...
2025-04-21 10:01:19,712 - main - INFO - Initializing Gemini model...
2025-04-21 10:01:19,713 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 10:01:19,713 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 10:01:21,413 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you would like me to do now?

2025-04-21 10:01:21,413 - main - INFO - Gemini model initialized successfully
2025-04-21 10:01:46,214 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '93'}
2025-04-21 10:01:46,215 - main - INFO - Raw request body length: 93
2025-04-21 10:01:46,215 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:01:46,215 - main - INFO - Parsed JSON: {'message': 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', 'user_id': 3}
2025-04-21 10:01:46,215 - main - INFO - Extracted message: 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', user_id: 3
2025-04-21 10:01:46,235 - main - INFO - Found 3 relevant documents for query: Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh
2025-04-21 10:01:47,291 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', 'processing_time': '1.08 seconds'}
2025-04-21 10:01:54,010 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 10:01:54,011 - main - INFO - Raw request body length: 123
2025-04-21 10:01:54,011 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:01:54,011 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 10:01:54,012 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 10:01:54,027 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 10:01:56,976 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "“Ngoài dự kiến” là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4."\n\nThông tin được cung cấp tập trung vào phản ứng và tâm lý sau khi Mỹ hoãn áp thuế, chứ không nêu rõ cần *làm gì* tiếp theo.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '2.96 seconds'}
2025-04-21 10:03:40,152 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '49', 'connection': 'Keep-Alive'}
2025-04-21 10:03:40,153 - main - INFO - Raw request body length: 49
2025-04-21 10:03:40,153 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:03:40,153 - main - INFO - Parsed JSON: {'message': 'Kinh t? Vi?t Nam nam 2023'}
2025-04-21 10:03:40,153 - main - INFO - Extracted message: 'Kinh t? Vi?t Nam nam 2023', user_id: None
2025-04-21 10:03:40,184 - main - INFO - Found 3 relevant documents for query: Kinh t? Vi?t Nam nam 2023
2025-04-21 10:03:41,168 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Kinh t? Vi?t Nam nam 2023', 'processing_time': '1.01 seconds'}
2025-04-21 10:03:51,994 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '51'}
2025-04-21 10:03:51,994 - main - INFO - Raw request body length: 51
2025-04-21 10:03:51,995 - main - INFO - Used latin-1 encoding for request body
2025-04-21 10:03:51,995 - main - INFO - Parsed JSON: {'message': 'Vi?t Nam xu?t kh?u nh?ng gì'}
2025-04-21 10:03:51,995 - main - INFO - Extracted message: 'Vi?t Nam xu?t kh?u nh?ng gì', user_id: None
2025-04-21 10:03:52,021 - main - INFO - Found 3 relevant documents for query: Vi?t Nam xu?t kh?u nh?ng gì
2025-04-21 10:03:54,261 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Năm 2025, Việt Nam hướng tới mục tiêu xuất khẩu rau, quả đạt 8 tỷ USD." và "Hệ thống Thương vụ Việt Nam ở nước ngoài cũng tăng hoạt động, mở rộng để hỗ trợ doanh nghiệp kết nối giao thương, xúc tiến xuất khẩu."  Ngoài ra, dữ liệu cũng đề cập đến xuất khẩu thủy sản: "Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ trợ...duy trì chuỗi sản xuất – xuất khẩu...".\n', 'query': 'Vi?t Nam xu?t kh?u nh?ng gì', 'processing_time': '2.27 seconds'}
2025-04-21 10:07:41,192 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 10:07:41,198 - main - INFO - Initializing vector database...
2025-04-21 10:07:41,198 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 10:07:41,201 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 10:07:41,201 - main - INFO - Loading vector store...
2025-04-21 10:07:43,193 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 10:07:50,346 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 10:07:58,015 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 10:07:58,018 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 10:07:58,032 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 10:07:58,324 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-21 10:07:59,512 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-21 10:07:59,513 - main - INFO - Vector database retriever configured successfully
2025-04-21 10:07:59,513 - main - INFO - Testing retriever with a simple query
2025-04-21 10:07:59,539 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 10:07:59,539 - main - INFO - Initializing Gemini model...
2025-04-21 10:07:59,540 - main - INFO - Initializing Gemini model...
2025-04-21 10:07:59,540 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 10:07:59,541 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 10:08:01,130 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-21 10:08:01,132 - main - INFO - Gemini model initialized successfully
2025-04-21 10:08:10,424 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 10:08:10,425 - main - INFO - Raw request body length: 123
2025-04-21 10:08:10,425 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:08:10,425 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 10:08:10,425 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 10:08:10,440 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 10:08:13,928 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "“Ngoài dự kiến” là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4."\n\nBài báo cũng đề cập đến việc thay đổi cách thức sản xuất - kinh doanh theo hướng bài bản hơn trong ngành nông nghiệp, nhưng không nêu rõ là làm gì *sau* khi Mỹ hoãn áp thuế. Bài báo thứ hai tập trung vào phản ứng của thị trường chứng khoán với việc hoãn áp thuế, chứ không phải những hành động cụ thể cần thực hiện.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '3.50 seconds'}
2025-04-21 10:08:22,362 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '93'}
2025-04-21 10:08:22,363 - main - INFO - Raw request body length: 93
2025-04-21 10:08:22,363 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:08:22,364 - main - INFO - Parsed JSON: {'message': 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', 'user_id': 3}
2025-04-21 10:08:22,364 - main - INFO - Extracted message: 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', user_id: 3
2025-04-21 10:08:22,378 - main - INFO - Found 3 relevant documents for query: Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh
2025-04-21 10:08:23,340 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Sáng ngày 27/02/2025 tại TP. Hồ Chí Minh', 'processing_time': '0.98 seconds'}
2025-04-21 10:08:49,773 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '213'}
2025-04-21 10:08:49,774 - main - INFO - Raw request body length: 213
2025-04-21 10:08:49,774 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:08:49,774 - main - INFO - Parsed JSON: {'message': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'user_id': 3}
2025-04-21 10:08:49,775 - main - INFO - Extracted message: 'Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ', user_id: 3
2025-04-21 10:08:49,815 - main - INFO - Found 3 relevant documents for query: Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ
2025-04-21 10:08:50,116 - main - ERROR - Error generating content from model: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 2
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 9
}
]
2025-04-21 10:08:50,122 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 300, in process_chat
    response = gemini_model.generate_content(prompt)
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 2
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 9
}
]

2025-04-21 10:08:50,122 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đây là nỗ lực cụ thể nhằm hiện thực hóa tinh thần “hành chính phục vụ”, lấy người dân và doanh nghiệp làm trung tâm. Với sự hỗ trợ tận tình của cán bộ, công chức, viên chức trẻ cùng đoàn viên, TN, người dân không chỉ tiết kiệm thời gian, chi phí đi lại mà còn được hướng dẫn chi tiết, trực tiếp thực hiện các thủ tục hành chính trên môi trường số một cách dễ dàng và thuận tiện./.\n\nHà Lan\n\nVới những nỗ lực không ngừng nghỉ, ưu tiên hỗ trợ doanh nghiệp vượt qua khó khăn về nguồn vốn, nhân lực và mở rộng thị trường, tỉnh Quảng Ninh luôn được cộng đồng doanh nghiệp, nhà đầu tư đánh giá cao và vững tin đồng hành cùng tỉnh trong thực hiện các mục tiêu phát triển kinh tế - xã hội.\n\nPhát biểu tại một trong những phiên thảo luận cuối cùng của cuộc họp thường niên, Chủ tịch Ngân hàng Trung ương Châu Âu Christine Lagarde đã nhấn mạnh những tình huống khó khăn mà những cơn gió ngược này đặt ra. “Có tất cả những quả bóng này trong không khí. Chúng tôi không chắc chắn chính xác nơi nó sẽ rơi xuống” - bà nói./.', 'query': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'processing_time': '0.35 seconds'}
2025-04-21 10:13:08,286 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 10:13:08,291 - main - INFO - Initializing vector database...
2025-04-21 10:13:08,292 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 10:13:08,294 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 10:13:08,294 - main - INFO - Loading vector store...
2025-04-21 10:13:10,246 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 10:13:15,800 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 10:13:26,225 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 10:13:26,237 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 10:13:26,262 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 10:13:26,586 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-21 10:13:27,830 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-21 10:13:27,830 - main - INFO - Vector database retriever configured successfully
2025-04-21 10:13:27,830 - main - INFO - Testing retriever with a simple query
2025-04-21 10:13:27,869 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 10:13:27,869 - main - INFO - Initializing Gemini model...
2025-04-21 10:13:27,870 - main - INFO - Initializing Gemini model...
2025-04-21 10:13:27,871 - main - ERROR - GOOGLE_API_KEY environment variable not set
2025-04-21 10:13:27,871 - main - WARNING - Gemini model initialization returned None, continuing without model
2025-04-21 10:13:36,372 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 10:13:36,372 - main - INFO - Raw request body length: 123
2025-04-21 10:13:36,373 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:13:36,373 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 10:13:36,373 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 10:13:36,374 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-21 10:13:36,374 - main - INFO - Initializing Gemini model...
2025-04-21 10:13:36,374 - main - ERROR - GOOGLE_API_KEY environment variable not set
2025-04-21 10:13:36,388 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 10:13:36,388 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-21 10:13:36,389 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?\n\nURL: https://baomoi.com/lam-gi-sau-khi-my-hoan-ap-thue-doi-ung-90-ngay-c51948411.epi\n\nCONTENT:\n\nBối cảnh mới, tâm thế mới\n\n"Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vàoMỹngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.\n\nPhía sau kỷ lục ngành nông nghiệp là sự thay đổi cách thức sản xuất - kinh doanh theo hướng bài bản hơn. Ảnh: Trung Chánh\n\nTITLE: Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán\n\nURL: https://baomoi.com/hoan-ap-thue-90-ngay-thoi-diem-de-tai-co-cau-danh-muc-chung-khoan-c51960750.epi\n\nCONTENT:\n\nChiều ngày 9/4 (sáng sớm ngày 10/4 theo giờ Việt Nam), Tổng thống MỹDonald Trumpthông báo sẽ tạm hoãn thời gian áp dụng mức thuế quan mới với gần 60 đối tác thương mại trong vòng 90 ngày, nhằm thêm thời gian để các bên đàm phán. Thuế suất nhập khẩu và thuế chống bán phá giá đối các mặt hàng nhôm, thép và ô tô được giữ nguyên hiện trạng.\n\nThị trường chứng khoánthế giớilập tức phản ứng tích cực với thông tin trên, chỉ số Dow Jones và S&P500 của Mỹ đóng cửa với mức tăng lần lượt là 7,9% và 9,5%, đánh dấu phiên tăng điểm mạnh nhất kể từ thời điểm Covid-19. Trên thị trường chứng khoán Việt Nam, sắc tím cũng lan tỏa trên cả 3 sàn trong phiên giao dịch ngày 10/4.\n\nMỹ có động thái bất ngờ quyết định hoãn áp thuế đối ứng trong 90 ngày với hơn 75 đối tác thương mại. Quyết định này tạo nên một làn sóng trên toàn cầu, từ hoan nghênh thận trọng tới cảnh báo chiến lược trả đũa.', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '0.02 seconds'}
2025-04-21 10:14:00,628 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '213'}
2025-04-21 10:14:00,629 - main - INFO - Raw request body length: 213
2025-04-21 10:14:00,629 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:14:00,629 - main - INFO - Parsed JSON: {'message': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'user_id': 3}
2025-04-21 10:14:00,630 - main - INFO - Extracted message: 'Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ', user_id: 3
2025-04-21 10:14:00,630 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-21 10:14:00,630 - main - INFO - Initializing Gemini model...
2025-04-21 10:14:00,631 - main - ERROR - GOOGLE_API_KEY environment variable not set
2025-04-21 10:14:00,659 - main - INFO - Found 3 relevant documents for query: Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ
2025-04-21 10:14:00,659 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-21 10:14:00,660 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đây là nỗ lực cụ thể nhằm hiện thực hóa tinh thần “hành chính phục vụ”, lấy người dân và doanh nghiệp làm trung tâm. Với sự hỗ trợ tận tình của cán bộ, công chức, viên chức trẻ cùng đoàn viên, TN, người dân không chỉ tiết kiệm thời gian, chi phí đi lại mà còn được hướng dẫn chi tiết, trực tiếp thực hiện các thủ tục hành chính trên môi trường số một cách dễ dàng và thuận tiện./.\n\nHà Lan\n\nVới những nỗ lực không ngừng nghỉ, ưu tiên hỗ trợ doanh nghiệp vượt qua khó khăn về nguồn vốn, nhân lực và mở rộng thị trường, tỉnh Quảng Ninh luôn được cộng đồng doanh nghiệp, nhà đầu tư đánh giá cao và vững tin đồng hành cùng tỉnh trong thực hiện các mục tiêu phát triển kinh tế - xã hội.\n\nPhát biểu tại một trong những phiên thảo luận cuối cùng của cuộc họp thường niên, Chủ tịch Ngân hàng Trung ương Châu Âu Christine Lagarde đã nhấn mạnh những tình huống khó khăn mà những cơn gió ngược này đặt ra. “Có tất cả những quả bóng này trong không khí. Chúng tôi không chắc chắn chính xác nơi nó sẽ rơi xuống” - bà nói./.', 'query': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'processing_time': '0.03 seconds'}
2025-04-21 10:14:56,528 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '124'}
2025-04-21 10:14:56,529 - main - INFO - Raw request body length: 124
2025-04-21 10:14:56,529 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:14:56,530 - main - INFO - Parsed JSON: {'message': "Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này", 'user_id': 3}
2025-04-21 10:14:56,530 - main - INFO - Extracted message: 'Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này', user_id: 3
2025-04-21 10:14:56,530 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-21 10:14:56,530 - main - INFO - Initializing Gemini model...
2025-04-21 10:14:56,531 - main - ERROR - GOOGLE_API_KEY environment variable not set
2025-04-21 10:14:56,550 - main - INFO - Found 3 relevant documents for query: Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này
2025-04-21 10:14:56,551 - main - WARNING - Using fallback mode (no Gemini model)
2025-04-21 10:14:56,551 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Năm nay, giá vàng thế giới đã tăng hơn 16%.\n\n“Căng thẳng địa chính trị tăng lên và hy vọng rằng Fed sẽ giảm lãi suất mạnh tay hơn sẽ tạo ra điều kiện thuận lợi để vàng tăng giá. Sẽ đến lúc giá vàng thiết lập được kỷ lục mới, một khi biến động hiện nay trên thị trường lắng xuống”, trưởng phân tích Han Tan của công ty Exinity Group nhận định.\n\nTính trong 7 tháng năm 2024, tổng trị giá nhập khẩu của nhóm các doanh nghiệp này đạt 135,38 tỷ USD, tăng 17,3% (tương ứng tăng 19,95 tỷ USD) so với cùng kỳ năm trước, chiếm 63,6% tổng trị giá nhập khẩu của cả nước./.\n\nTrị giá nhập khẩu hàng hóa của các doanh nghiệp FDI trong kỳ này đạt 10,81 tỷ USD, tăng 15% (tương ứng tăng 1,41 tỷ USD) so với kỳ 2 tháng 6/2024.', 'query': "Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này", 'processing_time': '0.02 seconds'}
2025-04-21 10:16:35,875 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-21 10:16:35,880 - main - INFO - Initializing vector database...
2025-04-21 10:16:35,881 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-21 10:16:35,883 - main - INFO - Found vector store files at /app/vector_db
2025-04-21 10:16:35,883 - main - INFO - Loading vector store...
2025-04-21 10:16:37,817 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-21 10:16:43,012 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-21 10:16:49,887 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-21 10:16:49,892 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-21 10:16:49,908 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-21 10:16:50,239 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-21 10:16:51,622 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-21 10:16:51,623 - main - INFO - Vector database retriever configured successfully
2025-04-21 10:16:51,623 - main - INFO - Testing retriever with a simple query
2025-04-21 10:16:51,660 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-21 10:16:51,660 - main - INFO - Initializing Gemini model...
2025-04-21 10:16:51,660 - main - INFO - Initializing Gemini model...
2025-04-21 10:16:51,661 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-21 10:16:51,661 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-21 10:16:52,987 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-21 10:16:52,988 - main - INFO - Gemini model initialized successfully
2025-04-21 10:17:00,486 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '213'}
2025-04-21 10:17:00,487 - main - INFO - Raw request body length: 213
2025-04-21 10:17:00,488 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:17:00,488 - main - INFO - Parsed JSON: {'message': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'user_id': 3}
2025-04-21 10:17:00,488 - main - INFO - Extracted message: 'Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ', user_id: 3
2025-04-21 10:17:00,506 - main - INFO - Found 3 relevant documents for query: Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ
2025-04-21 10:17:01,431 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': "Những lần Hoa hậu Mai Phương Thúy nói vu vơ trở thành lời 'tiên tri' cổ phiếu chính xác không ngờ", 'processing_time': '0.94 seconds'}
2025-04-21 10:17:11,022 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-21 10:17:11,023 - main - INFO - Raw request body length: 123
2025-04-21 10:17:11,023 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:17:11,023 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-21 10:17:11,024 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-21 10:17:11,037 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-21 10:17:13,213 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '2.19 seconds'}
2025-04-21 10:17:36,528 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '219'}
2025-04-21 10:17:36,529 - main - INFO - Raw request body length: 219
2025-04-21 10:17:36,529 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:17:36,529 - main - INFO - Parsed JSON: {'message': 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', 'user_id': 3}
2025-04-21 10:17:36,529 - main - INFO - Extracted message: 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', user_id: 3
2025-04-21 10:17:36,564 - main - INFO - Found 3 relevant documents for query: Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025
2025-04-21 10:17:37,435 - main - INFO - Chat response: {'success': True, 'answer': 'Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', 'processing_time': '0.91 seconds'}
2025-04-21 10:17:52,774 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '219'}
2025-04-21 10:17:52,775 - main - INFO - Raw request body length: 219
2025-04-21 10:17:52,776 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:17:52,776 - main - INFO - Parsed JSON: {'message': 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', 'user_id': 3}
2025-04-21 10:17:52,776 - main - INFO - Extracted message: 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', user_id: 3
2025-04-21 10:17:52,792 - main - INFO - Found 3 relevant documents for query: Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025
2025-04-21 10:17:53,083 - main - ERROR - Error generating content from model: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 2
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]
2025-04-21 10:17:53,092 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 300, in process_chat
    response = gemini_model.generate_content(prompt)
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.ResourceExhausted: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. [violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerMinutePerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-1.5-pro"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 2
}
, links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, retry_delay {
  seconds: 6
}
]

2025-04-21 10:17:53,092 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Cũng theo báo cáo trên, các ngân hàng trung ương sẽ tiếp tục mua ròng vàng trong năm nay. Báo cáo dẫn số liệu mới nhất của Hội đồng Vàng Thế giới (WGC) cho thấy các ngân hàng trung ương mua ròng 290 tấn vàng trong quý 1/2024, quý mua nhiều thứ tư của nhóm này kể từ khi các ngân hàng trung ương bắt đầu đợt gom mua vàng này vào năm 2022.\n\nTừ ngày 6-9/3, Bình Định tổ chức Hội chợ Quốc tế phong cách hàng ngoài trời (Q-FAIR 2025) tại Quy Nhơn với hơn 1.200 gian hàng, tạo cơ hội kết nối cho doanh nghiệp trong và ngoài nước.\n\nPhạm Linh\n\nHoạt động của công ty chứng khoán nói trên không nói lên toàn bộ bức tranh kinh doanh của các ngân hàng đầu tư này ở Trung Quốc. Trong số 7 ngân hàng trên, một số cũng có các công ty khác hoạt động tại Trung Quốc. Tuy nhiên, các số liệu năm 2023 ngược lại hoàn toàn với năm 2021 – năm kỷ lục với các ngân hàng đầu tư, khi 6 trong số 7 ngân hàng trên ghi nhận lợi nhuận cao tại Trung Quốc đại lục.', 'query': 'Các ngân hàng được dự báo sẽ ghi nhận lợi nhuận trước thuế tăng trưởng mạnh trong quý I/2025', 'processing_time': '0.32 seconds'}
2025-04-21 10:18:22,143 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '200'}
2025-04-21 10:18:22,144 - main - INFO - Raw request body length: 200
2025-04-21 10:18:22,144 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:18:22,145 - main - INFO - Parsed JSON: {'message': 'rong bối cảnh kinh tế toàn cầu tiếp tục đối mặt với nhiều khó khăn, lạm phát kéo dài', 'user_id': 3}
2025-04-21 10:18:22,145 - main - INFO - Extracted message: 'rong bối cảnh kinh tế toàn cầu tiếp tục đối mặt với nhiều khó khăn, lạm phát kéo dài', user_id: 3
2025-04-21 10:18:22,165 - main - INFO - Found 3 relevant documents for query: rong bối cảnh kinh tế toàn cầu tiếp tục đối mặt với nhiều khó khăn, lạm phát kéo dài
2025-04-21 10:18:24,450 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tổng kim ngạch xuất khẩu, nhập khẩu hàng hóa tháng 1 đều giảm so với cùng kỳ năm trước. Xuất khẩu sang các thị trường chủ lực giảm mạnh: Mỹ (giảm 24,5%), EU (giảm 32,7%), Hàn Quốc (giảm 14,9%), ASEAN (giảm 13,4%)… Đây là mức giảm khá lớn khi so các tháng Tết cùng kỳ giai đoạn 2018-2022. Thị trường bất động sản tiếp tục đối mặt với nhiều khó khăn, nhất là về thanh khoản, ảnh hưởng trực tiếp và tác động dây chuyền đến nhiều ngành, lĩnh vực của nền kinh tế."\n', 'query': 'rong bối cảnh kinh tế toàn cầu tiếp tục đối mặt với nhiều khó khăn, lạm phát kéo dài', 'processing_time': '2.30 seconds'}
2025-04-21 10:19:35,075 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '48'}
2025-04-21 10:19:35,076 - main - INFO - Raw request body length: 48
2025-04-21 10:19:35,076 - main - INFO - Used utf-8 encoding for request body
2025-04-21 10:19:35,077 - main - INFO - Parsed JSON: {'message': 'link bài báo', 'user_id': 3}
2025-04-21 10:19:35,077 - main - INFO - Extracted message: 'link bài báo', user_id: 3
2025-04-21 10:19:35,092 - main - INFO - Found 3 relevant documents for query: link bài báo
2025-04-21 10:19:36,274 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Minh Phương/BáoTin tức". Tôi không tìm thấy thông tin liên quan đến link bài báo trong cơ sở dữ liệu.\n', 'query': 'link bài báo', 'processing_time': '1.20 seconds'}
2025-04-22 01:46:23,702 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 01:46:23,710 - main - INFO - Initializing vector database...
2025-04-22 01:46:23,710 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 01:46:23,712 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 01:46:23,712 - main - INFO - Loading vector store...
2025-04-22 01:46:24,907 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 01:46:30,026 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 01:46:40,257 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 01:46:40,284 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 01:46:40,611 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 01:46:43,925 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 01:46:45,942 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 01:46:45,945 - main - INFO - Vector database retriever configured successfully
2025-04-22 01:46:45,945 - main - INFO - Testing retriever with a simple query
2025-04-22 01:46:45,976 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 01:46:45,976 - main - INFO - Initializing Gemini model...
2025-04-22 01:46:45,977 - main - INFO - Initializing Gemini model...
2025-04-22 01:46:45,977 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 01:46:45,977 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 01:46:48,650 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you'd like me to do now?

2025-04-22 01:46:48,651 - main - INFO - Gemini model initialized successfully
2025-04-22 06:17:27,026 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:17:27,032 - main - INFO - Initializing vector database...
2025-04-22 06:17:27,033 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:17:27,035 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:17:27,035 - main - INFO - Loading vector store...
2025-04-22 06:17:29,414 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:17:36,109 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:17:44,440 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:17:44,444 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:17:44,472 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:17:44,993 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:17:46,958 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:17:46,959 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:17:46,960 - main - INFO - Testing retriever with a simple query
2025-04-22 06:17:47,007 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:17:47,007 - main - INFO - Initializing Gemini model...
2025-04-22 06:17:47,008 - main - INFO - Initializing Gemini model...
2025-04-22 06:17:47,008 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 06:17:47,009 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 06:17:49,659 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond. Is there anything specific you would like me to do?

2025-04-22 06:17:49,659 - main - INFO - Gemini model initialized successfully
2025-04-22 06:19:00,783 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:19:00,790 - main - INFO - Initializing vector database...
2025-04-22 06:19:00,790 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:19:00,792 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:19:00,792 - main - INFO - Loading vector store...
2025-04-22 06:19:03,132 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:19:09,087 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:19:17,120 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:19:17,129 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:19:17,168 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:19:17,505 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:19:18,840 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:19:18,840 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:19:18,840 - main - INFO - Testing retriever with a simple query
2025-04-22 06:19:18,917 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:19:18,917 - main - INFO - Initializing Gemini model...
2025-04-22 06:19:18,917 - main - INFO - Initializing Gemini model...
2025-04-22 06:19:18,918 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 06:19:18,918 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 06:19:21,052 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-22 06:19:21,053 - main - INFO - Gemini model initialized successfully
2025-04-22 06:21:59,698 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:21:59,703 - main - INFO - Initializing vector database...
2025-04-22 06:21:59,703 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:21:59,706 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:21:59,706 - main - INFO - Loading vector store...
2025-04-22 06:22:01,700 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:22:07,418 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:22:16,172 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:22:16,175 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:22:16,190 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:22:16,471 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:22:17,678 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:22:17,679 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:22:17,679 - main - INFO - Testing retriever with a simple query
2025-04-22 06:22:17,711 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:22:17,711 - main - INFO - Initializing Gemini model...
2025-04-22 06:22:17,712 - main - INFO - Initializing Gemini model...
2025-04-22 06:22:17,712 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 06:22:17,712 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 06:22:19,087 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you?

2025-04-22 06:22:19,087 - main - INFO - Gemini model initialized successfully
2025-04-22 06:25:10,906 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:25:10,912 - main - INFO - Initializing vector database...
2025-04-22 06:25:10,912 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:25:10,914 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:25:10,915 - main - INFO - Loading vector store...
2025-04-22 06:25:13,032 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:25:18,765 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:25:28,969 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:25:28,976 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:25:28,992 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:25:29,303 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:25:30,564 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:25:30,565 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:25:30,565 - main - INFO - Testing retriever with a simple query
2025-04-22 06:25:30,598 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:25:30,599 - main - INFO - Initializing OpenAI model...
2025-04-22 06:25:30,599 - main - INFO - Initializing OpenAI model...
2025-04-22 06:25:30,599 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:25:30,600 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:25:30,603 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 263, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:25:30,604 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:27:22,840 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:27:22,846 - main - INFO - Initializing vector database...
2025-04-22 06:27:22,846 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:27:22,849 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:27:22,849 - main - INFO - Loading vector store...
2025-04-22 06:27:23,914 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:27:28,053 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:27:28,055 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:27:28,067 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:27:28,387 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:27:29,644 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:27:29,645 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:27:29,645 - main - INFO - Testing retriever with a simple query
2025-04-22 06:27:29,671 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:27:29,671 - main - INFO - Initializing OpenAI model...
2025-04-22 06:27:29,672 - main - INFO - Initializing OpenAI model...
2025-04-22 06:27:29,672 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:27:29,673 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:27:29,674 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 264, in initialize_openai
    client = OpenAI(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:27:29,674 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:29:33,700 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:29:33,712 - main - INFO - Initializing vector database...
2025-04-22 06:29:33,712 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:29:33,714 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:29:33,714 - main - INFO - Loading vector store...
2025-04-22 06:29:35,790 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:29:40,204 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:29:40,207 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:29:40,222 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:29:40,522 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:29:41,843 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:29:41,843 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:29:41,844 - main - INFO - Testing retriever with a simple query
2025-04-22 06:29:41,889 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:29:41,890 - main - INFO - Initializing OpenAI model...
2025-04-22 06:29:41,890 - main - INFO - Initializing OpenAI model...
2025-04-22 06:29:41,891 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:29:43,549 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-04-22 06:29:43,561 - main - INFO - OpenAI model test response: I'm here and ready to
2025-04-22 06:29:43,561 - main - INFO - OpenAI model initialized successfully
2025-04-22 06:30:59,812 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:30:59,819 - main - INFO - Initializing vector database...
2025-04-22 06:30:59,819 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:30:59,821 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:30:59,821 - main - INFO - Loading vector store...
2025-04-22 06:31:00,857 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:31:07,439 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:31:15,491 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:31:15,493 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:31:15,506 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:31:15,830 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:31:17,158 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:31:17,159 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:31:17,159 - main - INFO - Testing retriever with a simple query
2025-04-22 06:31:17,186 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:31:17,186 - main - INFO - Initializing OpenAI model...
2025-04-22 06:31:17,187 - main - INFO - Initializing OpenAI model...
2025-04-22 06:31:17,187 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:31:17,188 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:31:17,189 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 263, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:31:17,190 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:33:13,553 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:33:13,560 - main - INFO - Initializing vector database...
2025-04-22 06:33:13,560 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:33:13,562 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:33:13,562 - main - INFO - Loading vector store...
2025-04-22 06:33:14,653 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:33:19,804 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:33:27,731 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:33:27,734 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:33:27,746 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:33:28,154 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:33:29,474 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:33:29,474 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:33:29,474 - main - INFO - Testing retriever with a simple query
2025-04-22 06:33:29,499 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:33:29,500 - main - INFO - Initializing OpenAI model...
2025-04-22 06:33:29,500 - main - INFO - Initializing OpenAI model...
2025-04-22 06:33:29,501 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:33:29,501 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:33:29,502 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 263, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:33:29,503 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:34:42,270 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '40', 'expect': '100-continue', 'connection': 'Keep-Alive'}
2025-04-22 06:34:42,273 - main - INFO - Raw request body length: 40
2025-04-22 06:34:42,273 - main - INFO - Used utf-8 encoding for request body
2025-04-22 06:34:42,273 - main - INFO - Parsed JSON: {'message': 'Kinh t? Vi?t Nam'}
2025-04-22 06:34:42,274 - main - INFO - Extracted message: 'Kinh t? Vi?t Nam', user_id: None
2025-04-22 06:34:42,274 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-22 06:34:42,275 - main - INFO - Initializing OpenAI model...
2025-04-22 06:34:42,275 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:34:42,275 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:34:42,276 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 263, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:34:42,294 - main - INFO - Found 3 relevant documents for query: Kinh t? Vi?t Nam
2025-04-22 06:34:42,295 - main - WARNING - Using fallback mode (no openai model available)
2025-04-22 06:34:42,295 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Các nước phát triển kinh tế tư nhân như thế nào\n\nURL: https://vnexpress.net/cac-nuoc-phat-trien-kinh-te-tu-nhan-nhu-the-nao-4866682.html\n\nPUBLICATION DATE: 2025-04-01 10:00:00\n\nCONTENT:\n\nTrong bài viếtPhát triển kinh tế tư nhân - đòn bẩy cho một Việt Nam thịnh vượng,Tổng Bí thư Tô Lâm đánh giá những thành công trên chặng đường gần 40 năm Đổi mới có sự đóng góp rất lớn của khu vực kinh tế tư nhân, và khu vực này là động lực quan trọng nhất thúc đẩy tăng trưởng kinh tế.\n\nViệt Nam đặt mục tiêu có 2 triệu doanh nghiệp vào năm 2030. Hiện khu vực kinh tế tư nhân có hơn 6,1 triệu cơ sở kinh doanh, gồm khoảng 940.000 doanh nghiệp và trên 5,2 triệu hộ kinh doanh.\n\nVì vậy đã không để xảy ra bất kỳ vụ việc can nhiễu nào gây ảnh hưởng đến hoạt động của các hệ thống thông tin vô tuyến ở các tần số phục vụ công tác phòng, chống thiên tai và tìm kiếm cứu nạn, thông tin liên lạc, truyền thông, Cục Tần số vô tuyến điện cho hay.\n\nHoạt động phát thanh, truyền hình; lập trình máy vi tính, dịch vụ tư vấn và các hoạt động khác liên quan đến máy vi tính; hoạt động dịch vụ thông tin.\n\nHoạt động dịch vụ hỗ trợ khai khoáng.\n\nDanh mục ngành kinh tế nêu tại khoản 1 và khoản 2 nêu trên được xác định theo Quyết định số 27/2018/QĐ-TTg ngày 06/7/2018 của Thủ tướng Chính phủ về ban hành hệ thống ngành kinh tế Việt Nam.', 'query': 'Kinh t? Vi?t Nam', 'processing_time': '0.02 seconds', 'model': 'fallback'}
2025-04-22 06:35:15,851 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '40', 'expect': '100-continue'}
2025-04-22 06:35:15,852 - main - INFO - Raw request body length: 40
2025-04-22 06:35:15,852 - main - INFO - Used utf-8 encoding for request body
2025-04-22 06:35:15,853 - main - INFO - Parsed JSON: {'message': 'Kinh t? Vi?t Nam'}
2025-04-22 06:35:15,853 - main - INFO - Extracted message: 'Kinh t? Vi?t Nam', user_id: None
2025-04-22 06:35:15,853 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-22 06:35:15,853 - main - INFO - Initializing OpenAI model...
2025-04-22 06:35:15,854 - main - INFO - Using API key: sk-...R8A (middle part hidden)
2025-04-22 06:35:15,854 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:35:15,854 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 263, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:35:15,869 - main - INFO - Found 3 relevant documents for query: Kinh t? Vi?t Nam
2025-04-22 06:35:15,869 - main - WARNING - Using fallback mode (no openai model available)
2025-04-22 06:35:15,870 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Các nước phát triển kinh tế tư nhân như thế nào\n\nURL: https://vnexpress.net/cac-nuoc-phat-trien-kinh-te-tu-nhan-nhu-the-nao-4866682.html\n\nPUBLICATION DATE: 2025-04-01 10:00:00\n\nCONTENT:\n\nTrong bài viếtPhát triển kinh tế tư nhân - đòn bẩy cho một Việt Nam thịnh vượng,Tổng Bí thư Tô Lâm đánh giá những thành công trên chặng đường gần 40 năm Đổi mới có sự đóng góp rất lớn của khu vực kinh tế tư nhân, và khu vực này là động lực quan trọng nhất thúc đẩy tăng trưởng kinh tế.\n\nViệt Nam đặt mục tiêu có 2 triệu doanh nghiệp vào năm 2030. Hiện khu vực kinh tế tư nhân có hơn 6,1 triệu cơ sở kinh doanh, gồm khoảng 940.000 doanh nghiệp và trên 5,2 triệu hộ kinh doanh.\n\nVì vậy đã không để xảy ra bất kỳ vụ việc can nhiễu nào gây ảnh hưởng đến hoạt động của các hệ thống thông tin vô tuyến ở các tần số phục vụ công tác phòng, chống thiên tai và tìm kiếm cứu nạn, thông tin liên lạc, truyền thông, Cục Tần số vô tuyến điện cho hay.\n\nHoạt động phát thanh, truyền hình; lập trình máy vi tính, dịch vụ tư vấn và các hoạt động khác liên quan đến máy vi tính; hoạt động dịch vụ thông tin.\n\nHoạt động dịch vụ hỗ trợ khai khoáng.\n\nDanh mục ngành kinh tế nêu tại khoản 1 và khoản 2 nêu trên được xác định theo Quyết định số 27/2018/QĐ-TTg ngày 06/7/2018 của Thủ tướng Chính phủ về ban hành hệ thống ngành kinh tế Việt Nam.', 'query': 'Kinh t? Vi?t Nam', 'processing_time': '0.02 seconds', 'model': 'fallback'}
2025-04-22 06:42:26,947 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:42:26,953 - main - INFO - Initializing vector database...
2025-04-22 06:42:26,954 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:42:26,956 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:42:26,956 - main - INFO - Loading vector store...
2025-04-22 06:42:29,319 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:42:36,517 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:42:44,006 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:42:44,011 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:42:44,027 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:42:44,348 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:42:45,658 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:42:45,658 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:42:45,659 - main - INFO - Testing retriever with a simple query
2025-04-22 06:42:45,701 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:42:45,702 - main - INFO - Initializing OpenAI model...
2025-04-22 06:42:45,702 - main - INFO - Initializing OpenAI model...
2025-04-22 06:42:45,702 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-22 06:42:45,703 - main - INFO - Creating OpenAI client...
2025-04-22 06:42:45,703 - main - ERROR - Error initializing OpenAI model: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:42:45,705 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 264, in initialize_openai
    client = OpenAI(api_key=api_key)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:42:45,706 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:45:07,874 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:45:07,880 - main - INFO - Initializing vector database...
2025-04-22 06:45:07,881 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:45:07,883 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:45:07,883 - main - INFO - Loading vector store...
2025-04-22 06:45:09,898 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:45:15,999 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:45:24,648 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:45:24,651 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:45:24,667 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:45:25,065 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:45:26,509 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:45:26,510 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:45:26,510 - main - INFO - Testing retriever with a simple query
2025-04-22 06:45:26,549 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:45:26,550 - main - INFO - Initializing OpenAI model...
2025-04-22 06:45:26,550 - main - INFO - Initializing OpenAI model...
2025-04-22 06:45:26,551 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-22 06:45:26,551 - main - INFO - Creating OpenAI client...
2025-04-22 06:45:26,552 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:45:26,552 - main - INFO - Trying legacy OpenAI initialization
2025-04-22 06:45:26,553 - main - INFO - OpenAI client initialized with legacy method
2025-04-22 06:45:26,553 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-22 06:45:26,554 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:45:26,557 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 286, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:45:26,557 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:48:01,429 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:48:01,437 - main - INFO - Initializing vector database...
2025-04-22 06:48:01,437 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:48:01,439 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:48:01,439 - main - INFO - Loading vector store...
2025-04-22 06:48:03,537 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:48:09,708 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:48:19,120 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:48:19,124 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:48:19,146 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:48:19,479 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:48:20,776 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:48:20,777 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:48:20,777 - main - INFO - Testing retriever with a simple query
2025-04-22 06:48:20,924 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:48:20,925 - main - INFO - Initializing Gemini model...
2025-04-22 06:48:20,925 - main - INFO - Initializing Gemini model...
2025-04-22 06:48:20,926 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 06:48:20,926 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 06:48:23,200 - main - INFO - Gemini model test response: The connection appears to be working.  I have received your message and am able to respond.  Is there anything specific you would like me to do now?

2025-04-22 06:48:23,201 - main - INFO - Gemini model initialized successfully
2025-04-22 06:49:20,545 - main - INFO - Request headers: {'content-type': 'application/json', 'user-agent': 'Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.22621.4391', 'host': 'localhost:55050', 'content-length': '60'}
2025-04-22 06:49:20,546 - main - INFO - Raw request body length: 60
2025-04-22 06:49:20,547 - main - INFO - Used utf-8 encoding for request body
2025-04-22 06:49:20,547 - main - INFO - Parsed JSON: {'user_id': 1, 'message': 'Kinh t? Vi?t Nam'}
2025-04-22 06:49:20,547 - main - INFO - Extracted message: 'Kinh t? Vi?t Nam', user_id: 1
2025-04-22 06:49:20,565 - main - INFO - Found 3 relevant documents for query: Kinh t? Vi?t Nam
2025-04-22 06:49:22,820 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-22 06:49:22,820 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Trong bài viết Phát triển kinh tế tư nhân - đòn bẩy cho một Việt Nam thịnh vượng, Tổng Bí thư Tô Lâm đánh giá những thành công trên chặng đường gần 40 năm Đổi mới có sự đóng góp rất lớn của khu vực kinh tế tư nhân, và khu vực này là động lực quan trọng nhất thúc đẩy tăng trưởng kinh tế.\n\nViệt Nam đặt mục tiêu có 2 triệu doanh nghiệp vào năm 2030. Hiện khu vực kinh tế tư nhân có hơn 6,1 triệu cơ sở kinh doanh, gồm khoảng 940.000 doanh nghiệp và trên 5,2 triệu hộ kinh doanh."\n', 'query': 'Kinh t? Vi?t Nam', 'processing_time': '2.27 seconds', 'model': 'gemini-1.5-pro'}
2025-04-22 06:51:07,211 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:51:07,218 - main - INFO - Initializing vector database...
2025-04-22 06:51:07,218 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:51:07,219 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:51:07,219 - main - INFO - Loading vector store...
2025-04-22 06:51:09,266 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:51:16,725 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:51:25,029 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:51:25,045 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:51:25,065 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:51:25,424 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:51:26,724 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:51:26,725 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:51:26,726 - main - INFO - Testing retriever with a simple query
2025-04-22 06:51:26,766 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:51:26,766 - main - INFO - Initializing OpenAI model...
2025-04-22 06:51:26,767 - main - INFO - Initializing OpenAI model...
2025-04-22 06:51:26,767 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-22 06:51:26,768 - main - INFO - Creating OpenAI client...
2025-04-22 06:51:26,768 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:51:26,769 - main - INFO - Trying legacy OpenAI initialization
2025-04-22 06:51:26,769 - main - INFO - OpenAI client initialized with legacy method
2025-04-22 06:51:26,769 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-22 06:51:26,769 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:51:26,772 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 286, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:51:26,773 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:56:44,722 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:56:44,729 - main - INFO - Initializing vector database...
2025-04-22 06:56:44,730 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:56:44,732 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:56:44,732 - main - INFO - Loading vector store...
2025-04-22 06:56:46,840 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:56:52,428 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 06:57:01,395 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:57:01,411 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:57:01,436 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:57:01,835 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:57:03,354 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:57:03,354 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:57:03,355 - main - INFO - Testing retriever with a simple query
2025-04-22 06:57:03,391 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:57:03,391 - main - INFO - Initializing OpenAI model...
2025-04-22 06:57:03,392 - main - INFO - Initializing OpenAI model...
2025-04-22 06:57:03,392 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-22 06:57:03,392 - main - INFO - Creating OpenAI client...
2025-04-22 06:57:03,393 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:57:03,393 - main - INFO - Trying alternative initialization method
2025-04-22 06:57:03,393 - main - INFO - OpenAI client initialized with alternative method
2025-04-22 06:57:03,394 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-22 06:57:03,394 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:57:03,398 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 285, in initialize_openai
    if hasattr(client, 'chat') and callable(getattr(client.chat, 'completions', {}).get('create', None)):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:57:03,398 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 06:58:19,145 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 06:58:19,151 - main - INFO - Initializing vector database...
2025-04-22 06:58:19,152 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 06:58:19,154 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 06:58:19,154 - main - INFO - Loading vector store...
2025-04-22 06:58:21,186 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 06:58:25,856 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 06:58:25,860 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 06:58:25,873 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 06:58:26,196 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 06:58:27,477 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 06:58:27,477 - main - INFO - Vector database retriever configured successfully
2025-04-22 06:58:27,477 - main - INFO - Testing retriever with a simple query
2025-04-22 06:58:27,507 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 06:58:27,508 - main - INFO - Initializing OpenAI model...
2025-04-22 06:58:27,509 - main - INFO - Initializing OpenAI model...
2025-04-22 06:58:27,509 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-22 06:58:27,509 - main - INFO - Creating OpenAI client...
2025-04-22 06:58:27,510 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:58:27,510 - main - INFO - Trying alternative initialization method
2025-04-22 06:58:27,511 - main - INFO - OpenAI client initialized with alternative method
2025-04-22 06:58:27,511 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-22 06:58:27,512 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-22 06:58:27,515 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 285, in initialize_openai
    if hasattr(client, 'chat') and callable(getattr(client.chat, 'completions', {}).get('create', None)):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 25, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 61, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 312, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 107, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 760, in __init__
    self._client = http_client or httpx.Client(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-22 06:58:27,515 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-22 07:37:47,033 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 07:37:47,039 - main - INFO - Initializing vector database...
2025-04-22 07:37:47,040 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 07:37:47,042 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 07:37:47,042 - main - INFO - Loading vector store...
2025-04-22 07:37:49,136 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 07:37:55,677 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 07:38:03,243 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 07:38:03,247 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 07:38:03,261 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 07:38:03,556 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 07:38:04,728 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 07:38:04,728 - main - INFO - Vector database retriever configured successfully
2025-04-22 07:38:04,728 - main - INFO - Testing retriever with a simple query
2025-04-22 07:38:04,759 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 07:38:04,759 - main - INFO - Initializing Gemini model...
2025-04-22 07:38:04,760 - main - INFO - Initializing Gemini model...
2025-04-22 07:38:04,760 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 07:38:04,761 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 07:38:07,337 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you would like me to do?

2025-04-22 07:38:07,337 - main - INFO - Gemini model initialized successfully
2025-04-22 08:38:34,462 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 08:38:34,468 - main - INFO - Initializing vector database...
2025-04-22 08:38:34,469 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 08:38:34,471 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 08:38:34,471 - main - INFO - Loading vector store...
2025-04-22 08:38:36,770 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 08:38:42,524 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 08:38:50,623 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 08:38:50,633 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 08:38:50,664 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 08:38:51,071 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 08:38:52,441 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 08:38:52,442 - main - INFO - Vector database retriever configured successfully
2025-04-22 08:38:52,442 - main - INFO - Testing retriever with a simple query
2025-04-22 08:38:52,534 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 08:38:52,534 - main - INFO - Initializing Gemini model...
2025-04-22 08:38:52,535 - main - INFO - Initializing Gemini model...
2025-04-22 08:38:52,535 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 08:38:52,536 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-22 08:38:53,564 - main - INFO - Gemini model test response: Connection successful! How can I help you today?

2025-04-22 08:38:53,566 - main - INFO - Gemini model initialized successfully
2025-04-22 08:39:23,081 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-22 08:39:23,082 - main - INFO - Raw request body length: 123
2025-04-22 08:39:23,082 - main - INFO - Used utf-8 encoding for request body
2025-04-22 08:39:23,082 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-22 08:39:23,083 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-22 08:39:23,109 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-22 08:39:24,319 - main - INFO - Received response from Gemini API (gemini-2.0-flash)
2025-04-22 08:39:24,320 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Ngoài dự kiến\' là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vàoMỹngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4."\n"Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán".\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '1.24 seconds', 'model': 'gemini-2.0-flash'}
2025-04-22 09:33:32,749 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 09:33:32,756 - main - INFO - Initializing vector database...
2025-04-22 09:33:32,756 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 09:33:32,759 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 09:33:32,760 - main - INFO - Loading vector store...
2025-04-22 09:33:36,434 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 09:33:43,974 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 09:33:53,390 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 09:33:53,394 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 09:33:53,413 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 09:33:54,508 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 09:33:56,628 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 09:33:56,628 - main - INFO - Vector database retriever configured successfully
2025-04-22 09:33:56,629 - main - INFO - Testing retriever with a simple query
2025-04-22 09:33:56,668 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 09:33:56,669 - main - INFO - Initializing Gemini model...
2025-04-22 09:33:56,669 - main - INFO - Initializing Gemini model...
2025-04-22 09:33:56,670 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 09:33:56,670 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-22 09:33:58,814 - main - INFO - Gemini model test response: Connection test successful. I am able to receive and respond to your messages. How can I help you?

2025-04-22 09:33:58,816 - main - INFO - Gemini model initialized successfully
2025-04-22 09:38:00,500 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 09:38:00,507 - main - INFO - Initializing vector database...
2025-04-22 09:38:00,507 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 09:38:00,510 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 09:38:00,510 - main - INFO - Loading vector store...
2025-04-22 09:38:05,361 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 09:38:12,372 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 09:38:21,212 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 09:38:21,218 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 09:38:21,244 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 09:38:21,599 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 09:38:22,750 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 09:38:22,750 - main - INFO - Vector database retriever configured successfully
2025-04-22 09:38:22,750 - main - INFO - Testing retriever with a simple query
2025-04-22 09:38:22,778 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 09:38:22,779 - main - INFO - Initializing Gemini model...
2025-04-22 09:38:22,779 - main - INFO - Initializing Gemini model...
2025-04-22 09:38:22,779 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 09:38:22,780 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 09:38:24,145 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-22 09:38:24,146 - main - INFO - Gemini model initialized successfully
2025-04-22 09:39:51,425 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-22 09:39:51,426 - main - INFO - Raw request body length: 123
2025-04-22 09:39:51,426 - main - INFO - Used utf-8 encoding for request body
2025-04-22 09:39:51,427 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-22 09:39:51,427 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-22 09:39:51,465 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-22 09:39:54,668 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-22 09:39:54,670 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.  Chiều ngày 9/4 (sáng sớm ngày 10/4 theo giờ Việt Nam), Tổng thống Mỹ Donald Trump thông báo sẽ tạm hoãn thời gian áp dụng mức thuế quan mới với gần 60 đối tác thương mại trong vòng 90 ngày, nhằm thêm thời gian để các bên đàm phán.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '3.24 seconds', 'model': 'gemini-1.5-pro'}
2025-04-22 10:15:42,234 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-22 10:15:42,240 - main - INFO - Initializing vector database...
2025-04-22 10:15:42,240 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-22 10:15:42,243 - main - INFO - Found vector store files at /app/vector_db
2025-04-22 10:15:42,243 - main - INFO - Loading vector store...
2025-04-22 10:15:45,788 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-22 10:15:53,781 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-22 10:16:03,002 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-22 10:16:03,027 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-22 10:16:03,100 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-22 10:16:03,581 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-22 10:16:05,622 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-22 10:16:05,623 - main - INFO - Vector database retriever configured successfully
2025-04-22 10:16:05,623 - main - INFO - Testing retriever with a simple query
2025-04-22 10:16:05,653 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-22 10:16:05,654 - main - INFO - Initializing Gemini model...
2025-04-22 10:16:05,654 - main - INFO - Initializing Gemini model...
2025-04-22 10:16:05,654 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-22 10:16:05,655 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-22 10:16:07,903 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-22 10:16:07,904 - main - INFO - Gemini model initialized successfully
2025-04-25 07:46:29,553 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 07:46:29,566 - main - INFO - Initializing vector database...
2025-04-25 07:46:29,566 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 07:46:29,568 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 07:46:29,569 - main - INFO - Loading vector store...
2025-04-25 07:46:32,875 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 07:46:39,790 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 07:46:49,157 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 07:46:49,163 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 07:46:49,204 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 07:46:50,242 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 07:46:53,081 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 07:46:53,082 - main - INFO - Vector database retriever configured successfully
2025-04-25 07:46:53,082 - main - INFO - Testing retriever with a simple query
2025-04-25 07:46:53,181 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 07:46:53,182 - main - INFO - Initializing Gemini model...
2025-04-25 07:46:53,182 - main - INFO - Initializing Gemini model...
2025-04-25 07:46:53,183 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 07:46:53,183 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 07:46:55,021 - main - INFO - Gemini model test response: Connection test successful! I am here and ready to respond. How can I help you?

2025-04-25 07:46:55,022 - main - INFO - Gemini model initialized successfully
2025-04-25 08:00:40,372 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:00:40,384 - main - INFO - Initializing vector database...
2025-04-25 08:00:40,384 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:00:40,386 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:00:40,387 - main - INFO - Loading vector store...
2025-04-25 08:00:43,267 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:00:50,714 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:00:59,458 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 08:00:59,463 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 08:00:59,486 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 08:01:00,017 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 08:01:02,050 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 08:01:02,051 - main - INFO - Vector database retriever configured successfully
2025-04-25 08:01:02,051 - main - INFO - Testing retriever with a simple query
2025-04-25 08:01:02,092 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 08:01:02,092 - main - INFO - Initializing OpenAI model...
2025-04-25 08:01:02,093 - main - INFO - Initializing OpenAI model...
2025-04-25 08:01:02,093 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-25 08:01:02,094 - main - INFO - Creating OpenAI client...
2025-04-25 08:01:02,094 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:01:02,095 - main - INFO - Trying alternative initialization method
2025-04-25 08:01:02,095 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:01:02,096 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:01:02,097 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:01:02,101 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 300, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:01:02,101 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 08:12:38,918 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:12:38,929 - main - INFO - Initializing vector database...
2025-04-25 08:12:38,930 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:12:38,933 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:12:38,934 - main - INFO - Loading vector store...
2025-04-25 08:12:41,858 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:12:49,358 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:13:06,494 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:13:06,505 - main - INFO - Initializing vector database...
2025-04-25 08:13:06,506 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:13:06,509 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:13:06,509 - main - INFO - Loading vector store...
2025-04-25 08:13:08,513 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:13:14,620 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:13:23,019 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 08:13:23,035 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 08:13:23,060 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 08:13:23,651 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 08:13:25,745 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 08:13:25,745 - main - INFO - Vector database retriever configured successfully
2025-04-25 08:13:25,746 - main - INFO - Testing retriever with a simple query
2025-04-25 08:13:25,839 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 08:13:25,839 - main - INFO - Initializing Gemini model...
2025-04-25 08:13:25,840 - main - INFO - Initializing Gemini model...
2025-04-25 08:13:25,840 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:13:25,841 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:13:27,742 - main - INFO - Gemini model test response: Connection successful. I am online and ready to respond. How can I help you?

2025-04-25 08:13:27,743 - main - INFO - Gemini model initialized successfully
2025-04-25 08:15:07,814 - main - INFO - Reloading configuration settings...
2025-04-25 08:15:07,854 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:15:07,854 - main - INFO - Initializing Gemini model...
2025-04-25 08:15:07,855 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:15:07,855 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:15:09,521 - main - INFO - Gemini model test response: Connection successful! How can I help you today?

2025-04-25 08:15:09,522 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:15:09,523 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:15:17,167 - main - INFO - Reloading configuration settings...
2025-04-25 08:15:17,191 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:15:17,191 - main - INFO - Initializing Gemini model...
2025-04-25 08:15:17,192 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:15:17,192 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:15:18,126 - main - INFO - Gemini model test response: Connection test successful. I am here and ready to respond. How can I help you?

2025-04-25 08:15:18,127 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:15:18,127 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:15:37,817 - main - INFO - Reloading configuration settings...
2025-04-25 08:15:37,842 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:15:37,842 - main - INFO - Initializing Gemini model...
2025-04-25 08:15:37,843 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:15:37,843 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:15:39,540 - main - INFO - Gemini model test response: Connection successful. I am able to communicate and respond to your prompts. How can I help you today?

2025-04-25 08:15:39,540 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:15:39,541 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:22:53,374 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:22:53,386 - main - INFO - Initializing vector database...
2025-04-25 08:22:53,386 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:22:53,388 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:22:53,389 - main - INFO - Loading vector store...
2025-04-25 08:22:56,286 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:23:02,940 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:23:11,935 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 08:23:11,941 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 08:23:11,972 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 08:23:12,550 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 08:23:14,526 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 08:23:14,527 - main - INFO - Vector database retriever configured successfully
2025-04-25 08:23:14,527 - main - INFO - Testing retriever with a simple query
2025-04-25 08:23:14,591 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 08:23:14,592 - main - INFO - Initializing Gemini model...
2025-04-25 08:23:14,592 - main - INFO - Initializing Gemini model...
2025-04-25 08:23:14,593 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:23:14,593 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:23:16,713 - main - INFO - Gemini model test response: I am online and ready to respond. How can I help you?

2025-04-25 08:23:16,713 - main - INFO - Gemini model initialized successfully
2025-04-25 08:23:22,287 - main - INFO - Reloading configuration settings...
2025-04-25 08:23:22,318 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:23:22,319 - main - INFO - Initializing Gemini model...
2025-04-25 08:23:22,320 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:23:22,320 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:23:23,242 - main - INFO - Gemini model test response: Connection successful! I am online and ready to respond. How can I help you today?

2025-04-25 08:23:23,243 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:23:23,244 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:23:38,189 - main - INFO - Reloading configuration settings...
2025-04-25 08:23:38,219 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:23:38,220 - main - INFO - Initializing Gemini model...
2025-04-25 08:23:38,220 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:23:38,221 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:23:40,073 - main - INFO - Gemini model test response: Okay, I'm here and responding. Looks like the connection is working!  How can I help you?

2025-04-25 08:23:40,074 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:23:40,074 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:24:11,282 - main - INFO - Reloading configuration settings...
2025-04-25 08:24:11,310 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:24:11,310 - main - INFO - Initializing Gemini model...
2025-04-25 08:24:11,311 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:24:11,311 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:24:12,988 - main - INFO - Gemini model test response: Connection test successful. How can I help you today?

2025-04-25 08:24:12,989 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:24:12,989 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:24:13,358 - main - INFO - Reloading configuration settings...
2025-04-25 08:24:13,386 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:24:13,386 - main - INFO - Initializing Gemini model...
2025-04-25 08:24:13,387 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:24:13,387 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:24:15,119 - main - INFO - Gemini model test response: Connection successful. I am able to receive and respond to your messages. How can I help you today?

2025-04-25 08:24:15,119 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:24:15,120 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:24:15,418 - main - INFO - Reloading configuration settings...
2025-04-25 08:24:15,444 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:24:15,444 - main - INFO - Initializing Gemini model...
2025-04-25 08:24:15,445 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:24:15,445 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:24:17,072 - main - INFO - Gemini model test response: Connection established. How can I help you today?

2025-04-25 08:24:17,073 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:24:17,073 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:25:04,250 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '31'}
2025-04-25 08:25:04,251 - main - INFO - Raw request body length: 31
2025-04-25 08:25:04,252 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:25:04,252 - main - INFO - Parsed JSON: {'message': 'hello', 'user_id': 3}
2025-04-25 08:25:04,252 - main - INFO - Extracted message: 'hello', user_id: 3
2025-04-25 08:25:04,285 - main - INFO - Found 3 relevant documents for query: hello
2025-04-25 08:25:04,887 - main - INFO - Received response from Gemini API (gemini-2.0-flash)
2025-04-25 08:25:04,889 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'hello', 'processing_time': '0.64 seconds', 'model': 'gemini-2.0-flash'}
2025-04-25 08:25:22,865 - main - INFO - Reloading configuration settings...
2025-04-25 08:25:22,889 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:25:22,890 - main - INFO - Initializing Gemini model...
2025-04-25 08:25:22,890 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:25:22,891 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:25:24,554 - main - INFO - Gemini model test response: Connection successful. I am ready to assist you. How can I help you today?

2025-04-25 08:25:24,555 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:25:24,555 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:38:36,418 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:38:36,434 - main - INFO - Initializing vector database...
2025-04-25 08:38:36,435 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:38:36,437 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:38:36,437 - main - INFO - Loading vector store...
2025-04-25 08:38:39,374 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:38:46,191 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:38:55,220 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 08:38:55,235 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 08:38:55,258 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 08:38:55,767 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 08:38:57,699 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 08:38:57,699 - main - INFO - Vector database retriever configured successfully
2025-04-25 08:38:57,700 - main - INFO - Testing retriever with a simple query
2025-04-25 08:38:57,759 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 08:38:57,759 - main - INFO - Initializing Gemini model...
2025-04-25 08:38:57,760 - main - INFO - Initializing Gemini model...
2025-04-25 08:38:57,760 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:38:57,761 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-25 08:38:59,492 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond. Is there anything specific you would like me to do now?

2025-04-25 08:38:59,493 - main - INFO - Gemini model initialized successfully
2025-04-25 08:39:18,113 - main - INFO - Reloading configuration settings...
2025-04-25 08:39:18,141 - main - INFO - Using provided configuration directly.
2025-04-25 08:39:18,142 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:39:18,142 - main - INFO - Initializing Gemini model...
2025-04-25 08:39:18,143 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:39:18,143 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 08:39:19,908 - main - INFO - Gemini model test response: Connection established. I am ready for your instructions. How can I help you?

2025-04-25 08:39:19,909 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:39:19,910 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:39:38,382 - main - INFO - Reloading configuration settings...
2025-04-25 08:39:38,414 - main - INFO - Using provided configuration directly.
2025-04-25 08:39:38,415 - main - INFO - Reinitializing OpenAI model...
2025-04-25 08:39:38,415 - main - INFO - Initializing OpenAI model...
2025-04-25 08:39:38,416 - main - INFO - Using API key: sk-p...KR8A (middle part hidden)
2025-04-25 08:39:38,417 - main - INFO - Creating OpenAI client...
2025-04-25 08:39:38,418 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:39:38,418 - main - INFO - Trying alternative initialization method
2025-04-25 08:39:38,419 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:39:38,419 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:39:38,420 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:39:38,424 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:39:38,425 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 08:40:54,639 - main - INFO - Reloading configuration settings...
2025-04-25 08:40:54,666 - main - INFO - Using provided configuration directly.
2025-04-25 08:40:54,667 - main - INFO - Reinitializing OpenAI model...
2025-04-25 08:40:54,667 - main - INFO - Initializing OpenAI model...
2025-04-25 08:40:54,668 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:40:54,668 - main - INFO - Creating OpenAI client...
2025-04-25 08:40:54,669 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:40:54,669 - main - INFO - Trying alternative initialization method
2025-04-25 08:40:54,670 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:40:54,670 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:40:54,671 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:40:54,672 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:40:54,672 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 08:41:20,344 - main - INFO - Reloading configuration settings...
2025-04-25 08:41:20,375 - main - INFO - Using provided configuration directly.
2025-04-25 08:41:20,375 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:41:20,376 - main - INFO - Initializing Gemini model...
2025-04-25 08:41:20,376 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:41:20,377 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-25 08:41:22,013 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  How can I help you today?

2025-04-25 08:41:22,014 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:41:22,014 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:41:56,104 - main - INFO - Reloading configuration settings...
2025-04-25 08:41:56,130 - main - INFO - Using provided configuration directly.
2025-04-25 08:41:56,130 - main - INFO - Reinitializing OpenAI model...
2025-04-25 08:41:56,131 - main - INFO - Initializing OpenAI model...
2025-04-25 08:41:56,131 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:41:56,132 - main - INFO - Creating OpenAI client...
2025-04-25 08:41:56,132 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:41:56,133 - main - INFO - Trying alternative initialization method
2025-04-25 08:41:56,133 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:41:56,133 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:41:56,134 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:41:56,135 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:41:56,135 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 08:42:22,793 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '31'}
2025-04-25 08:42:22,794 - main - INFO - Raw request body length: 31
2025-04-25 08:42:22,794 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:42:22,795 - main - INFO - Parsed JSON: {'message': 'hello', 'user_id': 3}
2025-04-25 08:42:22,795 - main - INFO - Extracted message: 'hello', user_id: 3
2025-04-25 08:42:22,796 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:42:22,796 - main - INFO - Initializing OpenAI model...
2025-04-25 08:42:22,797 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:42:22,797 - main - INFO - Creating OpenAI client...
2025-04-25 08:42:22,798 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:42:22,799 - main - INFO - Trying alternative initialization method
2025-04-25 08:42:22,799 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:42:22,799 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:42:22,800 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:42:22,801 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:42:22,844 - main - INFO - Found 3 relevant documents for query: hello
2025-04-25 08:42:22,845 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:42:22,846 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin đầy đủ về chủ đề này trong cơ sở dữ liệu.', 'query': 'hello', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:43:10,769 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '123'}
2025-04-25 08:43:10,770 - main - INFO - Raw request body length: 123
2025-04-25 08:43:10,770 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:43:10,771 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3}
2025-04-25 08:43:10,771 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-25 08:43:10,772 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:43:10,772 - main - INFO - Initializing OpenAI model...
2025-04-25 08:43:10,772 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:43:10,773 - main - INFO - Creating OpenAI client...
2025-04-25 08:43:10,773 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:43:10,774 - main - INFO - Trying alternative initialization method
2025-04-25 08:43:10,774 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:43:10,774 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:43:10,775 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:43:10,776 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:43:10,812 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-25 08:43:10,813 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:43:10,814 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?\n\nURL: https://baomoi.com/lam-gi-sau-khi-my-hoan-ap-thue-doi-ung-90-ngay-c51948411.epi\n\nCONTENT:\n\nBối cảnh mới, tâm thế mới\n\n"Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vàoMỹngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.\n\nPhía sau kỷ lục ngành nông nghiệp là sự thay đổi cách thức sản xuất - kinh doanh theo hướng bài bản hơn. Ảnh: Trung Chánh\n\nTITLE: Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán\n\nURL: https://baomoi.com/hoan-ap-thue-90-ngay-thoi-diem-de-tai-co-cau-danh-muc-chung-khoan-c51960750.epi\n\nCONTENT:\n\nChiều ngày 9/4 (sáng sớm ngày 10/4 theo giờ Việt Nam), Tổng thống MỹDonald Trumpthông báo sẽ tạm hoãn thời gian áp dụng mức thuế quan mới với gần 60 đối tác thương mại trong vòng 90 ngày, nhằm thêm thời gian để các bên đàm phán. Thuế suất nhập khẩu và thuế chống bán phá giá đối các mặt hàng nhôm, thép và ô tô được giữ nguyên hiện trạng.\n\nThị trường chứng khoánthế giớilập tức phản ứng tích cực với thông tin trên, chỉ số Dow Jones và S&P500 của Mỹ đóng cửa với mức tăng lần lượt là 7,9% và 9,5%, đánh dấu phiên tăng điểm mạnh nhất kể từ thời điểm Covid-19. Trên thị trường chứng khoán Việt Nam, sắc tím cũng lan tỏa trên cả 3 sàn trong phiên giao dịch ngày 10/4.\n\nMỹ có động thái bất ngờ quyết định hoãn áp thuế đối ứng trong 90 ngày với hơn 75 đối tác thương mại. Quyết định này tạo nên một làn sóng trên toàn cầu, từ hoan nghênh thận trọng tới cảnh báo chiến lược trả đũa.', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:43:57,325 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '124'}
2025-04-25 08:43:57,326 - main - INFO - Raw request body length: 124
2025-04-25 08:43:57,326 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:43:57,327 - main - INFO - Parsed JSON: {'message': "Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này", 'user_id': 3}
2025-04-25 08:43:57,327 - main - INFO - Extracted message: 'Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này', user_id: 3
2025-04-25 08:43:57,328 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:43:57,328 - main - INFO - Initializing OpenAI model...
2025-04-25 08:43:57,328 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:43:57,329 - main - INFO - Creating OpenAI client...
2025-04-25 08:43:57,329 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:43:57,330 - main - INFO - Trying alternative initialization method
2025-04-25 08:43:57,330 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:43:57,330 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:43:57,331 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:43:57,332 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:43:57,369 - main - INFO - Found 3 relevant documents for query: Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này
2025-04-25 08:43:57,370 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:43:57,371 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Năm nay, giá vàng thế giới đã tăng hơn 16%.\n\n“Căng thẳng địa chính trị tăng lên và hy vọng rằng Fed sẽ giảm lãi suất mạnh tay hơn sẽ tạo ra điều kiện thuận lợi để vàng tăng giá. Sẽ đến lúc giá vàng thiết lập được kỷ lục mới, một khi biến động hiện nay trên thị trường lắng xuống”, trưởng phân tích Han Tan của công ty Exinity Group nhận định.\n\nTính trong 7 tháng năm 2024, tổng trị giá nhập khẩu của nhóm các doanh nghiệp này đạt 135,38 tỷ USD, tăng 17,3% (tương ứng tăng 19,95 tỷ USD) so với cùng kỳ năm trước, chiếm 63,6% tổng trị giá nhập khẩu của cả nước./.\n\nTrị giá nhập khẩu hàng hóa của các doanh nghiệp FDI trong kỳ này đạt 10,81 tỷ USD, tăng 15% (tương ứng tăng 1,41 tỷ USD) so với kỳ 2 tháng 6/2024.', 'query': "Giá vàng 'không cản nổi', tăng thêm 6% trong tuần này", 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:44:47,166 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '195'}
2025-04-25 08:44:47,167 - main - INFO - Raw request body length: 195
2025-04-25 08:44:47,167 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:44:47,168 - main - INFO - Parsed JSON: {'message': 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', 'user_id': 3}
2025-04-25 08:44:47,168 - main - INFO - Extracted message: 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', user_id: 3
2025-04-25 08:44:47,168 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:44:47,169 - main - INFO - Initializing OpenAI model...
2025-04-25 08:44:47,169 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:44:47,169 - main - INFO - Creating OpenAI client...
2025-04-25 08:44:47,170 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:44:47,170 - main - INFO - Trying alternative initialization method
2025-04-25 08:44:47,171 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:44:47,171 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:44:47,172 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:44:47,172 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:44:47,206 - main - INFO - Found 3 relevant documents for query: TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại
2025-04-25 08:44:47,207 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:44:47,207 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Cơ hội để doanh nghiệp Hải Dương tái cơ cấu thị trường xuất khẩu, sản xuất\n\nURL: https://baomoi.com/co-hoi-de-doanh-nghiep-hai-duong-tai-co-cau-thi-truong-xuat-khau-san-xuat-c51955666.epi\n\nCONTENT:\n\nKhi Mỹ tạm hoãn thuế đối ứng, công nhân, người lao động Công ty TNHH May TBT yên tâm sản xuất hơn (ảnh cơ sở cung cấp)\n\nGiảm bớt lo lắng\n\nTITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại\n\nURL: https://baomoi.com/hai-duong-de-nghi-tap-doan-aeon-som-khoi-cong-du-an-trung-tam-thuong-mai-c51945432.epi\n\nCONTENT:\n\nChủ tịch UBND tỉnh Hải Dương đã có buổi làm việc với Tập đoàn AEON Nhật Bản.\n\nNgày 10/4, ông Lê Ngọc Châu, Chủ tịch UBND tỉnhHải Dươnglàm việc với Tập đoàn AEON Nhật Bản.\n\nTại buổi làm việc, Chủ tịch UBND tỉnh Hải Dương cho biết hiện nay, do nguyên nhân khách quan và chủ quan, dự án Trung tâm Thương mạiAEONHải Dương đang bị chậm tiến độ so với kế hoạch đề ra khoảng 1 tháng. Tuy nhiên đến thời điểm hiện nay, dự án đã hội tụ đủ điều kiện để khởi công xây dựng, đề nghị trong thời gian tới AEON Việt Nam tập trung nhân lực, máy móc thiết bị, tổ chức thi công dự án để bù lại thời gian chậm tiến độ, phấn đấu đưa dự án vào hoạt động đúng tiến độ trong quý III/2026.\n\nBên cạnh đó, Bình Dương tiếp tục tập trung cao độ tháo gỡ khó khăn, vướng mắc về giải phóng mặt bằng, vật liệu… để công tác thi công, xây dựng các dự án thuận lợi hơn.', 'query': 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:45:21,863 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:45:21,881 - main - INFO - Initializing vector database...
2025-04-25 08:45:21,882 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 08:45:21,884 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 08:45:21,885 - main - INFO - Loading vector store...
2025-04-25 08:45:24,934 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 08:45:32,986 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 08:45:42,089 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 08:45:42,094 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 08:45:42,118 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 08:45:42,698 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 08:45:44,578 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 08:45:44,578 - main - INFO - Vector database retriever configured successfully
2025-04-25 08:45:44,579 - main - INFO - Testing retriever with a simple query
2025-04-25 08:45:44,629 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 08:45:44,630 - main - INFO - Initializing OpenAI model...
2025-04-25 08:45:44,631 - main - INFO - Initializing OpenAI model...
2025-04-25 08:45:44,631 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 08:45:44,632 - main - INFO - Creating OpenAI client...
2025-04-25 08:45:44,632 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:45:44,633 - main - INFO - Trying alternative initialization method
2025-04-25 08:45:44,633 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:45:44,634 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 08:45:44,635 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:45:44,637 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:45:44,637 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 08:46:08,120 - main - INFO - Reloading configuration settings...
2025-04-25 08:46:08,149 - main - INFO - Using provided configuration directly.
2025-04-25 08:46:08,150 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:46:08,150 - main - INFO - Initializing Gemini model...
2025-04-25 08:46:08,151 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:46:08,151 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-25 08:46:10,331 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you?

2025-04-25 08:46:10,331 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:46:10,332 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:46:21,714 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '195'}
2025-04-25 08:46:21,716 - main - INFO - Raw request body length: 195
2025-04-25 08:46:21,716 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:46:21,717 - main - INFO - Parsed JSON: {'message': 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', 'user_id': 3}
2025-04-25 08:46:21,717 - main - INFO - Extracted message: 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', user_id: 3
2025-04-25 08:46:21,738 - main - INFO - Found 3 relevant documents for query: TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại
2025-04-25 08:46:24,142 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-25 08:46:24,143 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Chủ tịch UBND tỉnh Hải Dương đã có buổi làm việc với Tập đoàn AEON Nhật Bản. ... Tại buổi làm việc, Chủ tịch UBND tỉnh Hải Dương cho biết hiện nay, do nguyên nhân khách quan và chủ quan, dự án Trung tâm Thương mại AEON Hải Dương đang bị chậm tiến độ so với kế hoạch đề ra khoảng 1 tháng. Tuy nhiên đến thời điểm hiện nay, dự án đã hội tụ đủ điều kiện để khởi công xây dựng, đề nghị trong thời gian tới AEON Việt Nam tập trung nhân lực, máy móc thiết bị, tổ chức thi công dự án để bù lại thời gian chậm tiến độ, phấn đấu đưa dự án vào hoạt động đúng tiến độ trong quý III/2026."\n', 'query': 'TITLE: Hải Dương đề nghị Tập đoàn AEON sớm khởi công Dự án Trung tâm Thương mại', 'processing_time': '2.43 seconds', 'model': 'gemini-1.5-pro'}
2025-04-25 08:47:55,457 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '104'}
2025-04-25 08:47:55,458 - main - INFO - Raw request body length: 104
2025-04-25 08:47:55,458 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:47:55,458 - main - INFO - Parsed JSON: {'message': 'Tập đoàn Dầu khí Việt Nam đổi tên', 'user_id': 3}
2025-04-25 08:47:55,459 - main - INFO - Extracted message: 'Tập đoàn Dầu khí Việt Nam đổi tên', user_id: 3
2025-04-25 08:47:55,488 - main - INFO - Found 3 relevant documents for query: Tập đoàn Dầu khí Việt Nam đổi tên
2025-04-25 08:47:56,997 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-25 08:47:56,998 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Hiện, Tập đoàn Dầu khí Việt Nam (PVN) sở hữu 75,56% cổ phần đơn vị này."  Không có thông tin nào đề cập đến việc Tập đoàn Dầu khí Việt Nam đổi tên.\n', 'query': 'Tập đoàn Dầu khí Việt Nam đổi tên', 'processing_time': '1.54 seconds', 'model': 'gemini-1.5-pro'}
2025-04-25 08:48:18,120 - main - INFO - Reloading configuration settings...
2025-04-25 08:48:18,156 - main - INFO - Using provided configuration directly.
2025-04-25 08:48:18,157 - main - INFO - Reinitializing Gemini model...
2025-04-25 08:48:18,157 - main - INFO - Initializing Gemini model...
2025-04-25 08:48:18,158 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 08:48:18,158 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-25 08:48:19,448 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-25 08:48:19,449 - main - INFO - Gemini model reinitialized successfully
2025-04-25 08:48:19,449 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 08:48:50,091 - main - INFO - Reloading configuration settings...
2025-04-25 08:48:50,115 - main - INFO - Using provided configuration directly.
2025-04-25 08:48:50,116 - main - INFO - Reinitializing OpenAI model...
2025-04-25 08:48:50,116 - main - INFO - Initializing OpenAI model...
2025-04-25 08:48:50,117 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:48:50,117 - main - INFO - Creating OpenAI client...
2025-04-25 08:48:50,118 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:48:50,118 - main - INFO - Trying alternative initialization method
2025-04-25 08:48:50,119 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:48:50,119 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:48:50,120 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:48:50,121 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:48:50,122 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 08:51:39,548 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '31'}
2025-04-25 08:51:39,549 - main - INFO - Raw request body length: 31
2025-04-25 08:51:39,549 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:51:39,550 - main - INFO - Parsed JSON: {'message': 'hello', 'user_id': 3}
2025-04-25 08:51:39,550 - main - INFO - Extracted message: 'hello', user_id: 3
2025-04-25 08:51:39,551 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:51:39,551 - main - INFO - Initializing OpenAI model...
2025-04-25 08:51:39,552 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:51:39,552 - main - INFO - Creating OpenAI client...
2025-04-25 08:51:39,553 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:51:39,553 - main - INFO - Trying alternative initialization method
2025-04-25 08:51:39,554 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:51:39,554 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:51:39,554 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:51:39,555 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:51:39,587 - main - INFO - Found 3 relevant documents for query: hello
2025-04-25 08:51:39,588 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:51:39,588 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin đầy đủ về chủ đề này trong cơ sở dữ liệu.', 'query': 'hello', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:51:59,210 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '136'}
2025-04-25 08:51:59,212 - main - INFO - Raw request body length: 136
2025-04-25 08:51:59,212 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:51:59,213 - main - INFO - Parsed JSON: {'message': 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', 'user_id': 3}
2025-04-25 08:51:59,213 - main - INFO - Extracted message: 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', user_id: 3
2025-04-25 08:51:59,214 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:51:59,215 - main - INFO - Initializing OpenAI model...
2025-04-25 08:51:59,215 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:51:59,216 - main - INFO - Creating OpenAI client...
2025-04-25 08:51:59,217 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:51:59,218 - main - INFO - Trying alternative initialization method
2025-04-25 08:51:59,218 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:51:59,218 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:51:59,219 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:51:59,220 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:51:59,266 - main - INFO - Found 3 relevant documents for query: Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn
2025-04-25 08:51:59,266 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:51:59,267 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Từ năm 2010 đến nay, Quỹ bình ổn giá luôn luôn dương khi chốt số vào thời điểm cuối năm, trong đó thấp nhất là 169 tỷ đồng vào 2013 và cao nhất hơn 9.235 tỷ đồng vào 2020. Số dư trên quỹ này hơn 6.655 tỷ đồng tính đến cuối 2023, tăng hơn 2.000 tỷ đồng so với năm trước, theo Bộ Tài chính.\n\nPhương Dung\n\nHội thảo diễn ra chiều ngày 4/4 tại Buôn Ma Thuột, Đắk Lắk\n\nTại hội thảo, các đại biểu đã trình bày 10 tham luận, trong đó có các tham luận của lãnh đạo các Tỉnh uỷ Đắk Lắk, Đắk Nông, Lâm Đồng, đại diện Bộ Tài nguyên và Môi trường, Bộ Nông nghiệp và Phát triển nông thôn, các chuyên gia, doanh nghiệp.\n\nTITLE: Đảng bộ Trường Đại học Điều dưỡng Nam Định tổ chức Đại hội nhiệm kỳ 2025-2030\n\nURL: https://baomoi.com/dang-bo-truong-dai-hoc-dieu-duong-nam-dinh-to-chuc-dai-hoi-nhiem-ky-2025-2030-c51943645.epi\n\nCONTENT:\n\nChiều 10/4, Đảng bộ Trường Đại học Điều dưỡngNam Địnhtổ chức Đại hội lần thứ XIV, nhiệm kỳ 2025-2030. Đồng chí Nguyễn Thị Thu Thủy, TUV, Phó Bí thư chuyên trách Đảng ủy UBND tỉnh dự và tặng hoa chúc mừng.\n\nCác đại biểu dự Đại hội Đảng bộ Trường Đại học Điều dưỡng Nam Định lần thứ XIV, nhiệm kỳ 2025-2030.', 'query': 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:52:56,008 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '104'}
2025-04-25 08:52:56,009 - main - INFO - Raw request body length: 104
2025-04-25 08:52:56,010 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:52:56,010 - main - INFO - Parsed JSON: {'message': 'Tập đoàn Dầu khí Việt Nam đổi tên', 'user_id': 3}
2025-04-25 08:52:56,011 - main - INFO - Extracted message: 'Tập đoàn Dầu khí Việt Nam đổi tên', user_id: 3
2025-04-25 08:52:56,011 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:52:56,012 - main - INFO - Initializing OpenAI model...
2025-04-25 08:52:56,012 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:52:56,013 - main - INFO - Creating OpenAI client...
2025-04-25 08:52:56,013 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:52:56,014 - main - INFO - Trying alternative initialization method
2025-04-25 08:52:56,014 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:52:56,014 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:52:56,015 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:52:56,016 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:52:56,045 - main - INFO - Found 3 relevant documents for query: Tập đoàn Dầu khí Việt Nam đổi tên
2025-04-25 08:52:56,046 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:52:56,046 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đây là doanh nghiệp Nhà nước, hoạt động trong ngành sản xuất phân bón. Hiện, Tập đoàn Dầu khí Việt Nam (PVN) sở hữu 75,56% cổ phần đơn vị này. Công ty có ba nhà máy và chiếm khoảng 10,6% thị phần phân bón nội địa, tập trung vào Đồng bằng sông Cửu Long, Đông Nam Bộ, Tây Nguyên và Campuchia.\n\nViệt Hưng\n\nVnEconomy\xa007/11/2024 06:00\n\nNội dung bài viết được đăng tải trên Tạp chí Kinh tế Việt Nam số 45-2024 phát hành ngày 04/11/2024.Kính mời Quý độc giả tìm đọc tạiđây:\n\nhttps://postenp.phaha.vn/chi-tiet-toa-soan/tap-chi-kinh-te-viet-nam\n\nVnEconomy\xa030/12/2024 02:19\n\nNội dung đầy đủ của bài viết được đăng tải trên\xa0Tạp chí Kinh tế Việt Nam số 53-2024 phát hành ngày 30/12/2024.\xa0Kính mời Quý độc giả tìm đọc tạiđây:\n\nhttps://postenp.phaha.vn/chi-tiet-toa-soan/tap-chi-kinh-te-viet-nam', 'query': 'Tập đoàn Dầu khí Việt Nam đổi tên', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:55:21,168 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '148'}
2025-04-25 08:55:21,173 - main - INFO - Raw request body length: 148
2025-04-25 08:55:21,174 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:55:21,175 - main - INFO - Parsed JSON: {'message': 'Cuộc chiến tranh thương mại Mỹ - Trung có thể đi đến đâu?', 'user_id': 3}
2025-04-25 08:55:21,177 - main - INFO - Extracted message: 'Cuộc chiến tranh thương mại Mỹ - Trung có thể đi đến đâu?', user_id: 3
2025-04-25 08:55:21,178 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:55:21,179 - main - INFO - Initializing OpenAI model...
2025-04-25 08:55:21,181 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:55:21,182 - main - INFO - Creating OpenAI client...
2025-04-25 08:55:21,184 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:55:21,185 - main - INFO - Trying alternative initialization method
2025-04-25 08:55:21,186 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:55:21,187 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:55:21,188 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:55:21,190 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:55:21,243 - main - INFO - Found 3 relevant documents for query: Cuộc chiến tranh thương mại Mỹ - Trung có thể đi đến đâu?
2025-04-25 08:55:21,244 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:55:21,244 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Chỉ sau gần 1 giờ giao dịch, toàn thị trường đã có tới 620 mã tăng kịch trần và 239 mã tăng giá.\n\nTrước đó, từ phiên 3-9/4 thị trường chứng khoán Việt đã liên tiếp chứng kiến những phiên giảm điểm sâu, khiến vốn hóa thị trường "bốc hơi" hơn 930.000 tỷ đồng (tương đương gần 36 tỷ USD) kể từ tuyên bố áp thuế đối với các nước trênthế giới, trong đó có Việt Nam, của Tổng thống Mỹ Donald Trump.\n\nDù diễn biến tiêu cực xảy ra, nhưng các chuyên gia vẫn dự báo rằng tác động này không kéo dài và thị trường có thể đảo chiều.\n\nĐơn cử như ông Nguyễn Thế Minh - Giám đốc Khối Nghiên cứu và Phát triển khách hàng cá nhân CTCKYuantaViệt Nam cho hay, sự tác động đến thị trường chứng khoán là có và thị trường sẽ phản ứng rất nhanh rồi đảo chiều tăng trong một vài phiên tới. Bởi mức định giá thấp như hiện nay cũng là một cách kích thích để dòng tiền quay trở lại bắt đáy.\n\nDòng chảy thương mại hai chiều này vừa giúp đa dạng hóa sản phẩm phục vụ nhu cầu trong nước, vừa tạo động lực để ngành sầu riêng Việt Nam khẳng định vị thế trên thị trường quốc tế.\n\nThi Hà\n\nBuôn Ma Thuột, Đắk Lắk - nơi mở màn Chiến dịch Hồ Chí Minh lịch sử, thống nhất đất nước, sau gần nửa thế kỷ đi qua, nhìn lại và điểm lại những thành tựu đạt được, người dân có quyền tự hào, tự tin hưởng trái ngọt từ những quyết sách đúng, sự nỗ lực vượt khó của Đảng bộ, chính quyền, nhân dân 49 dân tộc anh em nơi đây./.', 'query': 'Cuộc chiến tranh thương mại Mỹ - Trung có thể đi đến đâu?', 'processing_time': '0.07 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:58:10,678 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '177'}
2025-04-25 08:58:10,680 - main - INFO - Raw request body length: 177
2025-04-25 08:58:10,680 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:58:10,681 - main - INFO - Parsed JSON: {'message': 'Khách hàng yêu cầu doanh nghiệp Việt đẩy nhanh tiến độ sản xuất và giao hàng', 'user_id': 3}
2025-04-25 08:58:10,681 - main - INFO - Extracted message: 'Khách hàng yêu cầu doanh nghiệp Việt đẩy nhanh tiến độ sản xuất và giao hàng', user_id: 3
2025-04-25 08:58:10,681 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:58:10,682 - main - INFO - Initializing OpenAI model...
2025-04-25 08:58:10,682 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:58:10,682 - main - INFO - Creating OpenAI client...
2025-04-25 08:58:10,683 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:58:10,683 - main - INFO - Trying alternative initialization method
2025-04-25 08:58:10,684 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:58:10,684 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:58:10,684 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:58:10,685 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:58:10,763 - main - INFO - Found 3 relevant documents for query: Khách hàng yêu cầu doanh nghiệp Việt đẩy nhanh tiến độ sản xuất và giao hàng
2025-04-25 08:58:10,763 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:58:10,764 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Về phía doanh nghiệp, đã gia tăng cơ hội tiếp cận khách hàng, tăng nhận diện về thương hiệu và tham gia vào chuỗi sản xuất, cung ứng, phân phối hàng hóa toàn cầu, nâng cao niềm tự hào về chất lượng hàng Việt trên thế giới.\n\nCuối cùng, ba lý do hàng đầu để các khách hàng Việt cân nhắc lựa chọn các ứng dụng gọi xe máy là tính sẵn có dễ dàng, giá cả tốt và chương trình khuyến mãi hấp dẫn, ngoài ra thái độ của tài xế và thời gian chờ đợi thấp cũng góp phần khiến ứng dụng nào được ưu tiên đặt xe máy hơn.\n\nHiện nhiều nhà giao dịch đang giao dịch tại Sở giao dịch hàng hóa Việt Nam khẳng định việc đưa hàng hóa niêm yết giao dịch là xu hướng tất yếu của thị trường hàng hóathế giớinói chung và Việt Nam nói riêng. Do đó, sàn giao dịch hàng hóa tại TTTCQT đang được trông đợi rất nhiều. Nhiều mặt hàng đã sẵn sàng để niêm yết trên các sàn giao dịch hàng hóa cũng như nhiều doanh nghiệp đã “đánh tiếng” về việc sẽ đưa các mặt hàng nào lên giao dịch tại sàn.', 'query': 'Khách hàng yêu cầu doanh nghiệp Việt đẩy nhanh tiến độ sản xuất và giao hàng', 'processing_time': '0.08 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 08:58:32,601 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '61'}
2025-04-25 08:58:32,602 - main - INFO - Raw request body length: 61
2025-04-25 08:58:32,602 - main - INFO - Used utf-8 encoding for request body
2025-04-25 08:58:32,602 - main - INFO - Parsed JSON: {'message': 'Về phía doanh nghiệp', 'user_id': 3}
2025-04-25 08:58:32,603 - main - INFO - Extracted message: 'Về phía doanh nghiệp', user_id: 3
2025-04-25 08:58:32,603 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 08:58:32,604 - main - INFO - Initializing OpenAI model...
2025-04-25 08:58:32,604 - main - INFO - Using API key: *** (middle part hidden)
2025-04-25 08:58:32,604 - main - INFO - Creating OpenAI client...
2025-04-25 08:58:32,605 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:58:32,605 - main - INFO - Trying alternative initialization method
2025-04-25 08:58:32,605 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 08:58:32,606 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 08:58:32,606 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 08:58:32,607 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 08:58:32,660 - main - INFO - Found 3 relevant documents for query: Về phía doanh nghiệp
2025-04-25 08:58:32,661 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 08:58:32,661 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Các doanh nghiệp phải cạnh tranh về chi phí để chiếm lĩnh thị trường và thương nhân hoàn toàn có quyền bán thấp hơn giá bán tối đa theo công thức giá quy định tại nghị định, qua đó loại bỏ việc áp dụng giá bán xăng dầu vùng 2 của thương nhân.\n\nVề phía doanh nghiệp, họ kiến nghị có cơ chế ưu đãi thuế, tín dụng xanh để giảm chi phí, khắc phục khó khăn về vốn khi chuyển đổi. Doanh nghiệp cũng cần hỗ trợ kiến thức của các bên tư vấn về cách thức thiết lập chiến lược, xây dựng lộ trình chuyển đổi theo hướng xanh, bền vững.\n\nBảo An\n\nTheo đó, Thứ trưởng Hoàng Trung đề nghị phía Mỹ nhanh chóng xem xét các kết quả tích cực của phía Việt Nam, có kết luận để kết thúc vụ điều tra về kiểm soát khai thác và thương mại gỗ bất hợp pháp.\n\nThùy Linh', 'query': 'Về phía doanh nghiệp', 'processing_time': '0.06 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:14:42,730 - main - INFO - Reloading configuration settings...
2025-04-25 09:14:42,762 - main - INFO - Using provided configuration directly.
2025-04-25 09:14:42,763 - main - INFO - Reinitializing OpenAI model...
2025-04-25 09:14:42,763 - main - INFO - Initializing OpenAI model...
2025-04-25 09:14:42,763 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:14:42,764 - main - INFO - Creating OpenAI client...
2025-04-25 09:14:42,765 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:14:42,765 - main - INFO - Trying alternative initialization method
2025-04-25 09:14:42,766 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:14:42,766 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 09:14:42,767 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:14:42,768 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:14:42,768 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 09:15:49,125 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '202'}
2025-04-25 09:15:49,127 - main - INFO - Raw request body length: 202
2025-04-25 09:15:49,127 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:15:49,128 - main - INFO - Parsed JSON: {'message': 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'user_id': 3}
2025-04-25 09:15:49,128 - main - INFO - Extracted message: 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', user_id: 3
2025-04-25 09:15:49,129 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:15:49,130 - main - INFO - Initializing OpenAI model...
2025-04-25 09:15:49,130 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:15:49,131 - main - INFO - Creating OpenAI client...
2025-04-25 09:15:49,131 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:15:49,132 - main - INFO - Trying alternative initialization method
2025-04-25 09:15:49,132 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:15:49,133 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 09:15:49,133 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:15:49,134 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:15:49,186 - main - INFO - Found 3 relevant documents for query: Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?
2025-04-25 09:15:49,187 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:15:49,187 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Dù tự kê khai, song theo ông Sơn, trường hợp phát hiện nhà cung cấp báo cáo chưa đúng doanh thu, cơ quan thuế đối chiếu dữ liệu để xác định. Sau đó, họ sẽ yêu cầu doanh nghiệp thực hiện nghĩa vụ và thanh, kiểm tra khi có dấu hiệu gian lận, trốn thuế.\n\nCũng theo số liệu từ cơ quan thuế, tổng thu ngân sách Nhà nước 8 tháng do cơ quan này quản lý ước đạt 1,65 triệu tỷ đồng, tăng hơn 17% so với cùng kỳ năm trước.\n\nPhương Dung\n\nTITLE: Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?\n\nURL: https://baomoi.com/cang-thang-thuong-mai-my-trung-trung-quoc-phan-ung-the-nao-truoc-lan-song-thue-quan-moi-c51941905.epi\n\nCONTENT:\n\nTổng thống Mỹ Donald Trump ký sắc lệnh hành pháp tại Nhà Trắng, Washington, D.C. Ảnh tư liệu: THX/TTXVN\n\nTheo trang Al Jazeera, dù Washington đã bắt đầu tiến hành đàm phán với một số quốc gia liên quan, các động thái áp thuế qua lại giữa hai nền kinh tế lớn nhấtthế giớiđã khiến giá hàng hóa nhập khẩu từ Trung Quốc vào Mỹ tăng hơn gấp đôi chỉ trong vòng hai tháng. Đáp lại, Trung Quốc cũng đã nâng mức thuế đối với hàng hóa của Mỹ lên 84%.\n\nNhững diễn biến này đã khiến thị trường chứng khoán toàn cầu lao dốc, khi giới đầu tư lo ngại về hệ lụy kinh tế từ một cuộc chiến thương mại mở rộng.\n\nTheo ông Song, nếu bị đẩy vào chân tường, Trung Quốc có thể phản ứng mạnh hơn so với dự báo của hầu hết các nhà phân tích. Một số biện pháp đáp trả khả thi của Bắc Kinh có thể là siết chặt kiểm soát xuất khẩu hoặc cấm xuất khẩu đất hiếm, hoặc áp đặt trừng phạt với các tập đoàn lớn của Mỹ có hiện diện lớn tại thị trường Trung Quốc.', 'query': 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'processing_time': '0.06 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:16:27,734 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '39'}
2025-04-25 09:16:27,735 - main - INFO - Raw request body length: 39
2025-04-25 09:16:27,736 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:16:27,736 - main - INFO - Parsed JSON: {'message': 'full bài', 'user_id': 3}
2025-04-25 09:16:27,736 - main - INFO - Extracted message: 'full bài', user_id: 3
2025-04-25 09:16:27,737 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:16:27,737 - main - INFO - Initializing OpenAI model...
2025-04-25 09:16:27,738 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:16:27,738 - main - INFO - Creating OpenAI client...
2025-04-25 09:16:27,739 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:16:27,739 - main - INFO - Trying alternative initialization method
2025-04-25 09:16:27,739 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:16:27,740 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 09:16:27,740 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:16:27,741 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:16:27,769 - main - INFO - Found 3 relevant documents for query: full bài
2025-04-25 09:16:27,770 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:16:27,770 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Bài và ảnh: Thanh Huê\n\nBài, ảnh: Hoàng Anh\n\nBài và ảnh: Thu Hòa', 'query': 'full bài', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:17:01,028 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '226'}
2025-04-25 09:17:01,030 - main - INFO - Raw request body length: 226
2025-04-25 09:17:01,031 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:17:01,032 - main - INFO - Parsed JSON: {'message': 'full bài viết:Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'user_id': 3}
2025-04-25 09:17:01,032 - main - INFO - Extracted message: 'full bài viết:Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', user_id: 3
2025-04-25 09:17:01,033 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:17:01,033 - main - INFO - Initializing OpenAI model...
2025-04-25 09:17:01,034 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:17:01,034 - main - INFO - Creating OpenAI client...
2025-04-25 09:17:01,035 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:17:01,035 - main - INFO - Trying alternative initialization method
2025-04-25 09:17:01,036 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:17:01,036 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 09:17:01,037 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:17:01,038 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:17:01,068 - main - INFO - Found 3 relevant documents for query: full bài viết:Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?
2025-04-25 09:17:01,068 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:17:01,069 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Việt Nam đã có những hành động cụ thể nhằm thực hiện cam kết tại COP26, như ban hành Chiến lược quốc gia về biến đổi khí hậu, Chiến lược tăng trưởng xanh, và Đề án triển khai cam kết Net Zero. Song song với nỗ lực chuyển đổi năng lượng, Việt Nam xác định thị trường carbon là công cụ quan trọng nhằm huy động nguồn lực xã hội cho giảm phát thải.\n\nÔng Tăng Thế Cường, Cục trưởng Cục Biến đổi khí hậu, Bộ Nông nghiệp và Môi trường\n\nTITLE: Căng thẳng thương mại Mỹ - Trung: Cơ hội nào cho Việt Nam?\n\nURL: https://baomoi.com/cang-thang-thuong-mai-my-trung-co-hoi-nao-cho-viet-nam-c51952627.epi\n\nCONTENT:\n\nCơ hội cho Việt Nam\n\nNgày 10/4/2025, Bộ Thương mạiTrung Quốccông bố áp thuế chống bán phá giá lên đến 125% đối với các sản phẩm của Mỹ. Đây được xem là một phản ứng mạnh mẽ sau khi Mỹ duy trì các mức thuế cao với hàng hóa Trung Quốc, trong bối cảnh hai nền kinh tế lớn nhất thế giới chưa tìm được tiếng nói chung trong thương mại.\n\nViệc Trung Quốc áp thuế cao không chỉ dừng lại ở phản ứng chính trị. Nó cũng thể hiện xu hướng gia tăng bảo hộ sản xuất nội địa, đặc biệt khi các ngành công nghiệp Trung Quốc đang đối mặt với thặng dư nguồn cung và nhu cầu suy yếu sau đại dịch.\n\nThuế suất tối thiểu toàn cầu là sáng kiến của Chương trình hành động chống xói mòn thu ngân sách, trốn tránh thuế toàn cầu (BEPS) có sự tham gia của 142 quốc gia. Việc sớm áp dụng thuế tối thiểu toàn cầu tại Việt Nam là cần thiết để bảo đảm quyền và lợi ích hợp pháp của Việt Nam. Đồng thời với đó là nghiên cứu, bổ sung các hình thức ưu đãi, hỗ trợ đầu tư mới sẽ càng tăng tính hấp dẫn của môi trường đầu tư tại Việt Nam.', 'query': 'full bài viết:Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:30:32,455 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 09:30:32,471 - main - INFO - Initializing vector database...
2025-04-25 09:30:32,472 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 09:30:32,475 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 09:30:32,476 - main - INFO - Loading vector store...
2025-04-25 09:30:35,767 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 09:30:43,182 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 09:30:52,034 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 09:30:52,039 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 09:30:52,087 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 09:30:52,631 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 09:30:54,595 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 09:30:54,596 - main - INFO - Vector database retriever configured successfully
2025-04-25 09:30:54,597 - main - INFO - Testing retriever with a simple query
2025-04-25 09:30:54,694 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 09:30:54,695 - main - INFO - Initializing OpenAI model...
2025-04-25 09:30:54,695 - main - INFO - Initializing OpenAI model...
2025-04-25 09:30:54,696 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 09:30:54,697 - main - INFO - Creating OpenAI client...
2025-04-25 09:30:54,697 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:30:54,698 - main - INFO - Trying alternative initialization method
2025-04-25 09:30:54,698 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:30:54,699 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 09:30:54,699 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:30:54,704 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:30:54,705 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 09:31:12,925 - main - INFO - Reloading configuration settings...
2025-04-25 09:31:12,954 - main - INFO - Using provided configuration directly.
2025-04-25 09:31:12,954 - main - INFO - Reinitializing OpenAI model...
2025-04-25 09:31:12,955 - main - INFO - Initializing OpenAI model...
2025-04-25 09:31:12,955 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:31:12,956 - main - INFO - Creating OpenAI client...
2025-04-25 09:31:12,956 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:31:12,957 - main - INFO - Trying alternative initialization method
2025-04-25 09:31:12,957 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:31:12,958 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:31:12,959 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:31:12,960 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:31:12,960 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 09:31:31,437 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '202'}
2025-04-25 09:31:31,438 - main - INFO - Raw request body length: 202
2025-04-25 09:31:31,439 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:31:31,439 - main - INFO - Parsed JSON: {'message': 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'user_id': 3}
2025-04-25 09:31:31,440 - main - INFO - Extracted message: 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', user_id: 3
2025-04-25 09:31:31,440 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:31:31,441 - main - INFO - Initializing OpenAI model...
2025-04-25 09:31:31,442 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:31:31,442 - main - INFO - Creating OpenAI client...
2025-04-25 09:31:31,443 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:31:31,444 - main - INFO - Trying alternative initialization method
2025-04-25 09:31:31,444 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:31:31,445 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:31:31,446 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:31:31,447 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:31:31,556 - main - INFO - Found 3 relevant documents for query: Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?
2025-04-25 09:31:31,557 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:31:31,558 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Dù tự kê khai, song theo ông Sơn, trường hợp phát hiện nhà cung cấp báo cáo chưa đúng doanh thu, cơ quan thuế đối chiếu dữ liệu để xác định. Sau đó, họ sẽ yêu cầu doanh nghiệp thực hiện nghĩa vụ và thanh, kiểm tra khi có dấu hiệu gian lận, trốn thuế.\n\nCũng theo số liệu từ cơ quan thuế, tổng thu ngân sách Nhà nước 8 tháng do cơ quan này quản lý ước đạt 1,65 triệu tỷ đồng, tăng hơn 17% so với cùng kỳ năm trước.\n\nPhương Dung\n\nTITLE: Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?\n\nURL: https://baomoi.com/cang-thang-thuong-mai-my-trung-trung-quoc-phan-ung-the-nao-truoc-lan-song-thue-quan-moi-c51941905.epi\n\nCONTENT:\n\nTổng thống Mỹ Donald Trump ký sắc lệnh hành pháp tại Nhà Trắng, Washington, D.C. Ảnh tư liệu: THX/TTXVN\n\nTheo trang Al Jazeera, dù Washington đã bắt đầu tiến hành đàm phán với một số quốc gia liên quan, các động thái áp thuế qua lại giữa hai nền kinh tế lớn nhấtthế giớiđã khiến giá hàng hóa nhập khẩu từ Trung Quốc vào Mỹ tăng hơn gấp đôi chỉ trong vòng hai tháng. Đáp lại, Trung Quốc cũng đã nâng mức thuế đối với hàng hóa của Mỹ lên 84%.\n\nNhững diễn biến này đã khiến thị trường chứng khoán toàn cầu lao dốc, khi giới đầu tư lo ngại về hệ lụy kinh tế từ một cuộc chiến thương mại mở rộng.\n\nTheo ông Song, nếu bị đẩy vào chân tường, Trung Quốc có thể phản ứng mạnh hơn so với dự báo của hầu hết các nhà phân tích. Một số biện pháp đáp trả khả thi của Bắc Kinh có thể là siết chặt kiểm soát xuất khẩu hoặc cấm xuất khẩu đất hiếm, hoặc áp đặt trừng phạt với các tập đoàn lớn của Mỹ có hiện diện lớn tại thị trường Trung Quốc.', 'query': 'Căng thẳng thương mại Mỹ - Trung: Trung Quốc phản ứng thế nào trước làn sóng thuế quan mới?', 'processing_time': '0.12 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:39:11,925 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 09:39:11,941 - main - INFO - Initializing vector database...
2025-04-25 09:39:11,941 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 09:39:11,944 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 09:39:11,945 - main - INFO - Loading vector store...
2025-04-25 09:39:14,823 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 09:39:41,323 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 09:39:41,339 - main - INFO - Initializing vector database...
2025-04-25 09:39:41,339 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 09:39:41,342 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 09:39:41,342 - main - INFO - Loading vector store...
2025-04-25 09:39:42,986 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 09:39:48,806 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 09:39:59,332 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 09:39:59,348 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 09:39:59,370 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 09:39:59,879 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 09:40:01,721 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 09:40:01,721 - main - INFO - Vector database retriever configured successfully
2025-04-25 09:40:01,722 - main - INFO - Testing retriever with a simple query
2025-04-25 09:40:01,762 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 09:40:01,763 - main - INFO - Initializing OpenAI model...
2025-04-25 09:40:01,763 - main - INFO - Initializing OpenAI model...
2025-04-25 09:40:01,764 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:40:01,764 - main - INFO - Creating OpenAI client...
2025-04-25 09:40:01,765 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:01,765 - main - INFO - Trying alternative initialization method
2025-04-25 09:40:01,766 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:40:01,766 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:40:01,767 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:01,771 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:40:01,771 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 09:40:19,110 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '136'}
2025-04-25 09:40:19,112 - main - INFO - Raw request body length: 136
2025-04-25 09:40:19,112 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:40:19,113 - main - INFO - Parsed JSON: {'message': 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', 'user_id': 3}
2025-04-25 09:40:19,113 - main - INFO - Extracted message: 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', user_id: 3
2025-04-25 09:40:19,114 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:40:19,114 - main - INFO - Initializing OpenAI model...
2025-04-25 09:40:19,115 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:40:19,115 - main - INFO - Creating OpenAI client...
2025-04-25 09:40:19,116 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:19,116 - main - INFO - Trying alternative initialization method
2025-04-25 09:40:19,117 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:40:19,117 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:40:19,117 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:19,118 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:40:19,139 - main - INFO - Found 3 relevant documents for query: Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn
2025-04-25 09:40:19,139 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:40:19,140 - main - INFO - Chat response: {'success': True, 'answer': 'Từ năm 2010 đến nay, Quỹ bình ổn giá luôn luôn dương khi chốt số vào thời điểm cuối năm, trong đó thấp nhất là 169 tỷ đồng vào 2013 và cao nhất hơn 9.235 tỷ đồng vào 2020. Số dư trên quỹ này hơn 6.655 tỷ đồng tính đến cuối 2023, tăng hơn 2.000 tỷ đồng so với năm trước, theo Bộ Tài chính.\n\nPhương Dung\n\nHội thảo diễn ra chiều ngày 4/4 tại Buôn Ma Thuột, Đắk Lắk\n\nTại hội thảo, các đại biểu đã trình bày 10 tham luận, trong đó có các tham luận của lãnh đạo các Tỉnh uỷ Đắk Lắk, Đắk Nông, Lâm Đồng, đại diện Bộ Tài nguyên và Môi trường, Bộ Nông nghiệp và Phát triển nông thôn, các chuyên gia, doanh nghiệp.\n\nTITLE: Đảng bộ Trường Đại học Điều dưỡng Nam Định tổ chức Đại hội nhiệm kỳ 2025-2030\n\nURL: https://baomoi.com/dang-bo-truong-dai-hoc-dieu-duong-nam-dinh-to-chuc-dai-hoi-nhiem-ky-2025-2030-c51943645.epi\n\nCONTENT:\n\nChiều 10/4, Đảng bộ Trường Đại học Điều dưỡngNam Địnhtổ chức Đại hội lần thứ XIV, nhiệm kỳ 2025-2030. Đồng chí Nguyễn Thị Thu Thủy, TUV, Phó Bí thư chuyên trách Đảng ủy UBND tỉnh dự và tặng hoa chúc mừng.\n\nCác đại biểu dự Đại hội Đảng bộ Trường Đại học Điều dưỡng Nam Định lần thứ XIV, nhiệm kỳ 2025-2030.', 'query': 'Chiều 10/4, Đảng bộ Trường Đại học Điều dưỡn', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:40:51,728 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '126'}
2025-04-25 09:40:51,730 - main - INFO - Raw request body length: 126
2025-04-25 09:40:51,730 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:40:51,731 - main - INFO - Parsed JSON: {'message': "Jack Ma muốn AI phục vụ, không phải 'chúa tể' con người", 'user_id': 3}
2025-04-25 09:40:51,731 - main - INFO - Extracted message: 'Jack Ma muốn AI phục vụ, không phải 'chúa tể' con người', user_id: 3
2025-04-25 09:40:51,732 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:40:51,732 - main - INFO - Initializing OpenAI model...
2025-04-25 09:40:51,732 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:40:51,733 - main - INFO - Creating OpenAI client...
2025-04-25 09:40:51,733 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:51,734 - main - INFO - Trying alternative initialization method
2025-04-25 09:40:51,734 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:40:51,735 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:40:51,735 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:40:51,736 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:40:51,764 - main - INFO - Found 3 relevant documents for query: Jack Ma muốn AI phục vụ, không phải 'chúa tể' con người
2025-04-25 09:40:51,764 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:40:51,765 - main - INFO - Chat response: {'success': True, 'answer': "TITLE: Jack Ma muốn AI phục vụ, không phải 'chúa tể' con người\n\nURL: https://baomoi.com/jack-ma-muon-ai-phuc-vu-khong-phai-chua-te-con-nguoi-c51950402.epi\n\nCONTENT:\n\nĐồng sáng lập Alibaba Jack Ma cho rằng AI nên bảo vệ sinh kế của con người. Ảnh: Weibo\n\nTrong lần xuất hiện hiếm hoi trước nhân viênAlibaba, Jack Ma lập luận trí tuệ nhân tạo (AI) nên được “may đo” để phục vụ con người, làm cho cuộc sống của họ tốt đẹp hơn. Nó nên bảo vệ sinh kế chứ không phải làm “chúa tể”.\n\n“Chúng ta không cố gắng để làm cho máy móc giống con người hơn. Chúng ta muốn chúng hiểu con người, suy nghĩ như con người và làm những thứ chúng ta không thể làm”,ông phát biểu. Theo tỷ phú, người làm công nghệ có trách nhiệm bảo đảm AI biết và hỗ trợ loài người.\n\nTừ một đế chế thương mại điện tử khổng lồ, Alibaba đang xoay trục sang lĩnh vực AI những năm gần đây. Công ty đã giới thiệu loạt mô hình AI Qwen, thu hút sự chú ý rộng rãi, cạnh tranh vớiOpenAIvà DeepSeek.\n\nBằng cách áp dụng phương pháp phát triển phần mềm theo hướng AI, các tổ chức có thể khai phá những tiềm năng mới của con người, thúc đẩy tiến bộ và đột phá trên mọi phương diện.\n\nTóm lại, tôi cho rằng bài toán lớn nhất của Việt Nam không hẳn là “phải có một mô hình AI nội địa” bằng mọi giá, mà là làm thế nào để AI thực sự phục vụ doanh nghiệp và xã hội Việt Nam. Nếu đi đúng hướng đó, chúng ta sẽ từng bước làm chủ công nghệ, vừa phát triển được năng lực nội địa, vừa giảm dần sự phụ thuộc vào các nền tảng nước ngoài.", 'query': "Jack Ma muốn AI phục vụ, không phải 'chúa tể' con người", 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 09:41:34,580 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '81'}
2025-04-25 09:41:34,581 - main - INFO - Raw request body length: 81
2025-04-25 09:41:34,581 - main - INFO - Used utf-8 encoding for request body
2025-04-25 09:41:34,582 - main - INFO - Parsed JSON: {'message': 'tôi muốn full nội dung bài báo', 'user_id': 3}
2025-04-25 09:41:34,582 - main - INFO - Extracted message: 'tôi muốn full nội dung bài báo', user_id: 3
2025-04-25 09:41:34,583 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 09:41:34,583 - main - INFO - Initializing OpenAI model...
2025-04-25 09:41:34,583 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 09:41:34,584 - main - INFO - Creating OpenAI client...
2025-04-25 09:41:34,584 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:41:34,584 - main - INFO - Trying alternative initialization method
2025-04-25 09:41:34,585 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 09:41:34,585 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 09:41:34,586 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 09:41:34,587 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 09:41:34,624 - main - INFO - Found 3 relevant documents for query: tôi muốn full nội dung bài báo
2025-04-25 09:41:34,624 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 09:41:34,625 - main - INFO - Chat response: {'success': True, 'answer': 'Cùng với đó, doanh nghiệp cần tối ưu hóa chuỗi logistics chuyên dụng giúp nâng cao năng lực cạnh tranh, giảm chi phí và đảm bảo chất lượng khi đến tay người tiêu dùng Mỹ.\n\nThi Hà\n\nBên cạnh đó, một số ví cũng cho biết thời gian tới có kế hoạch ứng dụng thêm nhiều công nghệ cao như trí tuệ nhân tạo để tăng cường bảo mật thông tin người dùng đồng thời nâng cấp trải nghiệm người dùng khi sử dụng ví điện tử.\n\nTITLE: Sắp có gói tín dụng 500.000 tỷ đồng tạo động lực mới cho tăng trưởng kinh tế\n\nURL: https://baomoi.com/sap-co-goi-tin-dung-500-000-ty-dong-tao-dong-luc-moi-cho-tang-truong-kinh-te-c51952828.epi\n\nCONTENT:\n\nTheo Phó Thống đốc Đào Minh Tú, việc triển khai gói tín dụng 500.000 tỷ đồng và các chính sách hỗ trợ kịp thời là rất cấp bách, thể hiện chủ trương đúng đắn của Đảng, Nhà nước và Chính phủ.', 'query': 'tôi muốn full nội dung bài báo', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-25 15:06:35,099 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 15:06:35,117 - main - INFO - Initializing ChatbotService...
2025-04-25 15:07:28,421 - main - INFO - Reloading configuration settings...
2025-04-25 15:07:28,474 - main - INFO - Using provided configuration directly.
2025-04-25 15:07:28,475 - app.services.chatbot - INFO - Restarting ChatbotService components...
2025-04-25 15:07:28,485 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:07:28,485 - app.services.chatbot - INFO - Initializing OpenAI API...
2025-04-25 15:07:28,486 - app.services.chatbot - ERROR - Error initializing OpenAI API: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:07:28,487 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:07:28,494 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:07:28,494 - app.services.chatbot - ERROR - Error restarting components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:07:28,495 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 333, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:08:10,305 - main - INFO - Reloading configuration settings...
2025-04-25 15:08:10,334 - main - INFO - Using provided configuration directly.
2025-04-25 15:08:10,334 - app.services.chatbot - INFO - Restarting ChatbotService components...
2025-04-25 15:08:10,335 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:08:10,336 - app.services.chatbot - INFO - Initializing OpenAI API...
2025-04-25 15:08:10,336 - app.services.chatbot - ERROR - Error initializing OpenAI API: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:08:10,337 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:08:10,337 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:08:10,338 - app.services.chatbot - ERROR - Error restarting components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:08:10,338 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 333, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:09:14,926 - main - INFO - Reloading configuration settings...
2025-04-25 15:09:14,951 - main - INFO - Using provided configuration directly.
2025-04-25 15:09:14,951 - app.services.chatbot - INFO - Restarting ChatbotService components...
2025-04-25 15:09:14,952 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:09:14,952 - app.services.chatbot - INFO - Initializing OpenAI API...
2025-04-25 15:09:14,953 - app.services.chatbot - ERROR - Error initializing OpenAI API: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:09:14,954 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:09:14,954 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:09:14,955 - app.services.chatbot - ERROR - Error restarting components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:09:14,956 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 333, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:09:38,808 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '144'}
2025-04-25 15:09:38,809 - main - INFO - Raw request body length: 144
2025-04-25 15:09:38,810 - main - INFO - Used utf-8 encoding for request body
2025-04-25 15:09:38,810 - main - INFO - Parsed JSON: {'message': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'user_id': 3}
2025-04-25 15:09:38,811 - main - INFO - Extracted message: 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', user_id: 3
2025-04-25 15:09:38,811 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:09:38,812 - app.services.chatbot - INFO - Initializing OpenAI API...
2025-04-25 15:09:38,812 - app.services.chatbot - ERROR - Error initializing OpenAI API: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:09:38,813 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:09:38,813 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:09:38,814 - app.services.chatbot - ERROR - Error in get_answer: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:09:38,815 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 200, in get_answer
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:09:38,815 - main - INFO - Chat response: {'query': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'response': 'Xin lỗi, có lỗi xảy ra khi xử lý câu hỏi của bạn. Vui lòng thử lại sau.', 'model_info': {'error': 'Failed to initialize OpenAI API. Please check your API key and internet connection.'}}
2025-04-25 15:09:38,816 - main - ERROR - Error in chat_direct: 'success'
2025-04-25 15:09:38,816 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 437, in chat_direct
    "success": result["success"],
KeyError: 'success'

2025-04-25 15:10:46,423 - main - INFO - Reloading configuration settings...
2025-04-25 15:10:46,448 - main - INFO - Using provided configuration directly.
2025-04-25 15:10:46,449 - app.services.chatbot - INFO - Restarting ChatbotService components...
2025-04-25 15:10:46,449 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:10:46,450 - app.services.chatbot - INFO - Initializing OpenAI API...
2025-04-25 15:10:46,450 - app.services.chatbot - ERROR - Error initializing OpenAI API: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:10:46,451 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:10:46,451 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:10:46,452 - app.services.chatbot - ERROR - Error restarting components: Failed to initialize OpenAI API. Please check your API key and internet connection.
2025-04-25 15:10:46,452 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 78, in _initialize_components
    self._openai_client = OpenAI(api_key=settings.OPENAI_API_KEY)
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 333, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 90, in _initialize_components
    raise RuntimeError("Failed to initialize OpenAI API. Please check your API key and internet connection.")
RuntimeError: Failed to initialize OpenAI API. Please check your API key and internet connection.

2025-04-25 15:16:09,283 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 15:16:09,299 - main - INFO - Initializing ChatbotService...
2025-04-25 15:16:56,718 - main - INFO - Reloading configuration settings...
2025-04-25 15:16:56,750 - main - INFO - Using provided configuration directly.
2025-04-25 15:16:56,750 - app.services.chatbot - INFO - Restarting ChatbotService...
2025-04-25 15:16:56,755 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:16:56,755 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-25 15:16:56,755 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-25 15:16:56,756 - app.services.chatbot - INFO - Vector store path: /app/vector_db
2025-04-25 15:16:56,759 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:00,153 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:06,870 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 15:17:16,022 - app.services.chatbot - INFO - Loading vector store from /app/vector_db
2025-04-25 15:17:16,022 - app.services.chatbot - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-25 15:17:16,023 - app.services.chatbot - INFO - Configuring retriever
2025-04-25 15:17:16,023 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:16,024 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:16,025 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:16,025 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:16,026 - app.services.chatbot - ERROR - Error restarting ChatbotService: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:16,026 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 353, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:30,495 - main - INFO - Reloading configuration settings...
2025-04-25 15:17:30,524 - main - INFO - Using provided configuration directly.
2025-04-25 15:17:30,525 - app.services.chatbot - INFO - Restarting ChatbotService...
2025-04-25 15:17:30,531 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:17:30,532 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-25 15:17:30,533 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-25 15:17:30,533 - app.services.chatbot - INFO - Vector store path: /app/vector_db
2025-04-25 15:17:30,536 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:30,537 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:32,857 - app.services.chatbot - INFO - Loading vector store from /app/vector_db
2025-04-25 15:17:32,858 - app.services.chatbot - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-25 15:17:32,858 - app.services.chatbot - INFO - Configuring retriever
2025-04-25 15:17:32,859 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:32,859 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:32,860 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:32,861 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:32,861 - app.services.chatbot - ERROR - Error restarting ChatbotService: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:32,862 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 353, in restart
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:49,829 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '144'}
2025-04-25 15:17:49,830 - main - INFO - Raw request body length: 144
2025-04-25 15:17:49,830 - main - INFO - Used utf-8 encoding for request body
2025-04-25 15:17:49,830 - main - INFO - Parsed JSON: {'message': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'user_id': 3}
2025-04-25 15:17:49,831 - main - INFO - Extracted message: 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', user_id: 3
2025-04-25 15:17:49,838 - app.services.chatbot - INFO - Initializing ChatbotService components...
2025-04-25 15:17:49,839 - app.services.chatbot - INFO - Initializing Gemini API...
2025-04-25 15:17:49,839 - app.services.chatbot - INFO - Gemini API initialized successfully with model gemini-1.5-pro
2025-04-25 15:17:49,839 - app.services.chatbot - INFO - Vector store path: /app/vector_db
2025-04-25 15:17:49,842 - app.services.chatbot - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:49,842 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:17:52,309 - app.services.chatbot - INFO - Loading vector store from /app/vector_db
2025-04-25 15:17:52,309 - app.services.chatbot - ERROR - Error loading vector store: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-25 15:17:52,310 - app.services.chatbot - INFO - Configuring retriever
2025-04-25 15:17:52,310 - app.services.chatbot - ERROR - Error loading embeddings/vectorstore: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:52,311 - app.services.chatbot - ERROR - Stacktrace: Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:52,311 - app.services.chatbot - ERROR - Error initializing ChatbotService components: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:52,312 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:52,312 - app.services.chatbot - ERROR - Error in ChatbotService.get_answer: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'
2025-04-25 15:17:52,313 - app.services.chatbot - ERROR - Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 139, in _initialize_components
    self._retriever = self._db.as_retriever(
AttributeError: 'NoneType' object has no attribute 'as_retriever'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 200, in get_answer
    self._initialize_components()
  File "/app/app/services/chatbot.py", line 157, in _initialize_components
    raise RuntimeError(f"Failed to initialize vector database: {str(emb_err)}")
RuntimeError: Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'

2025-04-25 15:17:52,314 - main - INFO - Chat response: {'success': False, 'answer': 'Xin lỗi, có lỗi xảy ra trong quá trình xử lý. Vui lòng thử lại sau.', 'query': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'error': "Failed to initialize vector database: 'NoneType' object has no attribute 'as_retriever'"}
2025-04-25 15:20:21,128 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 15:20:21,148 - main - INFO - Initializing vector database...
2025-04-25 15:20:21,149 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 15:20:21,152 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 15:20:21,153 - main - INFO - Loading vector store...
2025-04-25 15:20:24,028 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 15:20:30,907 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 15:20:39,638 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 15:20:39,643 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 15:20:39,687 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 15:20:40,232 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 15:20:42,201 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 15:20:42,202 - main - INFO - Vector database retriever configured successfully
2025-04-25 15:20:42,202 - main - INFO - Testing retriever with a simple query
2025-04-25 15:20:42,339 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 15:20:42,340 - main - INFO - Initializing OpenAI model...
2025-04-25 15:20:42,340 - main - INFO - Initializing OpenAI model...
2025-04-25 15:20:42,341 - main - INFO - Using API key: sk-p...ldgA (middle part hidden)
2025-04-25 15:20:42,341 - main - INFO - Creating OpenAI client...
2025-04-25 15:20:42,342 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:20:42,343 - main - INFO - Trying alternative initialization method
2025-04-25 15:20:42,343 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 15:20:42,344 - main - INFO - Testing OpenAI connection with model: gpt-3.5-turbo
2025-04-25 15:20:42,344 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:20:42,349 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 15:20:42,349 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 15:20:46,050 - main - INFO - Reloading configuration settings...
2025-04-25 15:20:46,080 - main - INFO - Using provided configuration directly.
2025-04-25 15:20:46,081 - main - INFO - Reinitializing Gemini model...
2025-04-25 15:20:46,081 - main - INFO - Initializing Gemini model...
2025-04-25 15:20:46,082 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 15:20:46,083 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 15:20:46,695 - main - ERROR - Error initializing Gemini model: 400 API key expired. Please renew the API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key expired. Please renew the API key."
]
2025-04-25 15:20:46,703 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 258, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key expired. Please renew the API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key expired. Please renew the API key."
]

2025-04-25 15:20:46,704 - main - WARNING - Gemini model reinitialization returned None
2025-04-25 15:20:59,186 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '144'}
2025-04-25 15:20:59,192 - main - INFO - Raw request body length: 144
2025-04-25 15:20:59,193 - main - INFO - Used utf-8 encoding for request body
2025-04-25 15:20:59,194 - main - INFO - Parsed JSON: {'message': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'user_id': 3}
2025-04-25 15:20:59,195 - main - INFO - Extracted message: 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', user_id: 3
2025-04-25 15:20:59,197 - main - INFO - Gemini model not initialized, trying to reinitialize...
2025-04-25 15:20:59,198 - main - INFO - Initializing Gemini model...
2025-04-25 15:20:59,199 - main - INFO - Using API key: AIzaS...uHlvE (middle part hidden)
2025-04-25 15:20:59,202 - main - INFO - Initializing Gemini model: gemini-2.0-flash
2025-04-25 15:21:00,496 - main - ERROR - Error initializing Gemini model: 400 API key expired. Please renew the API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key expired. Please renew the API key."
]
2025-04-25 15:21:00,498 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 258, in initialize_gemini
    test_response = model.generate_content("Test connection")
  File "/usr/local/lib/python3.9/site-packages/google/generativeai/generative_models.py", line 248, in generate_content
    response = self._client.generate_content(request)
  File "/usr/local/lib/python3.9/site-packages/google/ai/generativelanguage_v1beta/services/generative_service/client.py", line 566, in generate_content
    response = rpc(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/gapic_v1/method.py", line 131, in __call__
    return wrapped_func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
  File "/usr/local/lib/python3.9/site-packages/google/api_core/timeout.py", line 130, in func_with_timeout
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/google/api_core/grpc_helpers.py", line 78, in error_remapped_callable
    raise exceptions.from_grpc_error(exc) from exc
google.api_core.exceptions.InvalidArgument: 400 API key expired. Please renew the API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key expired. Please renew the API key."
]

2025-04-25 15:21:00,590 - main - INFO - Found 3 relevant documents for query: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ
2025-04-25 15:21:00,591 - main - WARNING - Using fallback mode (no google model available)
2025-04-25 15:21:00,592 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: UBND TP. Hà Nội công bố kênh tiếp nhận phản ánh, kiến nghị của người dân Thủ đô về các vấn đề, vụ việc, hành vi gây thất thoát, lãng phí trên các kênh thông tin chính thống: Cổng Thông tin điện tử thành phố Hà Nội (địa chỉ: https://hanoi.gov.vn); ứng dụng Công dân số Thủ đô - iHanoi./.\n\n"Thông qua những đóng góp này, chúng tôi khẳng định trách nhiệm doanh nghiệp vì cộng đồng, cam kết xây dựng xã hội vững mạnh và nhân văn", đại diện doanh nghiệp cho hay.\n\nLan Anh\n\nTITLE: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ\n\nURL: https://thoibaotaichinhvietnam.vn/tp-ho-chi-minh-hap-dan-doanh-nghiep-cong-nghe-thong-tin-an-do-171391.html\n\nPUBLICATION DATE: 2025-02-27 12:39:00\n\nCONTENT:\n\nSáng ngày 27/02/2025 tại TP. Hồ Chí Minh diễn ra hội thảo “Tiềm năng hợp tác đầu tư giữa Việt Nam và Ấn Độ”. Tại hội thảo, ông Võ Văn Hoan - Phó Chủ tịch UBND TP. Hồ Chí Minh, nhấn mạnh: “Thành phố đang khẳng định vị thế là trung tâm công nghệ thông tin hàng đầu cả nước, với nhiều lợi thế và tiềm năng phát triển mạnh mẽ. Thành phố mong muốn thu hút các doanh nghiệp công nghệ thông tin trong và ngoài nước, đặc biệt là Ấn Độ”.\n\nThành phố sở hữu môi trường đầu tư thuận lợi\n\nHiện nay, công nghệ thông tin đang đóng vai trò quan trọng trong sự phát triển kinh tế - xã hội của TP. Hồ Chí Minh.', 'query': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'processing_time': '1.40 seconds', 'model': 'fallback', 'api_status': 'Gemini API không khả dụng'}
2025-04-25 15:22:23,775 - main - INFO - Reloading configuration settings...
2025-04-25 15:22:23,814 - main - INFO - Using provided configuration directly.
2025-04-25 15:22:23,815 - main - INFO - Reinitializing OpenAI model...
2025-04-25 15:22:23,816 - main - INFO - Initializing OpenAI model...
2025-04-25 15:22:23,816 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 15:22:23,816 - main - INFO - Creating OpenAI client...
2025-04-25 15:22:23,817 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:22:23,818 - main - INFO - Trying alternative initialization method
2025-04-25 15:22:23,818 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 15:22:23,818 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 15:22:23,819 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 15:22:23,820 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 15:22:23,821 - main - WARNING - OpenAI model reinitialization returned None
2025-04-25 16:01:49,712 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 16:01:49,729 - main - INFO - Initializing vector database...
2025-04-25 16:01:49,729 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 16:01:49,733 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 16:01:49,733 - main - INFO - Loading vector store...
2025-04-25 16:01:52,761 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 16:01:59,422 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 16:02:08,658 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 16:02:08,674 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 16:02:08,711 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 16:02:09,270 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 16:02:11,195 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 16:02:11,196 - main - INFO - Vector database retriever configured successfully
2025-04-25 16:02:11,196 - main - INFO - Testing retriever with a simple query
2025-04-25 16:02:11,248 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 16:02:11,249 - main - INFO - Initializing OpenAI model...
2025-04-25 16:02:11,249 - main - INFO - Initializing OpenAI model...
2025-04-25 16:02:11,250 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 16:02:11,250 - main - INFO - Creating OpenAI client...
2025-04-25 16:02:11,251 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:02:11,251 - main - INFO - Trying alternative initialization method
2025-04-25 16:02:11,252 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 16:02:11,252 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 16:02:11,253 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:02:11,257 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 16:02:11,257 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 16:29:54,902 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-25 16:29:54,950 - main - INFO - Initializing vector database...
2025-04-25 16:29:54,951 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-25 16:29:54,955 - main - INFO - Found vector store files at /app/vector_db
2025-04-25 16:29:54,955 - main - INFO - Loading vector store...
2025-04-25 16:29:58,515 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-25 16:30:07,367 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-25 16:30:16,826 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-25 16:30:16,831 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-25 16:30:16,876 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-25 16:30:17,439 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-25 16:30:19,353 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-25 16:30:19,354 - main - INFO - Vector database retriever configured successfully
2025-04-25 16:30:19,354 - main - INFO - Testing retriever with a simple query
2025-04-25 16:30:19,447 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-25 16:30:19,447 - main - INFO - Initializing OpenAI model...
2025-04-25 16:30:19,448 - main - INFO - Initializing OpenAI model...
2025-04-25 16:30:19,449 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 16:30:19,449 - main - INFO - Creating OpenAI client...
2025-04-25 16:30:19,450 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:30:19,450 - main - INFO - Trying alternative initialization method
2025-04-25 16:30:19,451 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 16:30:19,451 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 16:30:19,452 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:30:19,456 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 16:30:19,456 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-25 16:32:47,678 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '144'}
2025-04-25 16:32:47,683 - main - INFO - Raw request body length: 144
2025-04-25 16:32:47,685 - main - INFO - Used utf-8 encoding for request body
2025-04-25 16:32:47,686 - main - INFO - Parsed JSON: {'message': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'user_id': 3}
2025-04-25 16:32:47,688 - main - INFO - Extracted message: 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', user_id: 3
2025-04-25 16:32:47,689 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-25 16:32:47,690 - main - INFO - Initializing OpenAI model...
2025-04-25 16:32:47,692 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-25 16:32:47,693 - main - INFO - Creating OpenAI client...
2025-04-25 16:32:47,695 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:32:47,697 - main - INFO - Trying alternative initialization method
2025-04-25 16:32:47,698 - main - INFO - OpenAI client initialized with alternative method
2025-04-25 16:32:47,699 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-25 16:32:47,701 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-25 16:32:47,703 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-25 16:32:47,773 - main - INFO - Found 3 relevant documents for query: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ
2025-04-25 16:32:47,774 - main - WARNING - Using fallback mode (no openai model available)
2025-04-25 16:32:47,774 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: UBND TP. Hà Nội công bố kênh tiếp nhận phản ánh, kiến nghị của người dân Thủ đô về các vấn đề, vụ việc, hành vi gây thất thoát, lãng phí trên các kênh thông tin chính thống: Cổng Thông tin điện tử thành phố Hà Nội (địa chỉ: https://hanoi.gov.vn); ứng dụng Công dân số Thủ đô - iHanoi./.\n\n"Thông qua những đóng góp này, chúng tôi khẳng định trách nhiệm doanh nghiệp vì cộng đồng, cam kết xây dựng xã hội vững mạnh và nhân văn", đại diện doanh nghiệp cho hay.\n\nLan Anh\n\nTITLE: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ\n\nURL: https://thoibaotaichinhvietnam.vn/tp-ho-chi-minh-hap-dan-doanh-nghiep-cong-nghe-thong-tin-an-do-171391.html\n\nPUBLICATION DATE: 2025-02-27 12:39:00\n\nCONTENT:\n\nSáng ngày 27/02/2025 tại TP. Hồ Chí Minh diễn ra hội thảo “Tiềm năng hợp tác đầu tư giữa Việt Nam và Ấn Độ”. Tại hội thảo, ông Võ Văn Hoan - Phó Chủ tịch UBND TP. Hồ Chí Minh, nhấn mạnh: “Thành phố đang khẳng định vị thế là trung tâm công nghệ thông tin hàng đầu cả nước, với nhiều lợi thế và tiềm năng phát triển mạnh mẽ. Thành phố mong muốn thu hút các doanh nghiệp công nghệ thông tin trong và ngoài nước, đặc biệt là Ấn Độ”.\n\nThành phố sở hữu môi trường đầu tư thuận lợi\n\nHiện nay, công nghệ thông tin đang đóng vai trò quan trọng trong sự phát triển kinh tế - xã hội của TP. Hồ Chí Minh.', 'query': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'processing_time': '0.09 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 05:26:00,861 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 05:26:00,871 - main - INFO - Initializing vector database...
2025-04-26 05:26:00,871 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 05:26:00,874 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 05:26:00,875 - main - INFO - Loading vector store...
2025-04-26 05:26:03,303 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 05:26:09,295 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 05:27:03,102 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 05:27:03,112 - main - INFO - Initializing vector database...
2025-04-26 05:27:03,112 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 05:27:03,115 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 05:27:03,116 - main - INFO - Loading vector store...
2025-04-26 05:27:06,396 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 05:27:12,165 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 05:27:19,615 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 05:27:19,622 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 05:27:19,653 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 05:27:20,140 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 05:27:22,187 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 05:27:22,188 - main - INFO - Vector database retriever configured successfully
2025-04-26 05:27:22,188 - main - INFO - Testing retriever with a simple query
2025-04-26 05:27:22,326 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 05:27:22,327 - main - INFO - Initializing OpenAI model...
2025-04-26 05:27:22,327 - main - INFO - Initializing OpenAI model...
2025-04-26 05:27:22,328 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 05:27:22,329 - main - INFO - Creating OpenAI client...
2025-04-26 05:27:22,329 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:27:22,330 - main - INFO - Trying alternative initialization method
2025-04-26 05:27:22,330 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 05:27:22,330 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 05:27:22,331 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:27:22,336 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 05:27:22,336 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 05:27:52,156 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '144'}
2025-04-26 05:27:52,157 - main - INFO - Raw request body length: 144
2025-04-26 05:27:52,158 - main - INFO - Used utf-8 encoding for request body
2025-04-26 05:27:52,158 - main - INFO - Parsed JSON: {'message': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'user_id': 3}
2025-04-26 05:27:52,158 - main - INFO - Extracted message: 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', user_id: 3
2025-04-26 05:27:52,158 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 05:27:52,159 - main - INFO - Initializing OpenAI model...
2025-04-26 05:27:52,159 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 05:27:52,159 - main - INFO - Creating OpenAI client...
2025-04-26 05:27:52,160 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:27:52,160 - main - INFO - Trying alternative initialization method
2025-04-26 05:27:52,160 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 05:27:52,160 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 05:27:52,160 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:27:52,161 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 307, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 05:27:52,176 - main - INFO - Found 3 relevant documents for query: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ
2025-04-26 05:27:52,176 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 05:27:52,177 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: UBND TP. Hà Nội công bố kênh tiếp nhận phản ánh, kiến nghị của người dân Thủ đô về các vấn đề, vụ việc, hành vi gây thất thoát, lãng phí trên các kênh thông tin chính thống: Cổng Thông tin điện tử thành phố Hà Nội (địa chỉ: https://hanoi.gov.vn); ứng dụng Công dân số Thủ đô - iHanoi./.\n\n"Thông qua những đóng góp này, chúng tôi khẳng định trách nhiệm doanh nghiệp vì cộng đồng, cam kết xây dựng xã hội vững mạnh và nhân văn", đại diện doanh nghiệp cho hay.\n\nLan Anh\n\nTITLE: TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ\n\nURL: https://thoibaotaichinhvietnam.vn/tp-ho-chi-minh-hap-dan-doanh-nghiep-cong-nghe-thong-tin-an-do-171391.html\n\nPUBLICATION DATE: 2025-02-27 12:39:00\n\nCONTENT:\n\nSáng ngày 27/02/2025 tại TP. Hồ Chí Minh diễn ra hội thảo “Tiềm năng hợp tác đầu tư giữa Việt Nam và Ấn Độ”. Tại hội thảo, ông Võ Văn Hoan - Phó Chủ tịch UBND TP. Hồ Chí Minh, nhấn mạnh: “Thành phố đang khẳng định vị thế là trung tâm công nghệ thông tin hàng đầu cả nước, với nhiều lợi thế và tiềm năng phát triển mạnh mẽ. Thành phố mong muốn thu hút các doanh nghiệp công nghệ thông tin trong và ngoài nước, đặc biệt là Ấn Độ”.\n\nThành phố sở hữu môi trường đầu tư thuận lợi\n\nHiện nay, công nghệ thông tin đang đóng vai trò quan trọng trong sự phát triển kinh tế - xã hội của TP. Hồ Chí Minh.', 'query': 'TP. Hồ Chí Minh: Hấp dẫn doanh nghiệp công nghệ thông tin Ấn Độ', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 05:41:34,156 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 05:41:34,171 - main - INFO - Initializing vector database...
2025-04-26 05:41:34,172 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 05:41:34,174 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 05:41:34,174 - main - INFO - Loading vector store...
2025-04-26 05:41:36,181 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 05:41:41,510 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 05:41:49,007 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 05:41:49,040 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 05:41:49,063 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 05:41:49,375 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 05:41:50,609 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 05:41:50,609 - main - INFO - Vector database retriever configured successfully
2025-04-26 05:41:50,610 - main - INFO - Testing retriever with a simple query
2025-04-26 05:41:50,634 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 05:41:50,635 - main - INFO - Initializing OpenAI model...
2025-04-26 05:41:50,635 - main - INFO - Initializing OpenAI model...
2025-04-26 05:41:50,636 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 05:41:50,636 - main - INFO - Creating OpenAI client...
2025-04-26 05:41:50,637 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:41:50,637 - main - INFO - Trying alternative initialization method
2025-04-26 05:41:50,638 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 05:41:50,638 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 05:41:50,638 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:41:50,642 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 05:41:50,642 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 05:43:03,989 - main - INFO - Processing document ID: 4, File path: documents/3/1745646183_giao-trinh.txt
2025-04-26 05:43:03,992 - main - ERROR - File not found: storage/documents/3/1745646183_giao-trinh.txt
2025-04-26 05:43:11,276 - main - INFO - Processing document ID: 5, File path: documents/3/1745646191_giao-trinh.txt
2025-04-26 05:43:11,276 - main - ERROR - File not found: storage/documents/3/1745646191_giao-trinh.txt
2025-04-26 05:54:56,108 - main - INFO - Processing document ID: 5, File path: documents/3/1745646191_giao-trinh.txt
2025-04-26 05:54:56,109 - main - ERROR - File not found: storage/documents/3/1745646191_giao-trinh.txt
2025-04-26 05:55:35,802 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '190'}
2025-04-26 05:55:35,803 - main - INFO - Raw request body length: 190
2025-04-26 05:55:35,803 - main - INFO - Used utf-8 encoding for request body
2025-04-26 05:55:35,803 - main - INFO - Parsed JSON: {'message': 'ỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3}
2025-04-26 05:55:35,804 - main - INFO - Extracted message: 'ỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 05:55:35,804 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 05:55:35,804 - main - INFO - Initializing OpenAI model...
2025-04-26 05:55:35,805 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 05:55:35,805 - main - INFO - Creating OpenAI client...
2025-04-26 05:55:35,805 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:55:35,805 - main - INFO - Trying alternative initialization method
2025-04-26 05:55:35,806 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 05:55:35,806 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 05:55:35,806 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 05:55:35,807 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 05:55:35,847 - main - INFO - Found 3 relevant documents for query: ỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 05:55:35,847 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 05:55:35,848 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nhau hành động, triển khai các dự án cụ thể để khu vực kinh tế tập thể tiếp tục phát triển, đóng góp vào sự thịnh vượng của đất nước trong tương lai.\n\nAnh Nhi\n\n“Hiện tại, nguồn cung dầu nặng ở Bắc Mỹ đang khá khan hiếm. Có thể trong tương lai mức chiết khấu sẽ quay lại ngưỡng cao hơn, nhưng bây giờ thì rất thấp – lượng tồn kho trong hệ thống gần như bằng không”, ông McKenzie nhận định.\n\nNh.Thạch\n\nAFP\n\nÔng Nikos Fotopoulos, Tổng thư ký tổ chức công đoàn của khu vực kinh tế tư nhân Hy Lạp, gọi Chính phủ Hy Lạp hiện nay là “chính phủ tàn nhẫn và chống lại người lao động chưa từng thấy”, trong một lá thư gửi Bộ trưởng Karemeus.', 'query': 'ỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 06:06:31,702 - main - INFO - Processing document ID: 1, File path: documents/15/1745639882_giao-trinh.txt
2025-04-26 06:06:31,703 - main - ERROR - File not found: storage/documents/15/1745639882_giao-trinh.txt
2025-04-26 06:26:43,771 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 06:26:43,785 - main - INFO - Initializing vector database...
2025-04-26 06:26:43,786 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 06:26:43,788 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 06:26:43,789 - main - INFO - Loading vector store...
2025-04-26 06:26:46,092 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 06:26:51,654 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 06:26:59,569 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 06:26:59,576 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 06:26:59,608 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 06:26:59,929 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 06:27:01,095 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 06:27:01,096 - main - INFO - Vector database retriever configured successfully
2025-04-26 06:27:01,096 - main - INFO - Testing retriever with a simple query
2025-04-26 06:27:01,164 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 06:27:01,165 - main - INFO - Initializing OpenAI model...
2025-04-26 06:27:01,165 - main - INFO - Initializing OpenAI model...
2025-04-26 06:27:01,166 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 06:27:01,166 - main - INFO - Creating OpenAI client...
2025-04-26 06:27:01,167 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:27:01,167 - main - INFO - Trying alternative initialization method
2025-04-26 06:27:01,168 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 06:27:01,168 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 06:27:01,168 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:27:01,172 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 06:27:01,172 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 06:39:40,025 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 06:39:40,040 - main - INFO - Initializing vector database...
2025-04-26 06:39:40,040 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 06:39:40,043 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 06:39:40,043 - main - INFO - Loading vector store...
2025-04-26 06:39:42,074 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 06:39:47,235 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 06:39:54,627 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 06:39:54,646 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 06:39:54,660 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 06:39:54,969 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 06:39:56,130 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 06:39:56,130 - main - INFO - Vector database retriever configured successfully
2025-04-26 06:39:56,131 - main - INFO - Testing retriever with a simple query
2025-04-26 06:39:56,167 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 06:39:56,168 - main - INFO - Initializing OpenAI model...
2025-04-26 06:39:56,168 - main - INFO - Initializing OpenAI model...
2025-04-26 06:39:56,168 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 06:39:56,169 - main - INFO - Creating OpenAI client...
2025-04-26 06:39:56,169 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:39:56,169 - main - INFO - Trying alternative initialization method
2025-04-26 06:39:56,170 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 06:39:56,170 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 06:39:56,170 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:39:56,174 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 06:39:56,174 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 06:40:46,580 - main - INFO - Processing document ID: 6, File path: documents/3/1745649646_giao-trinh.txt
2025-04-26 06:40:46,582 - main - ERROR - File not found: storage/documents/3/1745649646_giao-trinh.txt
2025-04-26 06:41:14,994 - main - INFO - Processing document ID: 1, File path: documents/15/1745639882_giao-trinh.txt
2025-04-26 06:41:14,994 - main - ERROR - File not found: storage/documents/15/1745639882_giao-trinh.txt
2025-04-26 06:41:15,008 - main - INFO - Processing document ID: 4, File path: documents/3/1745646183_giao-trinh.txt
2025-04-26 06:41:15,009 - main - ERROR - File not found: storage/documents/3/1745646183_giao-trinh.txt
2025-04-26 06:41:15,019 - main - INFO - Processing document ID: 5, File path: documents/3/1745646191_giao-trinh.txt
2025-04-26 06:41:15,019 - main - ERROR - File not found: storage/documents/3/1745646191_giao-trinh.txt
2025-04-26 06:41:15,029 - main - INFO - Processing document ID: 6, File path: documents/3/1745649646_giao-trinh.txt
2025-04-26 06:41:15,030 - main - ERROR - File not found: storage/documents/3/1745649646_giao-trinh.txt
2025-04-26 06:42:14,263 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 06:42:14,263 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 06:42:18,477 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 06:42:18,477 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 06:50:05,332 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 06:50:05,346 - main - INFO - Initializing vector database...
2025-04-26 06:50:05,347 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 06:50:05,350 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 06:50:05,350 - main - INFO - Loading vector store...
2025-04-26 06:50:07,397 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 06:50:13,157 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 06:50:20,830 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 06:50:20,851 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 06:50:20,866 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 06:50:21,167 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 06:50:22,372 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 06:50:22,373 - main - INFO - Vector database retriever configured successfully
2025-04-26 06:50:22,373 - main - INFO - Testing retriever with a simple query
2025-04-26 06:50:22,423 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 06:50:22,423 - main - INFO - Initializing OpenAI model...
2025-04-26 06:50:22,424 - main - INFO - Initializing OpenAI model...
2025-04-26 06:50:22,424 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 06:50:22,425 - main - INFO - Creating OpenAI client...
2025-04-26 06:50:22,425 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:50:22,425 - main - INFO - Trying alternative initialization method
2025-04-26 06:50:22,426 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 06:50:22,426 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 06:50:22,426 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 06:50:22,430 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 06:50:22,430 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 07:05:51,233 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:05:54,939 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:05:58,838 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:02,629 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:06,566 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:11,437 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:18,044 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:27,891 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:06:44,085 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:29:17,541 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:29:17,558 - main - INFO - Initializing vector database...
2025-04-26 07:29:17,559 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 07:29:17,560 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 07:29:17,561 - main - INFO - Loading vector store...
2025-04-26 07:29:20,235 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 07:29:34,376 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 07:29:42,769 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 07:29:42,775 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 07:29:42,805 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 07:29:43,160 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 07:29:44,376 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 07:29:44,376 - main - INFO - Vector database retriever configured successfully
2025-04-26 07:29:44,377 - main - INFO - Testing retriever with a simple query
2025-04-26 07:29:44,448 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 07:29:44,448 - main - INFO - Initializing OpenAI model...
2025-04-26 07:29:44,449 - main - INFO - Initializing OpenAI model...
2025-04-26 07:29:44,449 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 07:29:44,449 - main - INFO - Creating OpenAI client...
2025-04-26 07:29:44,450 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 07:29:44,450 - main - INFO - Trying alternative initialization method
2025-04-26 07:29:44,450 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 07:29:44,451 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 07:29:44,451 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 07:29:44,455 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 07:29:44,455 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 07:30:17,791 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 07:30:17,792 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 07:49:29,621 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 07:49:29,636 - main - INFO - Initializing vector database...
2025-04-26 07:49:29,636 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 07:49:29,639 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 07:49:29,639 - main - INFO - Loading vector store...
2025-04-26 07:49:31,736 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 07:49:37,990 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 07:49:45,734 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 07:49:45,751 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 07:49:45,767 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 07:49:46,086 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 07:49:47,391 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 07:49:47,391 - main - INFO - Vector database retriever configured successfully
2025-04-26 07:49:47,392 - main - INFO - Testing retriever with a simple query
2025-04-26 07:49:47,431 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 07:49:47,432 - main - INFO - Initializing OpenAI model...
2025-04-26 07:49:47,432 - main - INFO - Initializing OpenAI model...
2025-04-26 07:49:47,433 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 07:49:47,433 - main - INFO - Creating OpenAI client...
2025-04-26 07:49:47,434 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 07:49:47,434 - main - INFO - Trying alternative initialization method
2025-04-26 07:49:47,434 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 07:49:47,435 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 07:49:47,435 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 07:49:47,438 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 07:49:47,439 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 07:50:06,087 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 07:50:06,087 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 08:08:26,998 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 08:08:27,012 - main - INFO - Initializing vector database...
2025-04-26 08:08:27,013 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 08:08:27,015 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 08:08:27,015 - main - INFO - Loading vector store...
2025-04-26 08:08:29,010 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 08:08:34,413 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 08:08:41,583 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 08:08:41,600 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 08:08:41,616 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 08:08:41,964 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 08:08:43,161 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 08:08:43,162 - main - INFO - Vector database retriever configured successfully
2025-04-26 08:08:43,162 - main - INFO - Testing retriever with a simple query
2025-04-26 08:08:43,202 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 08:08:43,203 - main - INFO - Initializing OpenAI model...
2025-04-26 08:08:43,203 - main - INFO - Initializing OpenAI model...
2025-04-26 08:08:43,204 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 08:08:43,204 - main - INFO - Creating OpenAI client...
2025-04-26 08:08:43,205 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:08:43,205 - main - INFO - Trying alternative initialization method
2025-04-26 08:08:43,205 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 08:08:43,206 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 08:08:43,206 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:08:43,209 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 08:08:43,210 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 08:08:54,658 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 08:08:54,658 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 08:33:54,632 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 08:33:54,648 - main - INFO - Initializing vector database...
2025-04-26 08:33:54,648 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 08:33:54,650 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 08:33:54,650 - main - INFO - Loading vector store...
2025-04-26 08:33:56,891 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 08:34:02,491 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 08:34:09,736 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 08:34:09,743 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 08:34:09,774 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 08:34:10,046 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 08:34:11,268 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 08:34:11,269 - main - INFO - Vector database retriever configured successfully
2025-04-26 08:34:11,269 - main - INFO - Testing retriever with a simple query
2025-04-26 08:34:11,355 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 08:34:11,356 - main - INFO - Initializing OpenAI model...
2025-04-26 08:34:11,356 - main - INFO - Initializing OpenAI model...
2025-04-26 08:34:11,357 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 08:34:11,357 - main - INFO - Creating OpenAI client...
2025-04-26 08:34:11,358 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:34:11,358 - main - INFO - Trying alternative initialization method
2025-04-26 08:34:11,359 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 08:34:11,359 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 08:34:11,360 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:34:11,363 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 08:34:11,363 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 08:34:37,724 - main - INFO - Processing document ID: 7, File path: documents/3/1745649734_giao-trinh.txt
2025-04-26 08:34:37,725 - main - ERROR - File not found: storage/documents/3/1745649734_giao-trinh.txt
2025-04-26 08:35:44,623 - main - INFO - Processing document ID: 8, File path: documents/3/1745656544_giao-trinh.txt
2025-04-26 08:35:44,623 - main - ERROR - File not found: storage/documents/3/1745656544_giao-trinh.txt
2025-04-26 08:35:47,863 - main - INFO - Processing document ID: 8, File path: documents/3/1745656544_giao-trinh.txt
2025-04-26 08:35:47,863 - main - ERROR - File not found: storage/documents/3/1745656544_giao-trinh.txt
2025-04-26 08:39:43,130 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 08:39:43,146 - main - INFO - Initializing vector database...
2025-04-26 08:39:43,146 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 08:39:43,149 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 08:39:43,149 - main - INFO - Loading vector store...
2025-04-26 08:39:45,295 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 08:39:50,945 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 08:39:58,689 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 08:39:58,698 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 08:39:58,712 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 08:39:59,044 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 08:40:00,348 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 08:40:00,348 - main - INFO - Vector database retriever configured successfully
2025-04-26 08:40:00,349 - main - INFO - Testing retriever with a simple query
2025-04-26 08:40:00,375 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 08:40:00,375 - main - INFO - Initializing OpenAI model...
2025-04-26 08:40:00,375 - main - INFO - Initializing OpenAI model...
2025-04-26 08:40:00,376 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 08:40:00,376 - main - INFO - Creating OpenAI client...
2025-04-26 08:40:00,377 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:40:00,377 - main - INFO - Trying alternative initialization method
2025-04-26 08:40:00,377 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 08:40:00,378 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 08:40:00,378 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 08:40:00,382 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 08:40:00,382 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 09:28:45,969 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 09:28:45,984 - main - INFO - Initializing vector database...
2025-04-26 09:28:45,985 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 09:28:45,988 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 09:28:45,988 - main - INFO - Loading vector store...
2025-04-26 09:28:48,302 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:28:53,788 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 09:29:01,678 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:29:01,686 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 09:29:01,714 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 09:29:02,310 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:29:04,302 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 09:29:04,302 - main - INFO - Vector database retriever configured successfully
2025-04-26 09:29:04,302 - main - INFO - Testing retriever with a simple query
2025-04-26 09:29:04,339 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 09:29:04,340 - main - INFO - Initializing OpenAI model...
2025-04-26 09:29:04,340 - main - INFO - Initializing OpenAI model...
2025-04-26 09:29:04,340 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 09:29:04,341 - main - INFO - Creating OpenAI client...
2025-04-26 09:29:04,341 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:29:04,342 - main - INFO - Trying alternative initialization method
2025-04-26 09:29:04,342 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 09:29:04,342 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 09:29:04,342 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:29:04,346 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 324, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 09:29:04,346 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 09:32:15,130 - main - INFO - Processing document ID: 9, File path: documents/3/1745659934_giao-trinh.txt
2025-04-26 09:32:15,133 - main - ERROR - File not found: storage/documents/3/1745659934_giao-trinh.txt
2025-04-26 09:51:53,852 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 09:51:53,872 - main - INFO - Initializing vector database...
2025-04-26 09:51:53,872 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 09:51:53,874 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 09:51:53,874 - main - INFO - Loading vector store...
2025-04-26 09:51:56,153 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:52:01,505 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 09:52:08,789 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:52:08,807 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 09:52:08,823 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 09:52:09,111 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:52:10,369 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 09:52:10,369 - main - INFO - Vector database retriever configured successfully
2025-04-26 09:52:10,370 - main - INFO - Testing retriever with a simple query
2025-04-26 09:52:10,395 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 09:52:10,395 - main - INFO - Initializing OpenAI model...
2025-04-26 09:52:10,396 - main - INFO - Initializing OpenAI model...
2025-04-26 09:52:10,396 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 09:52:10,397 - main - INFO - Creating OpenAI client...
2025-04-26 09:52:10,397 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:52:10,398 - main - INFO - Trying alternative initialization method
2025-04-26 09:52:10,398 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 09:52:10,398 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 09:52:10,399 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:52:10,402 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 09:52:10,403 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 09:53:03,321 - main - INFO - Processing document ID: 9, File path: documents/3/1745659934_giao-trinh.txt
2025-04-26 09:53:03,325 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745659934_giao-trinh.txt
2025-04-26 09:53:03,328 - main - INFO - Loading document: /app/storage/documents/3/1745659934_giao-trinh.txt
2025-04-26 09:53:03,328 - main - INFO - Using TextLoader
2025-04-26 09:53:03,330 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 09:53:03,333 - main - INFO - Document split into 34 chunks
2025-04-26 09:53:03,334 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:53:05,586 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:53:05,588 - main - INFO - Creating vector store at /app/vector_db/doc_9
2025-04-26 09:53:06,519 - main - INFO - Vector store created successfully for document 9
2025-04-26 09:53:06,520 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 09:53:06,539 - main - INFO - Integrating document ID: 9
2025-04-26 09:53:06,540 - main - INFO - Integrating document vectors for document ID: 9
2025-04-26 09:53:06,541 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:53:09,124 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:53:09,457 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:53:10,932 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:53:10,934 - main - INFO - Merging document vectors into main vector database
2025-04-26 09:53:10,974 - main - INFO - Saving merged vector database
2025-04-26 09:53:12,402 - main - INFO - Document vectors integrated successfully for document 9
2025-04-26 09:53:12,456 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 09:53:12,460 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 09:53:12,460 - main - INFO - Loading vector store...
2025-04-26 09:53:12,461 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:53:14,757 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:53:15,132 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:53:16,430 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 09:53:52,652 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '146'}
2025-04-26 09:53:52,653 - main - INFO - Raw request body length: 146
2025-04-26 09:53:52,653 - main - INFO - Used utf-8 encoding for request body
2025-04-26 09:53:52,654 - main - INFO - Parsed JSON: {'message': 'HÀ NỘI -\nChỉ đạo biên soạn Đồng chí Võ Văn Thưởng', 'user_id': 3}
2025-04-26 09:53:52,654 - main - INFO - Extracted message: 'HÀ NỘI -
Chỉ đạo biên soạn Đồng chí Võ Văn Thưởng', user_id: 3
2025-04-26 09:53:52,655 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 09:53:52,655 - main - INFO - Initializing OpenAI model...
2025-04-26 09:53:52,655 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 09:53:52,655 - main - INFO - Creating OpenAI client...
2025-04-26 09:53:52,656 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:53:52,656 - main - INFO - Trying alternative initialization method
2025-04-26 09:53:52,656 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 09:53:52,657 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 09:53:52,657 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:53:52,657 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 09:53:52,686 - main - INFO - Found 3 relevant documents for query: HÀ NỘI -
Chỉ đạo biên soạn Đồng chí Võ Văn Thưởng
2025-04-26 09:53:52,686 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 09:53:52,687 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Trong bối cảnh đầy biến động này, sự chủ động, linh hoạt và sáng tạo trong chiến lược kinh doanh sẽ giúp các DN Việt Nam vượt qua thách thức, duy trì và phát triển bền vững trên thị trường quốc tế.\n\nVân Hương (thực hiện)\n\nTiếp tục đóng góp hoàn thiện văn kiện Đại hội XIV của Đảng\n\nVề vấn đề này, đại diện cơ quan soạn thảo- Bộ Tài chính cho biết sẽ phối hợp với Ủy ban Kinh tế và Tài chính để tiếp thu phương án quy định một mức thuế suất với báo chí là 10%.', 'query': 'HÀ NỘI -\nChỉ đạo biên soạn Đồng chí Võ Văn Thưởng', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 09:59:36,640 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 09:59:36,657 - main - INFO - Initializing vector database...
2025-04-26 09:59:36,658 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 09:59:36,659 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 09:59:36,660 - main - INFO - Loading vector store...
2025-04-26 09:59:38,751 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 09:59:43,960 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 09:59:53,895 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 09:59:53,904 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 09:59:53,920 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 09:59:54,233 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 09:59:55,343 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 09:59:55,343 - main - INFO - Vector database retriever configured successfully
2025-04-26 09:59:55,344 - main - INFO - Testing retriever with a simple query
2025-04-26 09:59:55,375 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 09:59:55,376 - main - INFO - Initializing OpenAI model...
2025-04-26 09:59:55,376 - main - INFO - Initializing OpenAI model...
2025-04-26 09:59:55,376 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 09:59:55,377 - main - INFO - Creating OpenAI client...
2025-04-26 09:59:55,377 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:59:55,378 - main - INFO - Trying alternative initialization method
2025-04-26 09:59:55,378 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 09:59:55,378 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 09:59:55,379 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 09:59:55,382 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 09:59:55,382 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 10:48:44,742 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 10:48:44,757 - main - INFO - Initializing vector database...
2025-04-26 10:48:44,757 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 10:48:44,760 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 10:48:44,760 - main - INFO - Loading vector store...
2025-04-26 10:48:45,842 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 10:48:50,918 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 10:48:58,140 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 10:48:58,146 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 10:48:58,179 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 10:48:58,612 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 10:49:00,323 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 10:49:00,323 - main - INFO - Vector database retriever configured successfully
2025-04-26 10:49:00,324 - main - INFO - Testing retriever with a simple query
2025-04-26 10:49:00,349 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 10:49:00,349 - main - INFO - Initializing OpenAI model...
2025-04-26 10:49:00,350 - main - INFO - Initializing OpenAI model...
2025-04-26 10:49:00,350 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 10:49:00,351 - main - INFO - Creating OpenAI client...
2025-04-26 10:49:00,351 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:49:00,352 - main - INFO - Trying alternative initialization method
2025-04-26 10:49:00,352 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 10:49:00,352 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 10:49:00,353 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:49:00,354 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 10:49:00,354 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 10:50:28,864 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '126'}
2025-04-26 10:50:28,865 - main - INFO - Raw request body length: 126
2025-04-26 10:50:28,865 - main - INFO - Used utf-8 encoding for request body
2025-04-26 10:50:28,865 - main - INFO - Parsed JSON: {'message': '5 xu hướng định hình lại trật tự thế giới mới', 'user_id': 3}
2025-04-26 10:50:28,866 - main - INFO - Extracted message: '5 xu hướng định hình lại trật tự thế giới mới', user_id: 3
2025-04-26 10:50:28,866 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 10:50:28,866 - main - INFO - Initializing OpenAI model...
2025-04-26 10:50:28,866 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 10:50:28,867 - main - INFO - Creating OpenAI client...
2025-04-26 10:50:28,867 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:50:28,867 - main - INFO - Trying alternative initialization method
2025-04-26 10:50:28,867 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 10:50:28,868 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 10:50:28,868 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:50:28,869 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 10:50:28,884 - main - INFO - Found 3 relevant documents for query: 5 xu hướng định hình lại trật tự thế giới mới
2025-04-26 10:50:28,884 - main - INFO - Document 1: Đề xuất mới này thể hiện quyết tâm cao hơn trong việc sàng lọc và nâng cao chất lượng đội ngũ công c...
2025-04-26 10:50:28,885 - main - INFO - Document 2: Bảng dưới đây là 30 quốc gia có số giờ làm việc mỗi tuần của người lao động dài nhất thế giới. Trong...
2025-04-26 10:50:28,885 - main - INFO - Document 3: Trong quý I, toàn huyện đã tiếp nhận hơn 7 nghìn hồ sơ, giải quyết trước hạn và đúng hạn đạt tỷ lệ t...
2025-04-26 10:50:28,885 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 10:50:28,886 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đề xuất mới này thể hiện quyết tâm cao hơn trong việc sàng lọc và nâng cao chất lượng đội ngũ công chức, đảm bảo tính chuyên nghiệp và hiệu quả của bộ máy Nhà nước và dự kiến trình Quốc hội tại kỳ họp thứ 9 khai mạc vào đầu tháng 5 tới.\n\nTrí Đức\n\nBảng dưới đây là 30 quốc gia có số giờ làm việc mỗi tuần của người lao động dài nhất thế giới. Trong đó, Việt Nam đứng thứ 20 với 45,3 tiếng làm việc mỗi tuần.\n\nTrong quý I, toàn huyện đã tiếp nhận hơn 7 nghìn hồ sơ, giải quyết trước hạn và đúng hạn đạt tỷ lệ trên 97%. Đã khởi công xây mới, sửa chữa 80% số nhà trong Kế hoạch hỗ trợ xây mới và sửa chữa nhà ở cho 411 hộ gia đình có khó khăn về nhà ở năm 2025 trên địa bàn huyện.', 'query': '5 xu hướng định hình lại trật tự thế giới mới', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 10:52:30,707 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '196'}
2025-04-26 10:52:30,708 - main - INFO - Raw request body length: 196
2025-04-26 10:52:30,708 - main - INFO - Used utf-8 encoding for request body
2025-04-26 10:52:30,708 - main - INFO - Parsed JSON: {'message': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3}
2025-04-26 10:52:30,709 - main - INFO - Extracted message: 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 10:52:30,709 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 10:52:30,709 - main - INFO - Initializing OpenAI model...
2025-04-26 10:52:30,709 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 10:52:30,710 - main - INFO - Creating OpenAI client...
2025-04-26 10:52:30,710 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:52:30,710 - main - INFO - Trying alternative initialization method
2025-04-26 10:52:30,710 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 10:52:30,711 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 10:52:30,711 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 10:52:30,711 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 10:52:30,729 - main - INFO - Found 3 relevant documents for query: ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 10:52:30,729 - main - INFO - Document 1: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nha...
2025-04-26 10:52:30,729 - main - INFO - Document 2: Với những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn ...
2025-04-26 10:52:30,730 - main - INFO - Document 3: Cùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu ...
2025-04-26 10:52:30,730 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 10:52:30,730 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nhau hành động, triển khai các dự án cụ thể để khu vực kinh tế tập thể tiếp tục phát triển, đóng góp vào sự thịnh vượng của đất nước trong tương lai.\n\nAnh Nhi\n\nVới những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn Minh Tuệ được kỳ vọng sẽ đóng góp tích cực vào sự phát triển của Tập đoàn và chiến lược chuyển đổi AI sẽ được triển khai hiệu quả, giúp nâng cao vị thế của công ty trên thị trường công nghệ trong tương lai.\n\nCùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu nhập trung bình cao vào 2030 và nước phát triển, thu nhập cao vào 2045. Nhà điều hành cũng tiếp tục tạo điều kiện thuận lợi, trong đó có việc cải cách thể chế, để các nhà đầu tư trong và ngoài nước kinh doanh hiệu quả tại Việt Nam.\n\nPhương Dung', 'query': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 14:00:07,768 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 14:00:07,783 - main - INFO - Initializing vector database...
2025-04-26 14:00:07,784 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 14:00:07,787 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 14:00:07,787 - main - INFO - Loading vector store...
2025-04-26 14:00:10,075 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:00:16,804 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 14:00:26,861 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:00:26,971 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 14:00:27,086 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 14:00:32,090 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:00:34,595 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 14:00:34,595 - main - INFO - Vector database retriever configured successfully
2025-04-26 14:00:34,595 - main - INFO - Testing retriever with a simple query
2025-04-26 14:00:34,646 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 14:00:34,646 - main - INFO - Initializing OpenAI model...
2025-04-26 14:00:34,647 - main - INFO - Initializing OpenAI model...
2025-04-26 14:00:34,648 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 14:00:34,648 - main - INFO - Creating OpenAI client...
2025-04-26 14:00:34,649 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:00:34,649 - main - INFO - Trying alternative initialization method
2025-04-26 14:00:34,650 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 14:00:34,650 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 14:00:34,651 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:00:34,654 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 14:00:34,654 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 14:06:19,361 - main - INFO - Processing document ID: 10, File path: documents/3/1745676378_giao-trinh.txt
2025-04-26 14:06:19,366 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745676378_giao-trinh.txt
2025-04-26 14:06:19,368 - main - INFO - Loading document: /app/storage/documents/3/1745676378_giao-trinh.txt
2025-04-26 14:06:19,368 - main - INFO - Using TextLoader
2025-04-26 14:06:19,371 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 14:06:19,373 - main - INFO - Document split into 34 chunks
2025-04-26 14:06:19,373 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:06:21,792 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:06:21,795 - main - INFO - Creating vector store at /app/vector_db/doc_10
2025-04-26 14:06:22,756 - main - INFO - Vector store created successfully for document 10
2025-04-26 14:06:22,757 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 14:06:22,853 - main - INFO - Integrating document ID: 10
2025-04-26 14:06:22,854 - main - INFO - Integrating document vectors for document ID: 10
2025-04-26 14:06:22,856 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:06:24,993 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:06:25,318 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:06:26,852 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:06:26,854 - main - INFO - Merging document vectors into main vector database
2025-04-26 14:06:26,906 - main - INFO - Saving merged vector database
2025-04-26 14:06:28,409 - main - INFO - Document vectors integrated successfully for document 10
2025-04-26 14:06:28,454 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 14:06:28,456 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 14:06:28,457 - main - INFO - Loading vector store...
2025-04-26 14:06:28,457 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:06:31,536 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:06:31,875 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:06:33,061 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 14:37:32,977 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 14:37:32,995 - main - INFO - Initializing vector database...
2025-04-26 14:37:32,995 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 14:37:32,997 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 14:37:32,998 - main - INFO - Loading vector store...
2025-04-26 14:37:35,104 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:37:40,799 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 14:37:49,300 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:37:49,309 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 14:37:49,335 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 14:37:49,670 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:37:50,768 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 14:37:50,768 - main - INFO - Vector database retriever configured successfully
2025-04-26 14:37:50,769 - main - INFO - Testing retriever with a simple query
2025-04-26 14:37:50,799 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 14:37:50,799 - main - INFO - Initializing OpenAI model...
2025-04-26 14:37:50,799 - main - INFO - Initializing OpenAI model...
2025-04-26 14:37:50,800 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 14:37:50,800 - main - INFO - Creating OpenAI client...
2025-04-26 14:37:50,801 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:37:50,801 - main - INFO - Trying alternative initialization method
2025-04-26 14:37:50,802 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 14:37:50,802 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 14:37:50,802 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:37:50,806 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 14:37:50,806 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 14:47:43,248 - main - INFO - Processing document ID: 11, File path: documents/3/1745678863_giao-trinh.txt
2025-04-26 14:47:43,249 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745678863_giao-trinh.txt
2025-04-26 14:47:43,251 - main - INFO - Loading document: /app/storage/documents/3/1745678863_giao-trinh.txt
2025-04-26 14:47:43,251 - main - INFO - Using TextLoader
2025-04-26 14:47:43,253 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 14:47:43,255 - main - INFO - Document split into 34 chunks
2025-04-26 14:47:43,255 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:47:45,732 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:47:45,735 - main - INFO - Creating vector store at /app/vector_db/doc_11
2025-04-26 14:47:46,634 - main - INFO - Vector store created successfully for document 11
2025-04-26 14:47:46,635 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 14:47:46,656 - main - INFO - Integrating document ID: 11
2025-04-26 14:47:46,656 - main - INFO - Integrating document vectors for document ID: 11
2025-04-26 14:47:46,657 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:47:48,948 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:47:49,253 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:47:50,524 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:47:50,525 - main - INFO - Merging document vectors into main vector database
2025-04-26 14:47:50,564 - main - INFO - Saving merged vector database
2025-04-26 14:47:51,919 - main - INFO - Document vectors integrated successfully for document 11
2025-04-26 14:47:51,965 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 14:47:51,967 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 14:47:51,968 - main - INFO - Loading vector store...
2025-04-26 14:47:51,968 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:47:54,233 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:47:54,532 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:47:55,747 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 14:54:38,743 - main - INFO - Processing document ID: 12, File path: documents/3/1745679275_giao-trinh.txt
2025-04-26 14:54:38,744 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745679275_giao-trinh.txt
2025-04-26 14:54:38,746 - main - INFO - Loading document: /app/storage/documents/3/1745679275_giao-trinh.txt
2025-04-26 14:54:38,746 - main - INFO - Using TextLoader
2025-04-26 14:54:38,749 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 14:54:38,750 - main - INFO - Document split into 34 chunks
2025-04-26 14:54:38,751 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:54:41,261 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:54:41,263 - main - INFO - Creating vector store at /app/vector_db/doc_12
2025-04-26 14:54:42,133 - main - INFO - Vector store created successfully for document 12
2025-04-26 14:54:42,133 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 14:54:42,151 - main - INFO - Integrating document ID: 12
2025-04-26 14:54:42,151 - main - INFO - Integrating document vectors for document ID: 12
2025-04-26 14:54:42,153 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:54:44,426 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:54:44,758 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:54:45,811 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:54:45,812 - main - INFO - Merging document vectors into main vector database
2025-04-26 14:54:45,848 - main - INFO - Saving merged vector database
2025-04-26 14:54:47,281 - main - INFO - Document vectors integrated successfully for document 12
2025-04-26 14:54:47,335 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 14:54:47,338 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 14:54:47,339 - main - INFO - Loading vector store...
2025-04-26 14:54:47,339 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 14:54:49,637 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 14:54:49,966 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 14:54:51,200 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 14:58:34,892 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '196'}
2025-04-26 14:58:34,893 - main - INFO - Raw request body length: 196
2025-04-26 14:58:34,893 - main - INFO - Used utf-8 encoding for request body
2025-04-26 14:58:34,893 - main - INFO - Parsed JSON: {'message': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3}
2025-04-26 14:58:34,894 - main - INFO - Extracted message: 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 14:58:34,894 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 14:58:34,894 - main - INFO - Initializing OpenAI model...
2025-04-26 14:58:34,894 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 14:58:34,895 - main - INFO - Creating OpenAI client...
2025-04-26 14:58:34,895 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:58:34,895 - main - INFO - Trying alternative initialization method
2025-04-26 14:58:34,895 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 14:58:34,896 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 14:58:34,896 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 14:58:34,897 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 14:58:34,985 - main - INFO - Found 3 relevant documents for query: ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 14:58:34,986 - main - INFO - Document 1: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nha...
2025-04-26 14:58:34,986 - main - INFO - Document 2: Với những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn ...
2025-04-26 14:58:34,986 - main - INFO - Document 3: Cùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu ...
2025-04-26 14:58:34,987 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 14:58:34,987 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nhau hành động, triển khai các dự án cụ thể để khu vực kinh tế tập thể tiếp tục phát triển, đóng góp vào sự thịnh vượng của đất nước trong tương lai.\n\nAnh Nhi\n\nVới những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn Minh Tuệ được kỳ vọng sẽ đóng góp tích cực vào sự phát triển của Tập đoàn và chiến lược chuyển đổi AI sẽ được triển khai hiệu quả, giúp nâng cao vị thế của công ty trên thị trường công nghệ trong tương lai.\n\nCùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu nhập trung bình cao vào 2030 và nước phát triển, thu nhập cao vào 2045. Nhà điều hành cũng tiếp tục tạo điều kiện thuận lợi, trong đó có việc cải cách thể chế, để các nhà đầu tư trong và ngoài nước kinh doanh hiệu quả tại Việt Nam.\n\nPhương Dung', 'query': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.09 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:12:51,688 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '196'}
2025-04-26 15:12:51,689 - main - INFO - Raw request body length: 196
2025-04-26 15:12:51,689 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:12:51,689 - main - INFO - Parsed JSON: {'message': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3}
2025-04-26 15:12:51,689 - main - INFO - Extracted message: 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 15:12:51,689 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:12:51,690 - main - INFO - Initializing OpenAI model...
2025-04-26 15:12:51,690 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:12:51,690 - main - INFO - Creating OpenAI client...
2025-04-26 15:12:51,690 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:12:51,691 - main - INFO - Trying alternative initialization method
2025-04-26 15:12:51,691 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:12:51,691 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:12:51,691 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:12:51,692 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:12:51,737 - main - INFO - Found 3 relevant documents for query: ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 15:12:51,738 - main - INFO - Document 1: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nha...
2025-04-26 15:12:51,738 - main - INFO - Document 2: Với những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn ...
2025-04-26 15:12:51,738 - main - INFO - Document 3: Cùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu ...
2025-04-26 15:12:51,739 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:12:51,739 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Cuối cùng, Phó Thủ tướng Nguyễn Chí Dũng kêu gọi các bộ, ngành, địa phương và cộng đồng HTX cùng nhau hành động, triển khai các dự án cụ thể để khu vực kinh tế tập thể tiếp tục phát triển, đóng góp vào sự thịnh vượng của đất nước trong tương lai.\n\nAnh Nhi\n\nVới những kỹ năng và kinh nghiệm dày dặn của mình, ông Đặng Tùng Sơn, ông Đặng Văn Tú và ông Nguyễn Minh Tuệ được kỳ vọng sẽ đóng góp tích cực vào sự phát triển của Tập đoàn và chiến lược chuyển đổi AI sẽ được triển khai hiệu quả, giúp nâng cao vị thế của công ty trên thị trường công nghệ trong tương lai.\n\nCùng với đó, Việt Nam đặt mục tiêu trở thành nước đang phát triển, có nền công nghiệp hiện đại, thu nhập trung bình cao vào 2030 và nước phát triển, thu nhập cao vào 2045. Nhà điều hành cũng tiếp tục tạo điều kiện thuận lợi, trong đó có việc cải cách thể chế, để các nhà đầu tư trong và ngoài nước kinh doanh hiệu quả tại Việt Nam.\n\nPhương Dung', 'query': 'ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:13:06,299 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '167'}
2025-04-26 15:13:06,299 - main - INFO - Raw request body length: 167
2025-04-26 15:13:06,300 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:13:06,300 - main - INFO - Parsed JSON: {'message': 'KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3}
2025-04-26 15:13:06,300 - main - INFO - Extracted message: 'KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 15:13:06,301 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:13:06,301 - main - INFO - Initializing OpenAI model...
2025-04-26 15:13:06,301 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:13:06,301 - main - INFO - Creating OpenAI client...
2025-04-26 15:13:06,302 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:13:06,302 - main - INFO - Trying alternative initialization method
2025-04-26 15:13:06,302 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:13:06,302 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:13:06,302 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:13:06,303 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:13:06,323 - main - INFO - Found 3 relevant documents for query: KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 15:13:06,324 - main - INFO - Document 1: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 15:13:06,324 - main - INFO - Document 2: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 15:13:06,325 - main - INFO - Document 3: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 15:13:06,325 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:13:06,326 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: CHỦ TỊCH\n\nPGS Ngô Tuấn Nghĩa\n\n6\n\nChương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nNội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.\n\n1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN\n\nTrong dòng chảy tư tưởng kinh tế của nhân loại kể từ thời kỳ cô đại cho tới ngày nay, do đặc thù trình độ phát triển ứng với mỗi giai đoạn lịch sử, mỗi nền sản xuất xã hội mà hình thành nhiều tư tưởng, trường phái lý luận về kinh tế khác nhau.\n\nCHỦ TỊCH\n\nPGS Ngô Tuấn Nghĩa\n\n6\n\nChương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nNội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.\n\n1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN\n\nTrong dòng chảy tư tưởng kinh tế của nhân loại kể từ thời kỳ cô đại cho tới ngày nay, do đặc thù trình độ phát triển ứng với mỗi giai đoạn lịch sử, mỗi nền sản xuất xã hội mà hình thành nhiều tư tưởng, trường phái lý luận về kinh tế khác nhau.\n\nCHỦ TỊCH\n\nPGS Ngô Tuấn Nghĩa\n\n6\n\nChương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nNội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.\n\n1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN\n\nTrong dòng chảy tư tưởng kinh tế của nhân loại kể từ thời kỳ cô đại cho tới ngày nay, do đặc thù trình độ phát triển ứng với mỗi giai đoạn lịch sử, mỗi nền sản xuất xã hội mà hình thành nhiều tư tưởng, trường phái lý luận về kinh tế khác nhau.', 'query': 'KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:14:48,777 - main - INFO - Reloading configuration settings...
2025-04-26 15:14:48,804 - main - INFO - Using provided configuration directly.
2025-04-26 15:14:48,805 - main - INFO - Reinitializing Gemini model...
2025-04-26 15:14:48,805 - main - INFO - Initializing Gemini model...
2025-04-26 15:14:48,805 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 15:14:48,805 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 15:15:00,838 - main - INFO - Gemini model test response: The connection appears to be working.  I have received your message and am able to respond.  Is there anything specific you would like me to do now?

2025-04-26 15:15:00,839 - main - INFO - Gemini model reinitialized successfully
2025-04-26 15:15:00,839 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 15:15:31,364 - main - INFO - Reloading configuration settings...
2025-04-26 15:15:31,381 - main - INFO - Using provided configuration directly.
2025-04-26 15:15:31,382 - main - INFO - Reinitializing Gemini model...
2025-04-26 15:15:31,382 - main - INFO - Initializing Gemini model...
2025-04-26 15:15:31,382 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 15:15:31,382 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 15:15:47,936 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-26 15:15:47,936 - main - INFO - Gemini model reinitialized successfully
2025-04-26 15:15:47,937 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 15:16:32,588 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '120'}
2025-04-26 15:16:32,589 - main - INFO - Raw request body length: 120
2025-04-26 15:16:32,589 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:16:32,590 - main - INFO - Parsed JSON: {'message': 'Mặc dù có sự đa dạng về nội hàm lý luận', 'user_id': 3}
2025-04-26 15:16:32,590 - main - INFO - Extracted message: 'Mặc dù có sự đa dạng về nội hàm lý luận', user_id: 3
2025-04-26 15:16:32,626 - main - INFO - Found 3 relevant documents for query: Mặc dù có sự đa dạng về nội hàm lý luận
2025-04-26 15:16:32,626 - main - INFO - Document 1: Dự kiến Luật sửa đổi, bổ sung 4 luật liên quan đầu tư, quy hoạch sẽ trình Quốc hội xem xét, thảo luậ...
2025-04-26 15:16:32,627 - main - INFO - Document 2: Mặc dù xu hướng giảm lạm phát diễn ra trên diện rộng ở Việt Nam, áp lực giá vẫn chưa hoàn toàn mất đ...
2025-04-26 15:16:32,627 - main - INFO - Document 3: Dự kiến, Quốc hội sẽ xem xét, thảo luận dự thảo Luật Thuế tiêu thụ đặc biệt (sửa đổi) tại kỳ họp thứ...
2025-04-26 15:16:38,514 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:16:38,516 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Mặc dù có sự đa dạng về nội hàm lý luận', 'processing_time': '5.93 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:17:03,993 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '120'}
2025-04-26 15:17:03,994 - main - INFO - Raw request body length: 120
2025-04-26 15:17:03,995 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:17:03,995 - main - INFO - Parsed JSON: {'message': 'Mặc dù có sự đa dạng về nội hàm lý luận', 'user_id': 3}
2025-04-26 15:17:03,995 - main - INFO - Extracted message: 'Mặc dù có sự đa dạng về nội hàm lý luận', user_id: 3
2025-04-26 15:17:04,011 - main - INFO - Found 3 relevant documents for query: Mặc dù có sự đa dạng về nội hàm lý luận
2025-04-26 15:17:04,011 - main - INFO - Document 1: Dự kiến Luật sửa đổi, bổ sung 4 luật liên quan đầu tư, quy hoạch sẽ trình Quốc hội xem xét, thảo luậ...
2025-04-26 15:17:04,012 - main - INFO - Document 2: Mặc dù xu hướng giảm lạm phát diễn ra trên diện rộng ở Việt Nam, áp lực giá vẫn chưa hoàn toàn mất đ...
2025-04-26 15:17:04,012 - main - INFO - Document 3: Dự kiến, Quốc hội sẽ xem xét, thảo luận dự thảo Luật Thuế tiêu thụ đặc biệt (sửa đổi) tại kỳ họp thứ...
2025-04-26 15:17:09,203 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:17:09,204 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Mặc dù có sự đa dạng về nội hàm lý luận', 'processing_time': '5.21 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:18:18,920 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 15:18:18,921 - main - INFO - Raw request body length: 229
2025-04-26 15:18:18,921 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:18:18,922 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3}
2025-04-26 15:18:18,922 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:18:18,956 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:18:18,957 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:18:18,957 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:18:18,957 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:18:28,936 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:18:28,936 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX..."\n', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '10.01 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:18:55,391 - main - INFO - Reloading configuration settings...
2025-04-26 15:18:55,408 - main - INFO - Using provided configuration directly.
2025-04-26 15:18:55,408 - main - INFO - Reinitializing OpenAI model...
2025-04-26 15:18:55,409 - main - INFO - Initializing OpenAI model...
2025-04-26 15:18:55,409 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:18:55,410 - main - INFO - Creating OpenAI client...
2025-04-26 15:18:55,411 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:18:55,411 - main - INFO - Trying alternative initialization method
2025-04-26 15:18:55,411 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:18:55,412 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:18:55,412 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:18:55,413 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:18:55,413 - main - WARNING - OpenAI model reinitialization returned None
2025-04-26 15:19:27,101 - main - INFO - Reloading configuration settings...
2025-04-26 15:19:27,117 - main - INFO - Using provided configuration directly.
2025-04-26 15:19:27,118 - main - INFO - Reinitializing OpenAI model...
2025-04-26 15:19:27,118 - main - INFO - Initializing OpenAI model...
2025-04-26 15:19:27,118 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:19:27,119 - main - INFO - Creating OpenAI client...
2025-04-26 15:19:27,119 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:19:27,119 - main - INFO - Trying alternative initialization method
2025-04-26 15:19:27,120 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:19:27,120 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:19:27,120 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:19:27,121 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:19:27,121 - main - WARNING - OpenAI model reinitialization returned None
2025-04-26 15:20:00,713 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 15:20:00,713 - main - INFO - Raw request body length: 229
2025-04-26 15:20:00,713 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:20:00,714 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3}
2025-04-26 15:20:00,714 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:20:00,714 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:20:00,714 - main - INFO - Initializing OpenAI model...
2025-04-26 15:20:00,715 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:20:00,715 - main - INFO - Creating OpenAI client...
2025-04-26 15:20:00,715 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:20:00,715 - main - INFO - Trying alternative initialization method
2025-04-26 15:20:00,716 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:20:00,716 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:20:00,716 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:20:00,717 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:20:00,735 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:20:00,735 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:20:00,736 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:20:00,736 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:20:00,736 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:20:00,737 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:21:16,142 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '172'}
2025-04-26 15:21:16,143 - main - INFO - Raw request body length: 172
2025-04-26 15:21:16,143 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:21:16,144 - main - INFO - Parsed JSON: {'message': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu', 'user_id': 3}
2025-04-26 15:21:16,144 - main - INFO - Extracted message: 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu', user_id: 3
2025-04-26 15:21:16,144 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:21:16,144 - main - INFO - Initializing OpenAI model...
2025-04-26 15:21:16,145 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:21:16,145 - main - INFO - Creating OpenAI client...
2025-04-26 15:21:16,145 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:21:16,145 - main - INFO - Trying alternative initialization method
2025-04-26 15:21:16,146 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:21:16,146 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:21:16,146 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:21:16,146 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:21:16,176 - main - INFO - Found 3 relevant documents for query: Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu
2025-04-26 15:21:16,177 - main - INFO - Document 1: “Các nền kinh tế mới nổi ở khu vực châu Á vẫn là đầu tàu chính của kinh tế toàn cầu”, ông Gourinchas...
2025-04-26 15:21:16,177 - main - INFO - Document 2: Với những nỗ lực không ngừng nghỉ, ưu tiên hỗ trợ doanh nghiệp vượt qua khó khăn về nguồn vốn, nhân ...
2025-04-26 15:21:16,178 - main - INFO - Document 3: Riêng với TikTok, khoản đầu tư này không chỉ củng cố vị thế tại Đông Nam Á mà còn giúp nền tảng giảm...
2025-04-26 15:21:16,178 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:21:16,179 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: “Các nền kinh tế mới nổi ở khu vực châu Á vẫn là đầu tàu chính của kinh tế toàn cầu”, ông Gourinchas nhấn mạnh.\n\nVới những nỗ lực không ngừng nghỉ, ưu tiên hỗ trợ doanh nghiệp vượt qua khó khăn về nguồn vốn, nhân lực và mở rộng thị trường, tỉnh Quảng Ninh luôn được cộng đồng doanh nghiệp, nhà đầu tư đánh giá cao và vững tin đồng hành cùng tỉnh trong thực hiện các mục tiêu phát triển kinh tế - xã hội.\n\nRiêng với TikTok, khoản đầu tư này không chỉ củng cố vị thế tại Đông Nam Á mà còn giúp nền tảng giảm thiểu rủi ro địa chính trị, đảm bảo rằng dù có gặp trở ngại ở một số thị trường, hoạt động kinh doanh của họ vẫn có thể phát triển mạnh mẽ ở những nơi khác.', 'query': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:21:37,011 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '141'}
2025-04-26 15:21:37,011 - main - INFO - Raw request body length: 141
2025-04-26 15:21:37,012 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:21:37,012 - main - INFO - Parsed JSON: {'message': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính:', 'user_id': 3}
2025-04-26 15:21:37,012 - main - INFO - Extracted message: 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính:', user_id: 3
2025-04-26 15:21:37,012 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:21:37,012 - main - INFO - Initializing OpenAI model...
2025-04-26 15:21:37,013 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:21:37,013 - main - INFO - Creating OpenAI client...
2025-04-26 15:21:37,013 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:21:37,013 - main - INFO - Trying alternative initialization method
2025-04-26 15:21:37,014 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:21:37,014 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:21:37,014 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:21:37,014 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:21:37,044 - main - INFO - Found 3 relevant documents for query: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính:
2025-04-26 15:21:37,044 - main - INFO - Document 1: "Kết quả này không chỉ là những con số; chúng tô điểm một bức tranh toàn cảnh nêu bật sự phát triển ...
2025-04-26 15:21:37,045 - main - INFO - Document 2: Khi đó, nhà mạng này được lựa chọn bởi có tình hình tài chính và kết quả kinh doanh tốt trong 3 doan...
2025-04-26 15:21:37,045 - main - INFO - Document 3: Doanh nghiệp cũng đồng loạt triển khai các dự án chiến như nâng cao năng lực quản trị rủi ro, triển ...
2025-04-26 15:21:37,046 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:21:37,046 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kết quả này không chỉ là những con số; chúng tô điểm một bức tranh toàn cảnh nêu bật sự phát triển của Việt Nam như một trung tâm kinh doanh chiến lược", Chủ tịch EuroCham Bruno Jaspaert bình luận.\n\nViễn Thông\n\nKhi đó, nhà mạng này được lựa chọn bởi có tình hình tài chính và kết quả kinh doanh tốt trong 3 doanh nghiệp viễn thông. Thực tế, đến nay, so với các doanh nghiệp khác trên thị trường, MobiFone cũng ít chịu áp lực về tài chính do tỷ lệ vay nợ thấp.\n\nAnh Tú\n\nDoanh nghiệp cũng đồng loạt triển khai các dự án chiến như nâng cao năng lực quản trị rủi ro, triển khai hệ thống quản trị nhân sự tập trung, đẩy mạnh chuyển đổi số toàn diện, chuẩn hóa quy trình công bố thông tin, công bố đồng thời bằng tiếng Anh từ 2025...\n\n"Đây là kết quả kinh doanh ấn tượng trong bối cảnh nền kinh tế còn nhiều thách thức, cho thấy doanh nghiệp đã thích ứng tốt và tối ưu hóa hoạt động sản xuất kinh doanh cốt lõi", đại diện Gelex cho biết.\n\nLan Anh', 'query': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính:', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:29:54,730 - main - INFO - Processing document ID: 13, File path: documents/3/1745679309_giao-trinh.txt
2025-04-26 15:29:54,730 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745679309_giao-trinh.txt
2025-04-26 15:29:54,733 - main - INFO - Loading document: /app/storage/documents/3/1745679309_giao-trinh.txt
2025-04-26 15:29:54,733 - main - INFO - Using TextLoader
2025-04-26 15:29:54,737 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 15:29:54,743 - main - INFO - Document split into 34 chunks
2025-04-26 15:29:54,744 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 15:29:57,403 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 15:29:57,406 - main - INFO - Creating vector store at /app/vector_db/doc_13
2025-04-26 15:29:58,324 - main - INFO - Vector store created successfully for document 13
2025-04-26 15:29:58,324 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 15:29:58,348 - main - INFO - Integrating document ID: 13
2025-04-26 15:29:58,348 - main - INFO - Integrating document vectors for document ID: 13
2025-04-26 15:29:58,350 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 15:30:00,605 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 15:30:00,932 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 15:30:02,900 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 15:30:02,902 - main - INFO - Merging document vectors into main vector database
2025-04-26 15:30:02,938 - main - INFO - Saving merged vector database
2025-04-26 15:30:04,567 - main - INFO - Document vectors integrated successfully for document 13
2025-04-26 15:30:04,614 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 15:30:04,617 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 15:30:04,618 - main - INFO - Loading vector store...
2025-04-26 15:30:04,620 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 15:30:07,358 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 15:30:07,680 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 15:30:08,694 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 15:30:48,062 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 15:30:48,063 - main - INFO - Raw request body length: 229
2025-04-26 15:30:48,063 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:30:48,063 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3}
2025-04-26 15:30:48,063 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:30:48,064 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:30:48,064 - main - INFO - Initializing OpenAI model...
2025-04-26 15:30:48,064 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:30:48,064 - main - INFO - Creating OpenAI client...
2025-04-26 15:30:48,065 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:30:48,065 - main - INFO - Trying alternative initialization method
2025-04-26 15:30:48,065 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:30:48,065 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:30:48,065 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:30:48,066 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:30:48,083 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:30:48,084 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:30:48,084 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:30:48,085 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:30:48,085 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:30:48,085 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:31:02,234 - main - INFO - Reloading configuration settings...
2025-04-26 15:31:02,250 - main - INFO - Using provided configuration directly.
2025-04-26 15:31:02,250 - main - INFO - Reinitializing Gemini model...
2025-04-26 15:31:02,251 - main - INFO - Initializing Gemini model...
2025-04-26 15:31:02,251 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 15:31:02,251 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 15:31:15,201 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you'd like me to do now?

2025-04-26 15:31:15,202 - main - INFO - Gemini model reinitialized successfully
2025-04-26 15:31:15,202 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 15:31:46,910 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 15:31:46,910 - main - INFO - Raw request body length: 229
2025-04-26 15:31:46,911 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:31:46,911 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3}
2025-04-26 15:31:46,911 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:31:46,928 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:31:46,929 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:31:46,929 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:31:46,930 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:31:56,639 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:31:56,639 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX..."\n', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '9.73 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:44:00,788 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '245'}
2025-04-26 15:44:00,789 - main - INFO - Raw request body length: 245
2025-04-26 15:44:00,789 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:44:00,789 - main - INFO - Parsed JSON: {'message': 'mô hình faiss thì trả lời được nhưng khi tôi đùng model từ API (google,openai) thì chat bot báo không tìm thấy tài liệu', 'user_id': 3}
2025-04-26 15:44:00,790 - main - INFO - Extracted message: 'mô hình faiss thì trả lời được nhưng khi tôi đùng model từ API (google,openai) thì chat bot báo không tìm thấy tài liệu', user_id: 3
2025-04-26 15:44:00,875 - main - INFO - Found 3 relevant documents for query: mô hình faiss thì trả lời được nhưng khi tôi đùng model từ API (google,openai) thì chat bot báo không tìm thấy tài liệu
2025-04-26 15:44:00,876 - main - INFO - Document 1: Vào tháng 9, Google thắt chặt quy định đối với cuộc thảo luận trên diễn đàn nội bộ Memegen, hạn chế ...
2025-04-26 15:44:00,876 - main - INFO - Document 2: Trong khi đó, bộ phận AI của Alphabet gần đây ra mắt mô hình LMM mới nhất Gemini và đang dần tích hợ...
2025-04-26 15:44:00,877 - main - INFO - Document 3: TITLE: Nhu cầu năng lượng của AI đang "nằm ngoài tầm kiểm soát"

URL: https://vneconomy.vn/nhu-cau-n...
2025-04-26 15:44:22,314 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:44:22,315 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Các chatbot AI bắt đầu phổ biến sau khi OpenAI phát hành ChatGPT vào cuối năm 2022. Từ đó đến nay, thung lũng Silicon đã không ngừng phát hành các mô hình ngôn ngữ lớn." Tôi không tìm thấy thông tin liên quan đến việc so sánh hiệu suất tìm kiếm giữa mô hình Faiss và API của Google/OpenAI trong cơ sở dữ liệu.\n', 'query': 'mô hình faiss thì trả lời được nhưng khi tôi đùng model từ API (google,openai) thì chat bot báo không tìm thấy tài liệu', 'processing_time': '21.52 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:44:32,374 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 15:44:32,375 - main - INFO - Raw request body length: 229
2025-04-26 15:44:32,375 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:44:32,376 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3}
2025-04-26 15:44:32,376 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:44:32,396 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:44:32,397 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:44:32,397 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:44:32,397 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:45:05,806 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:45:05,807 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỷ thứ XIX..."\n', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '33.43 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:52:30,456 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '319'}
2025-04-26 15:52:30,457 - main - INFO - Raw request body length: 319
2025-04-26 15:52:30,457 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:52:30,458 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:52:30,458 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:52:30,492 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:52:30,492 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:52:30,493 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:52:30,493 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:52:58,595 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 15:52:58,595 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX..."\n', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '28.14 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 15:53:04,674 - main - INFO - Reloading configuration settings...
2025-04-26 15:53:04,693 - main - INFO - Using provided configuration directly.
2025-04-26 15:53:04,693 - main - INFO - Reinitializing OpenAI model...
2025-04-26 15:53:04,693 - main - INFO - Initializing OpenAI model...
2025-04-26 15:53:04,694 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:53:04,694 - main - INFO - Creating OpenAI client...
2025-04-26 15:53:04,694 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:53:04,695 - main - INFO - Trying alternative initialization method
2025-04-26 15:53:04,695 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:53:04,695 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:53:04,695 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:53:04,699 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:53:04,699 - main - WARNING - OpenAI model reinitialization returned None
2025-04-26 15:53:32,257 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '319'}
2025-04-26 15:53:32,258 - main - INFO - Raw request body length: 319
2025-04-26 15:53:32,258 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:53:32,259 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:53:32,259 - main - INFO - Extracted message: 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', user_id: 3
2025-04-26 15:53:32,259 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:53:32,259 - main - INFO - Initializing OpenAI model...
2025-04-26 15:53:32,260 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:53:32,260 - main - INFO - Creating OpenAI client...
2025-04-26 15:53:32,260 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:53:32,261 - main - INFO - Trying alternative initialization method
2025-04-26 15:53:32,261 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:53:32,261 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:53:32,261 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:53:32,262 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:53:32,284 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII
2025-04-26 15:53:32,284 - main - INFO - Document 1: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:53:32,285 - main - INFO - Document 2: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:53:32,285 - main - INFO - Document 3: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở ...
2025-04-26 15:53:32,285 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:53:32,286 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: triền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.\n\ntriền cùa nền sản xuất tư bản chủ nghĩa trong thời kỳ tiếp theo đã làm cho chủ nghĩa trọng nông trở nên lạc hậu và dân nhường vị trí cho lý luận kinh tế chính trị cổ điển Anh.\n\nKinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII đến nửa đầu thế kỳ thứ XIX, mở đầu là các quan điểm lý luận của W, tiếp đến là A và kết thúc ở hộ thống lý luận có nhiều giá trị khoa học của D.', 'query': 'Kinh tế chính trị cồ điển Anh được hình thành và phát triền trong thời kỳ từ cuối thế kỷ thứ XVIII', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:54:37,732 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '266'}
2025-04-26 15:54:37,733 - main - INFO - Raw request body length: 266
2025-04-26 15:54:37,733 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:54:37,734 - main - INFO - Parsed JSON: {'message': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:54:37,734 - main - INFO - Extracted message: 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', user_id: 3
2025-04-26 15:54:37,734 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:54:37,735 - main - INFO - Initializing OpenAI model...
2025-04-26 15:54:37,735 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:54:37,735 - main - INFO - Creating OpenAI client...
2025-04-26 15:54:37,735 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:54:37,736 - main - INFO - Trying alternative initialization method
2025-04-26 15:54:37,736 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:54:37,736 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:54:37,736 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:54:37,737 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:54:37,771 - main - INFO - Found 3 relevant documents for query: Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học
2025-04-26 15:54:37,772 - main - INFO - Document 1: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 15:54:37,772 - main - INFO - Document 2: Bên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doa...
2025-04-26 15:54:37,773 - main - INFO - Document 3: Dựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả ...
2025-04-26 15:54:37,773 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:54:37,774 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nBên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doanh thu trên phòng cao hơn đáng kể so với cùng kỳ năm trước./.\n\nDựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả hơn nữa trong các lĩnh vực kinh tế, thương mại, nông nghiệp...', 'query': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:54:57,976 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '266'}
2025-04-26 15:54:57,976 - main - INFO - Raw request body length: 266
2025-04-26 15:54:57,976 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:54:57,977 - main - INFO - Parsed JSON: {'message': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:54:57,977 - main - INFO - Extracted message: 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', user_id: 3
2025-04-26 15:54:57,977 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:54:57,977 - main - INFO - Initializing OpenAI model...
2025-04-26 15:54:57,978 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:54:57,978 - main - INFO - Creating OpenAI client...
2025-04-26 15:54:57,978 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:54:57,978 - main - INFO - Trying alternative initialization method
2025-04-26 15:54:57,979 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:54:57,979 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:54:57,979 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:54:57,980 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:54:57,996 - main - INFO - Found 3 relevant documents for query: Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học
2025-04-26 15:54:57,996 - main - INFO - Document 1: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 15:54:57,996 - main - INFO - Document 2: Bên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doa...
2025-04-26 15:54:57,997 - main - INFO - Document 3: Dựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả ...
2025-04-26 15:54:57,997 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:54:57,998 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nBên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doanh thu trên phòng cao hơn đáng kể so với cùng kỳ năm trước./.\n\nDựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả hơn nữa trong các lĩnh vực kinh tế, thương mại, nông nghiệp...', 'query': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:55:10,359 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '266'}
2025-04-26 15:55:10,359 - main - INFO - Raw request body length: 266
2025-04-26 15:55:10,359 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:55:10,360 - main - INFO - Parsed JSON: {'message': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'user_id': 3, 'document_ids': [12], 'documentIds': [12], 'context_document_ids': [12], 'support_doc_ids': [12]}
2025-04-26 15:55:10,360 - main - INFO - Extracted message: 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', user_id: 3
2025-04-26 15:55:10,360 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:55:10,360 - main - INFO - Initializing OpenAI model...
2025-04-26 15:55:10,361 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:55:10,361 - main - INFO - Creating OpenAI client...
2025-04-26 15:55:10,361 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:55:10,361 - main - INFO - Trying alternative initialization method
2025-04-26 15:55:10,362 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:55:10,362 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:55:10,362 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:55:10,363 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:55:10,379 - main - INFO - Found 3 relevant documents for query: Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học
2025-04-26 15:55:10,379 - main - INFO - Document 1: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 15:55:10,380 - main - INFO - Document 2: Bên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doa...
2025-04-26 15:55:10,380 - main - INFO - Document 3: Dựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả ...
2025-04-26 15:55:10,380 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:55:10,381 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nBên cạnh đó, thị trường khách sạn tại Hà Nội và TP. Hồ Chí Minh ghi nhận hoạt động cải thiện với doanh thu trên phòng cao hơn đáng kể so với cùng kỳ năm trước./.\n\nDựa trên không gian hợp tác rộng rãi, hai bên tiếp tục có cơ hội trao đổi đẩy mạnh hợp tác hiệu quả hơn nữa trong các lĩnh vực kinh tế, thương mại, nông nghiệp...', 'query': 'Với quan niệm như vậy, lần đầu tiên trong lịch sử của kinh tế chính trị học', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:55:22,332 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '250'}
2025-04-26 15:55:22,333 - main - INFO - Raw request body length: 250
2025-04-26 15:55:22,333 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:55:22,334 - main - INFO - Parsed JSON: {'message': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', 'user_id': 3, 'document_ids': [12], 'documentIds': [12], 'context_document_ids': [12], 'support_doc_ids': [12]}
2025-04-26 15:55:22,334 - main - INFO - Extracted message: 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', user_id: 3
2025-04-26 15:55:22,334 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:55:22,334 - main - INFO - Initializing OpenAI model...
2025-04-26 15:55:22,334 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:55:22,335 - main - INFO - Creating OpenAI client...
2025-04-26 15:55:22,335 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:55:22,335 - main - INFO - Trying alternative initialization method
2025-04-26 15:55:22,335 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:55:22,336 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:55:22,336 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:55:22,336 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:55:22,369 - main - INFO - Found 3 relevant documents for query: Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,
2025-04-26 15:55:22,370 - main - INFO - Document 1: Theo đại diện Ashima, nhà hàng không chỉ tiên phong trong nghệ thuật lẩu nấm mà còn là điểm đến của ...
2025-04-26 15:55:22,370 - main - INFO - Document 2: Theo ông Sơn, toàn quốc còn khoảng 81.000 cá nhân, chủ hộ kinh doanh nợ thuế từ 50 triệu đồng. Mức n...
2025-04-26 15:55:22,370 - main - INFO - Document 3: “Theo những gì Thống đốc Phan nói, PBOC thận trọng với khả năng tăng giá một chiều của nhân dân tệ. ...
2025-04-26 15:55:22,371 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:55:22,371 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Theo đại diện Ashima, nhà hàng không chỉ tiên phong trong nghệ thuật lẩu nấm mà còn là điểm đến của người yêu thích ẩm thực dưỡng sinh. "Với 15 năm giữ vững vị thế dẫn đầu, Ashima cam kết tiếp tục mang đến những trải nghiệm ẩm thực trọn vẹn, giúp thực khách tìm lại sự cân bằng và tận hưởng khoảnh khắc đáng nhớ bên gia đình, bạn bè", vị đại diện cho biết.\n\nĐan Minh\n\nTheo ông Sơn, toàn quốc còn khoảng 81.000 cá nhân, chủ hộ kinh doanh nợ thuế từ 50 triệu đồng. Mức này, theo ông Sơn tương đương với nhiều nước và theo kinh nghiệm quốc tế là phù hợp. Ông cũng khẳng định, tạm hoãn xuất cảnh người nợ thuế "là biện pháp hữu hiện trong quản lý thuế". Biện pháp này để đảm bảo người dân và chủ hộ kinh doanh thực hiện quyền và nghĩa vụ nộp thuế cho Nhà nước.\n\nÔng Hoàng Thái Sơn, Vụ trưởng Pháp chế Bộ Tài chính. Ảnh:Media Quốc hội\n\nTheo Luật Quản lý thuế 2019 và Nghị định 126/2020, thủ trưởng các cơ quan thuế, hải quan có quyền ra quyết định hoãn xuất cảnh với cá nhân, đại diện doanh nghiệp chưa hoàn thành nghĩa vụ thuế. Tuy nhiên, các quy định hiện nay không nêu ngưỡng nợ cụ thể khi áp dụng biện pháp cưỡng chế này, tứcnợ thuế quá hạn1 đồng cũng có thể bị tạm hoãn xuất cảnh.\n\n“Theo những gì Thống đốc Phan nói, PBOC thận trọng với khả năng tăng giá một chiều của nhân dân tệ. Điều đó có nghĩa rằng biện pháp để kiểm soát xu hướng tăng giá của nhân dân tệ sẽ sẵn sàng được triển khai nếu cần”, ông Ken nhận định với Bloomberg.', 'query': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:56:33,153 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '250'}
2025-04-26 15:56:33,153 - main - INFO - Raw request body length: 250
2025-04-26 15:56:33,154 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:56:33,154 - main - INFO - Parsed JSON: {'message': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:56:33,154 - main - INFO - Extracted message: 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', user_id: 3
2025-04-26 15:56:33,155 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:56:33,155 - main - INFO - Initializing OpenAI model...
2025-04-26 15:56:33,155 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:56:33,155 - main - INFO - Creating OpenAI client...
2025-04-26 15:56:33,156 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:56:33,156 - main - INFO - Trying alternative initialization method
2025-04-26 15:56:33,156 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:56:33,157 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:56:33,157 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:56:33,157 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:56:33,173 - main - INFO - Found 3 relevant documents for query: Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,
2025-04-26 15:56:33,174 - main - INFO - Document 1: Theo đại diện Ashima, nhà hàng không chỉ tiên phong trong nghệ thuật lẩu nấm mà còn là điểm đến của ...
2025-04-26 15:56:33,174 - main - INFO - Document 2: Theo ông Sơn, toàn quốc còn khoảng 81.000 cá nhân, chủ hộ kinh doanh nợ thuế từ 50 triệu đồng. Mức n...
2025-04-26 15:56:33,174 - main - INFO - Document 3: “Theo những gì Thống đốc Phan nói, PBOC thận trọng với khả năng tăng giá một chiều của nhân dân tệ. ...
2025-04-26 15:56:33,175 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:56:33,175 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Theo đại diện Ashima, nhà hàng không chỉ tiên phong trong nghệ thuật lẩu nấm mà còn là điểm đến của người yêu thích ẩm thực dưỡng sinh. "Với 15 năm giữ vững vị thế dẫn đầu, Ashima cam kết tiếp tục mang đến những trải nghiệm ẩm thực trọn vẹn, giúp thực khách tìm lại sự cân bằng và tận hưởng khoảnh khắc đáng nhớ bên gia đình, bạn bè", vị đại diện cho biết.\n\nĐan Minh\n\nTheo ông Sơn, toàn quốc còn khoảng 81.000 cá nhân, chủ hộ kinh doanh nợ thuế từ 50 triệu đồng. Mức này, theo ông Sơn tương đương với nhiều nước và theo kinh nghiệm quốc tế là phù hợp. Ông cũng khẳng định, tạm hoãn xuất cảnh người nợ thuế "là biện pháp hữu hiện trong quản lý thuế". Biện pháp này để đảm bảo người dân và chủ hộ kinh doanh thực hiện quyền và nghĩa vụ nộp thuế cho Nhà nước.\n\nÔng Hoàng Thái Sơn, Vụ trưởng Pháp chế Bộ Tài chính. Ảnh:Media Quốc hội\n\nTheo Luật Quản lý thuế 2019 và Nghị định 126/2020, thủ trưởng các cơ quan thuế, hải quan có quyền ra quyết định hoãn xuất cảnh với cá nhân, đại diện doanh nghiệp chưa hoàn thành nghĩa vụ thuế. Tuy nhiên, các quy định hiện nay không nêu ngưỡng nợ cụ thể khi áp dụng biện pháp cưỡng chế này, tứcnợ thuế quá hạn1 đồng cũng có thể bị tạm hoãn xuất cảnh.\n\n“Theo những gì Thống đốc Phan nói, PBOC thận trọng với khả năng tăng giá một chiều của nhân dân tệ. Điều đó có nghĩa rằng biện pháp để kiểm soát xu hướng tăng giá của nhân dân tệ sẽ sẵn sàng được triển khai nếu cần”, ông Ken nhận định với Bloomberg.', 'query': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất,', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:56:50,456 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '255'}
2025-04-26 15:56:50,457 - main - INFO - Raw request body length: 255
2025-04-26 15:56:50,457 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:56:50,458 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:56:50,458 - main - INFO - Extracted message: 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', user_id: 3
2025-04-26 15:56:50,458 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:56:50,459 - main - INFO - Initializing OpenAI model...
2025-04-26 15:56:50,459 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:56:50,459 - main - INFO - Creating OpenAI client...
2025-04-26 15:56:50,459 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:56:50,460 - main - INFO - Trying alternative initialization method
2025-04-26 15:56:50,460 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:56:50,460 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:56:50,460 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:56:50,461 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:56:50,480 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất
2025-04-26 15:56:50,480 - main - INFO - Document 1: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây ...
2025-04-26 15:56:50,481 - main - INFO - Document 2: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây ...
2025-04-26 15:56:50,481 - main - INFO - Document 3: Đặc biệt, Uỷ ban Kinh tế đề nghị tăng cường điều chỉnh chính sách tài khóa phù hợp, hiệu quả hơn tro...
2025-04-26 15:56:50,482 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:56:50,482 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây là điều thường xuyên thấy sau những lần Mỹ thay đổi chính sách thương mại khiến các nhà bán lẻ của Mỹ tăng cường tích trữ tồn kho. Dự báo kết quả kinh doanh quý II không bị ảnh hưởng nhiều và sẽ đóng góp vào bức tranh chung hoạt động kinh doanh cả năm.\n\nTùng Linh\n\nNgoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây là điều thường xuyên thấy sau những lần Mỹ thay đổi chính sách thương mại khiến các nhà bán lẻ của Mỹ tăng cường tích trữ tồn kho. Dự báo kết quả kinh doanh quý II không bị ảnh hưởng nhiều và sẽ đóng góp vào bức tranh chung hoạt động kinh doanh cả năm.\n\nThanh Thủy\n\nĐặc biệt, Uỷ ban Kinh tế đề nghị tăng cường điều chỉnh chính sách tài khóa phù hợp, hiệu quả hơn trong năm 2025 để thích ứng với những thách thức của toàn cầu; tập trung tháo gỡ khó khăn, vực dậy thị trường vốn, tạo điều kiện thuận lợi cho người dân và doanh nghiệp vay vốn để phục hồi, phát triển sản xuất, kinh doanh; thực hiện chính sách tiền tệ chủ động, linh hoạt, kịp thời, hiệu quả…/.', 'query': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:57:54,302 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '255'}
2025-04-26 15:57:54,303 - main - INFO - Raw request body length: 255
2025-04-26 15:57:54,303 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:57:54,303 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:57:54,303 - main - INFO - Extracted message: 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', user_id: 3
2025-04-26 15:57:54,304 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:57:54,304 - main - INFO - Initializing OpenAI model...
2025-04-26 15:57:54,304 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:57:54,304 - main - INFO - Creating OpenAI client...
2025-04-26 15:57:54,304 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:57:54,305 - main - INFO - Trying alternative initialization method
2025-04-26 15:57:54,305 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:57:54,305 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:57:54,306 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:57:54,306 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:57:54,324 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất
2025-04-26 15:57:54,325 - main - INFO - Document 1: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây ...
2025-04-26 15:57:54,325 - main - INFO - Document 2: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây ...
2025-04-26 15:57:54,325 - main - INFO - Document 3: Đặc biệt, Uỷ ban Kinh tế đề nghị tăng cường điều chỉnh chính sách tài khóa phù hợp, hiệu quả hơn tro...
2025-04-26 15:57:54,326 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:57:54,326 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Ngoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây là điều thường xuyên thấy sau những lần Mỹ thay đổi chính sách thương mại khiến các nhà bán lẻ của Mỹ tăng cường tích trữ tồn kho. Dự báo kết quả kinh doanh quý II không bị ảnh hưởng nhiều và sẽ đóng góp vào bức tranh chung hoạt động kinh doanh cả năm.\n\nTùng Linh\n\nNgoài ra, theo ông Hiếu, trong thời gian hoãn thuế 90 ngày, hoạt động xuất nhập khẩu sẽ ấm lên. Đây là điều thường xuyên thấy sau những lần Mỹ thay đổi chính sách thương mại khiến các nhà bán lẻ của Mỹ tăng cường tích trữ tồn kho. Dự báo kết quả kinh doanh quý II không bị ảnh hưởng nhiều và sẽ đóng góp vào bức tranh chung hoạt động kinh doanh cả năm.\n\nThanh Thủy\n\nĐặc biệt, Uỷ ban Kinh tế đề nghị tăng cường điều chỉnh chính sách tài khóa phù hợp, hiệu quả hơn trong năm 2025 để thích ứng với những thách thức của toàn cầu; tập trung tháo gỡ khó khăn, vực dậy thị trường vốn, tạo điều kiện thuận lợi cho người dân và doanh nghiệp vay vốn để phục hồi, phát triển sản xuất, kinh doanh; thực hiện chính sách tiền tệ chủ động, linh hoạt, kịp thời, hiệu quả…/.', 'query': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:58:28,568 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '215'}
2025-04-26 15:58:28,569 - main - INFO - Raw request body length: 215
2025-04-26 15:58:28,569 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:58:28,570 - main - INFO - Parsed JSON: {'message': 'hỉ đạo biên soạn Đồng chí Võ Văn Thưởng', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:58:28,570 - main - INFO - Extracted message: 'hỉ đạo biên soạn Đồng chí Võ Văn Thưởng', user_id: 3
2025-04-26 15:58:28,570 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:58:28,570 - main - INFO - Initializing OpenAI model...
2025-04-26 15:58:28,571 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:58:28,571 - main - INFO - Creating OpenAI client...
2025-04-26 15:58:28,571 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:58:28,571 - main - INFO - Trying alternative initialization method
2025-04-26 15:58:28,572 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:58:28,572 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:58:28,572 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:58:28,573 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:58:28,593 - main - INFO - Found 3 relevant documents for query: hỉ đạo biên soạn Đồng chí Võ Văn Thưởng
2025-04-26 15:58:28,593 - main - INFO - Document 1: Trong bối cảnh đầy biến động này, sự chủ động, linh hoạt và sáng tạo trong chiến lược kinh doanh sẽ ...
2025-04-26 15:58:28,593 - main - INFO - Document 2: Tiếp tục đóng góp hoàn thiện văn kiện Đại hội XIV của Đảng
2025-04-26 15:58:28,594 - main - INFO - Document 3: Qua đó, tạo điều kiện thuận lợi cho cả cơ quan tài chính và các đơn vị sử dụng ngân sách; rút ngắn t...
2025-04-26 15:58:28,594 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:58:28,595 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Trong bối cảnh đầy biến động này, sự chủ động, linh hoạt và sáng tạo trong chiến lược kinh doanh sẽ giúp các DN Việt Nam vượt qua thách thức, duy trì và phát triển bền vững trên thị trường quốc tế.\n\nVân Hương (thực hiện)\n\nTiếp tục đóng góp hoàn thiện văn kiện Đại hội XIV của Đảng\n\nQua đó, tạo điều kiện thuận lợi cho cả cơ quan tài chính và các đơn vị sử dụng ngân sách; rút ngắn thời gian tổng hợp, lập quyết toán ngân sách.\n\nViệt Vũ', 'query': 'hỉ đạo biên soạn Đồng chí Võ Văn Thưởng', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:59:18,011 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '219'}
2025-04-26 15:59:18,012 - main - INFO - Raw request body length: 219
2025-04-26 15:59:18,013 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:59:18,013 - main - INFO - Parsed JSON: {'message': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:59:18,013 - main - INFO - Extracted message: 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa', user_id: 3
2025-04-26 15:59:18,013 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:59:18,014 - main - INFO - Initializing OpenAI model...
2025-04-26 15:59:18,014 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:59:18,014 - main - INFO - Creating OpenAI client...
2025-04-26 15:59:18,014 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:59:18,015 - main - INFO - Trying alternative initialization method
2025-04-26 15:59:18,015 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:59:18,015 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:59:18,015 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:59:18,016 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:59:18,055 - main - INFO - Found 3 relevant documents for query: Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa
2025-04-26 15:59:18,056 - main - INFO - Document 1: “Các nền kinh tế mới nổi ở khu vực châu Á vẫn là đầu tàu chính của kinh tế toàn cầu”, ông Gourinchas...
2025-04-26 15:59:18,057 - main - INFO - Document 2: “Vàng vẫn là một hàng rào hữu ích để phòng ngừa rủi ro địa chính trị và mối lo về tài khóa”, báo cáo...
2025-04-26 15:59:18,057 - main - INFO - Document 3: Tuy nhiên, nếu kiểm soát chặt quá có thể sẽ không khuyến khích nhà đầu tư và sẽ làm kìm hãm phát tri...
2025-04-26 15:59:18,058 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:59:18,058 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: “Các nền kinh tế mới nổi ở khu vực châu Á vẫn là đầu tàu chính của kinh tế toàn cầu”, ông Gourinchas nhấn mạnh.\n\n“Vàng vẫn là một hàng rào hữu ích để phòng ngừa rủi ro địa chính trị và mối lo về tài khóa”, báo cáo mới đây của UBS viết.\n\nTuy nhiên, nếu kiểm soát chặt quá có thể sẽ không khuyến khích nhà đầu tư và sẽ làm kìm hãm phát triển kinh tế - xã hội. Nhưng nếu buông lỏng thì có thể lợi ích siêu ngạch sẽ phục vụ cho thiểu số.', 'query': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 15:59:47,785 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '213'}
2025-04-26 15:59:47,786 - main - INFO - Raw request body length: 213
2025-04-26 15:59:47,786 - main - INFO - Used utf-8 encoding for request body
2025-04-26 15:59:47,786 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 15:59:47,786 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-26 15:59:47,787 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 15:59:47,787 - main - INFO - Initializing OpenAI model...
2025-04-26 15:59:47,787 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 15:59:47,788 - main - INFO - Creating OpenAI client...
2025-04-26 15:59:47,788 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:59:47,788 - main - INFO - Trying alternative initialization method
2025-04-26 15:59:47,789 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 15:59:47,789 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 15:59:47,789 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 15:59:47,790 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 15:59:47,830 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-26 15:59:47,831 - main - INFO - Document 1: TITLE: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?

URL: https://baomoi.com/lam-gi-sau-khi-my-ho...
2025-04-26 15:59:47,831 - main - INFO - Document 2: TITLE: Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán

URL: https://baomoi.com/h...
2025-04-26 15:59:47,831 - main - INFO - Document 3: Mỹ có động thái bất ngờ quyết định hoãn áp thuế đối ứng trong 90 ngày với hơn 75 đối tác thương mại....
2025-04-26 15:59:47,832 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 15:59:47,832 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: TITLE: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?\n\nURL: https://baomoi.com/lam-gi-sau-khi-my-hoan-ap-thue-doi-ung-90-ngay-c51948411.epi\n\nCONTENT:\n\nBối cảnh mới, tâm thế mới\n\n"Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vàoMỹngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.\n\nPhía sau kỷ lục ngành nông nghiệp là sự thay đổi cách thức sản xuất - kinh doanh theo hướng bài bản hơn. Ảnh: Trung Chánh\n\nTITLE: Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán\n\nURL: https://baomoi.com/hoan-ap-thue-90-ngay-thoi-diem-de-tai-co-cau-danh-muc-chung-khoan-c51960750.epi\n\nCONTENT:\n\nChiều ngày 9/4 (sáng sớm ngày 10/4 theo giờ Việt Nam), Tổng thống MỹDonald Trumpthông báo sẽ tạm hoãn thời gian áp dụng mức thuế quan mới với gần 60 đối tác thương mại trong vòng 90 ngày, nhằm thêm thời gian để các bên đàm phán. Thuế suất nhập khẩu và thuế chống bán phá giá đối các mặt hàng nhôm, thép và ô tô được giữ nguyên hiện trạng.\n\nThị trường chứng khoánthế giớilập tức phản ứng tích cực với thông tin trên, chỉ số Dow Jones và S&P500 của Mỹ đóng cửa với mức tăng lần lượt là 7,9% và 9,5%, đánh dấu phiên tăng điểm mạnh nhất kể từ thời điểm Covid-19. Trên thị trường chứng khoán Việt Nam, sắc tím cũng lan tỏa trên cả 3 sàn trong phiên giao dịch ngày 10/4.\n\nMỹ có động thái bất ngờ quyết định hoãn áp thuế đối ứng trong 90 ngày với hơn 75 đối tác thương mại. Quyết định này tạo nên một làn sóng trên toàn cầu, từ hoan nghênh thận trọng tới cảnh báo chiến lược trả đũa.', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 16:00:03,708 - main - INFO - Reloading configuration settings...
2025-04-26 16:00:03,726 - main - INFO - Using provided configuration directly.
2025-04-26 16:00:03,726 - main - INFO - Reinitializing Gemini model...
2025-04-26 16:00:03,727 - main - INFO - Initializing Gemini model...
2025-04-26 16:00:03,727 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 16:00:03,727 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 16:00:24,726 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you'd like to test or ask?

2025-04-26 16:00:24,726 - main - INFO - Gemini model reinitialized successfully
2025-04-26 16:00:24,727 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 16:00:36,829 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '213'}
2025-04-26 16:00:36,830 - main - INFO - Raw request body length: 213
2025-04-26 16:00:36,830 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:00:36,830 - main - INFO - Parsed JSON: {'message': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:00:36,831 - main - INFO - Extracted message: 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', user_id: 3
2025-04-26 16:00:36,846 - main - INFO - Found 3 relevant documents for query: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?
2025-04-26 16:00:36,847 - main - INFO - Document 1: TITLE: Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?

URL: https://baomoi.com/lam-gi-sau-khi-my-ho...
2025-04-26 16:00:36,847 - main - INFO - Document 2: TITLE: Hoãn áp thuế 90 ngày: Thời điểm để tái cơ cấu danh mục chứng khoán

URL: https://baomoi.com/h...
2025-04-26 16:00:36,847 - main - INFO - Document 3: Mỹ có động thái bất ngờ quyết định hoãn áp thuế đối ứng trong 90 ngày với hơn 75 đối tác thương mại....
2025-04-26 16:01:08,464 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:01:08,465 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Ngoài dự kiến" là cụm từ được nhiều doanh nhân, nhà đầu tư, chuyên gia dùng để mô tả những sự việc đã diễn ra trong 10 ngày qua. Từ tâm lý có phần hoang mang khi Tổng thống Donald Trump tuyên bố áp thuế đối ứng ở mức 46% với hàng hóa Việt Nam nhập khẩu vào Mỹ ngày 2-4, tới phấn khởi khi thông báo hoãn áp thuế đối ứng với các nước trong 90 ngày được người đứng đầu Nhà Trắng đăng tải trên mạng xã hội Truth Social ngày 10-4.  Chiều ngày 9/4 (sáng sớm ngày 10/4 theo giờ Việt Nam), Tổng thống Mỹ Donald Trump thông báo sẽ tạm hoãn thời gian áp dụng mức thuế quan mới với gần 60 đối tác thương mại trong vòng 90 ngày, nhằm thêm thời gian để các bên đàm phán.\n', 'query': 'Làm gì sau khi Mỹ hoãn áp thuế đối ứng 90 ngày?', 'processing_time': '31.63 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:01:51,619 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '1423'}
2025-04-26 16:01:51,620 - main - INFO - Raw request body length: 1423
2025-04-26 16:01:51,620 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:01:51,620 - main - INFO - Parsed JSON: {'message': 'Chương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nNội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.\n\n1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:01:51,621 - main - INFO - Extracted message: 'Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN

Nội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.

1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 16:01:51,677 - main - INFO - Found 3 relevant documents for query: Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN

Nội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.

1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 16:01:51,678 - main - INFO - Document 1: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 16:01:51,678 - main - INFO - Document 2: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 16:01:51,679 - main - INFO - Document 3: CHỦ TỊCH

PGS Ngô Tuấn Nghĩa

6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH T...
2025-04-26 16:02:17,947 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:02:17,948 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Nội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội."\n\n"1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN\n\nTrong dòng chảy tư tưởng kinh tế của nhân loại kể từ thời kỳ cô đại cho tới ngày nay, do đặc thù trình độ phát triển ứng với mỗi giai đoạn lịch sử, mỗi nền sản xuất xã hội mà hình thành nhiều tư tưởng, trường phái lý luận về kinh tế khác nhau."\n', 'query': 'Chương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nNội dung chương 1 cung cấp những tri thức cơ bản về sự ra đời và phát triển của môn học kinh tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học kinh tế chính trị Mác - Lênin trong nhận thức cũng như trong thực tiễn. Trên cơ sở đó, sinh viên hiểu được sự hình thành, phát triền nội dung khoa học của môn học kinh tế chính trị Mác - Lênin, biết được ý nghĩa của môn học đối với bản thân khi tham gia các hoạt động kinh tế - xã hội.\n\n1. KHÁI QUÁT SỤ HÌNH THÀNH VÀ PHÁT TR1ÈN CỦA KINH TẾ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '26.33 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:03:17,673 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '1734'}
2025-04-26 16:03:17,674 - main - INFO - Raw request body length: 1734
2025-04-26 16:03:17,674 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:03:17,674 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày một cách hệ thống (đặc biệt từ A - một tiền bối lớn nhất có nhiều công trình nghiên cứu đồ sộ với nhiều luận điểm giá trị khoa học mà D kế thừa) các phạm trù kinh tế chính trị như phân công lao động, hàng hóa, giá trị, tiền tệ, giá cả, giá cả thị trường, tiền lương, lợi nhuận, lợi túc, địa tô, tư bản... dể rút ra các quy luật kinh tế. Lý luận kinh tế chính trị cồ điển Anh đã rút ra được giá trị là do hao phí lao dộng tạo ra, giá trị khác với của cải... Đó là những đóng góp khoa học rất lớn của các đại biểu kinh tế chính trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa nhân loại, thể hiộn sự phát triển vượt bậc so với hệ thống lý luận của chủ nghĩa trọng nông.', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:03:17,675 - main - INFO - Extracted message: 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày một cách hệ thống (đặc biệt từ A - một tiền bối lớn nhất có nhiều công trình nghiên cứu đồ sộ với nhiều luận điểm giá trị khoa học mà D kế thừa) các phạm trù kinh tế chính trị như phân công lao động, hàng hóa, giá trị, tiền tệ, giá cả, giá cả thị trường, tiền lương, lợi nhuận, lợi túc, địa tô, tư bản... dể rút ra các quy luật kinh tế. Lý luận kinh tế chính trị cồ điển Anh đã rút ra được giá trị là do hao phí lao dộng tạo ra, giá trị khác với của cải... Đó là những đóng góp khoa học rất lớn của các đại biểu kinh tế chính trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa nhân loại, thể hiộn sự phát triển vượt bậc so với hệ thống lý luận của chủ nghĩa trọng nông.', user_id: 3
2025-04-26 16:03:17,741 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày một cách hệ thống (đặc biệt từ A - một tiền bối lớn nhất có nhiều công trình nghiên cứu đồ sộ với nhiều luận điểm giá trị khoa học mà D kế thừa) các phạm trù kinh tế chính trị như phân công lao động, hàng hóa, giá trị, tiền tệ, giá cả, giá cả thị trường, tiền lương, lợi nhuận, lợi túc, địa tô, tư bản... dể rút ra các quy luật kinh tế. Lý luận kinh tế chính trị cồ điển Anh đã rút ra được giá trị là do hao phí lao dộng tạo ra, giá trị khác với của cải... Đó là những đóng góp khoa học rất lớn của các đại biểu kinh tế chính trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa nhân loại, thể hiộn sự phát triển vượt bậc so với hệ thống lý luận của chủ nghĩa trọng nông.
2025-04-26 16:03:17,742 - main - INFO - Document 1: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày...
2025-04-26 16:03:17,742 - main - INFO - Document 2: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày...
2025-04-26 16:03:17,742 - main - INFO - Document 3: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày...
2025-04-26 16:03:38,018 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:03:38,020 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày một cách hệ thống (đặc biệt từ A - một tiền bối lớn nhất có nhiều công trình nghiên cứu đồ sộ với nhiều luận điểm giá trị khoa học mà D kế thừa) các phạm trù kinh tế chính trị như phân công lao động, hàng hóa, giá trị, tiền tệ, giá cả, giá cả thị trường, tiền lương, lợi nhuận, lợi túc, địa tô, tư bản... dể rút ra các quy luật kinh tế. Lý luận kinh tế chính trị cồ điển Anh đã rút ra được giá trị là do hao phí lao dộng tạo ra, giá trị khác với của cải... Đó là những đóng góp khoa học rất lớn của các đại biểu kinh tế chính trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa nhân loại, thể hiộn sự phát triển vượt bậc so với hệ thống lý luận của chủ nghĩa trọng nông."\n', 'query': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình bày một cách hệ thống (đặc biệt từ A - một tiền bối lớn nhất có nhiều công trình nghiên cứu đồ sộ với nhiều luận điểm giá trị khoa học mà D kế thừa) các phạm trù kinh tế chính trị như phân công lao động, hàng hóa, giá trị, tiền tệ, giá cả, giá cả thị trường, tiền lương, lợi nhuận, lợi túc, địa tô, tư bản... dể rút ra các quy luật kinh tế. Lý luận kinh tế chính trị cồ điển Anh đã rút ra được giá trị là do hao phí lao dộng tạo ra, giá trị khác với của cải... Đó là những đóng góp khoa học rất lớn của các đại biểu kinh tế chính trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa nhân loại, thể hiộn sự phát triển vượt bậc so với hệ thống lý luận của chủ nghĩa trọng nông.', 'processing_time': '20.34 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:04:06,799 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '530'}
2025-04-26 16:04:06,799 - main - INFO - Raw request body length: 530
2025-04-26 16:04:06,800 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:04:06,800 - main - INFO - Parsed JSON: {'message': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu các quan hệ kinh tế để tìm ra các quy luật chi phối sự vận động của các hiện tượng và quá trình hoạt động kinh tế của con người', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:04:06,800 - main - INFO - Extracted message: 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu các quan hệ kinh tế để tìm ra các quy luật chi phối sự vận động của các hiện tượng và quá trình hoạt động kinh tế của con người', user_id: 3
2025-04-26 16:04:06,825 - main - INFO - Found 3 relevant documents for query: Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu các quan hệ kinh tế để tìm ra các quy luật chi phối sự vận động của các hiện tượng và quá trình hoạt động kinh tế của con người
2025-04-26 16:04:06,825 - main - INFO - Document 1: “Thúc đẩy kinh tế tư nhân là một quá trình lâu dài, đòi hỏi sự phối hợp chặt chẽ giữa nhà nước và do...
2025-04-26 16:04:06,825 - main - INFO - Document 2: Nếu giá nhà không giảm, các gia đình trẻ và những người trẻ đang tìm cách mua nhà lần đầu sẽ gặp nhi...
2025-04-26 16:04:06,826 - main - INFO - Document 3: Riêng với TikTok, khoản đầu tư này không chỉ củng cố vị thế tại Đông Nam Á mà còn giúp nền tảng giảm...
2025-04-26 16:04:27,494 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:04:27,495 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học kinh tế nghiên cứu các quan hệ kinh tế để tìm ra các quy luật chi phối sự vận động của các hiện tượng và quá trình hoạt động kinh tế của con người', 'processing_time': '20.69 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:04:49,213 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '832'}
2025-04-26 16:04:49,214 - main - INFO - Raw request body length: 832
2025-04-26 16:04:49,214 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:04:49,214 - main - INFO - Parsed JSON: {'message': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về những quy luật chi phối sự sàn xuất vật chất và sự trao đổi những tư liệu sinh hoạt vật chất trong xã hội loài người..ững điều kiện trong đó người ta sản xuất sản phẩm và trao đồi chúng đều thay đồi tuỳ từng nước, và trong mỗi nước lại thay đồi tuỳ từng thế hệ.', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:04:49,215 - main - INFO - Extracted message: 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về những quy luật chi phối sự sàn xuất vật chất và sự trao đổi những tư liệu sinh hoạt vật chất trong xã hội loài người..ững điều kiện trong đó người ta sản xuất sản phẩm và trao đồi chúng đều thay đồi tuỳ từng nước, và trong mỗi nước lại thay đồi tuỳ từng thế hệ.', user_id: 3
2025-04-26 16:04:49,261 - main - INFO - Found 3 relevant documents for query: Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về những quy luật chi phối sự sàn xuất vật chất và sự trao đổi những tư liệu sinh hoạt vật chất trong xã hội loài người..ững điều kiện trong đó người ta sản xuất sản phẩm và trao đồi chúng đều thay đồi tuỳ từng nước, và trong mỗi nước lại thay đồi tuỳ từng thế hệ.
2025-04-26 16:04:49,262 - main - INFO - Document 1: 1 2

Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về ...
2025-04-26 16:04:49,262 - main - INFO - Document 2: 1 2

Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về ...
2025-04-26 16:04:49,262 - main - INFO - Document 3: 1 2

Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về ...
2025-04-26 16:05:14,839 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:05:14,840 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về những quy luật chi phối sự sàn xuất vật chất và sự trao đổi những tư liệu sinh hoạt vật chất trong xã hội loài người..ững điều kiện trong đó người ta sản xuất sản phẩm và trao đồi chúng đều thay đồi tuỳ từng nước, và trong mỗi nước lại thay đồi tuỳ từng thế hệ."\n', 'query': 'Theo nghĩa rộng, Ph.Ăngghcn cho rằng: “Kinh tế chính trị, theo nghĩa rộng nhất, là khoa học về những quy luật chi phối sự sàn xuất vật chất và sự trao đổi những tư liệu sinh hoạt vật chất trong xã hội loài người..ững điều kiện trong đó người ta sản xuất sản phẩm và trao đồi chúng đều thay đồi tuỳ từng nước, và trong mỗi nước lại thay đồi tuỳ từng thế hệ.', 'processing_time': '25.62 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:06:59,777 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 16:06:59,778 - main - INFO - Raw request body length: 229
2025-04-26 16:06:59,778 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:06:59,778 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'user_id': 3, 'document_ids': [13], 'documentIds': [13], 'context_document_ids': [13], 'support_doc_ids': [13]}
2025-04-26 16:06:59,779 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', user_id: 3
2025-04-26 16:06:59,818 - main - INFO - Found 3 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải
2025-04-26 16:06:59,818 - main - INFO - Document 1: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày ...
2025-04-26 16:06:59,819 - main - INFO - Document 2: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 16:06:59,819 - main - INFO - Document 3: Như vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 ...
2025-04-26 16:07:18,751 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:07:18,752 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày 16 đến 18/1. Đây là chuyến thăm chính đầu tiên của Thủ tướng Việt Nam đến Ba Lan sau 15 năm."  Thông tin được cung cấp chỉ đề cập đến chuyến thăm của Thủ tướng Phạm Minh Chính đến Ba Lan, việc từ nhiệm của bà Nguyễn Thị Mỹ Hạnh tại Novaland, và khoản đầu tư của Mai Phương Thúy. Không có thông tin nào liên quan đến đối tượng nghiên cứu của kinh tế chính trị. Do đó, tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'processing_time': '18.97 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:12:31,435 - main - INFO - Processing document ID: 14, File path: documents/3/1745683946_giao-trinh.txt
2025-04-26 16:12:31,435 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745683946_giao-trinh.txt
2025-04-26 16:12:31,439 - main - INFO - Loading document: /app/storage/documents/3/1745683946_giao-trinh.txt
2025-04-26 16:12:31,439 - main - INFO - Using TextLoader
2025-04-26 16:12:31,445 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 16:12:31,450 - main - INFO - Document split into 34 chunks
2025-04-26 16:12:31,451 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 16:12:34,788 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 16:12:34,791 - main - INFO - Creating vector store at /app/vector_db/doc_14
2025-04-26 16:12:35,723 - main - INFO - Vector store created successfully for document 14
2025-04-26 16:12:35,723 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 16:12:35,759 - main - INFO - Integrating document ID: 14
2025-04-26 16:12:35,759 - main - INFO - Integrating document vectors for document ID: 14
2025-04-26 16:12:35,761 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 16:12:38,814 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 16:12:39,146 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 16:12:42,764 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 16:12:42,765 - main - INFO - Merging document vectors into main vector database
2025-04-26 16:12:42,798 - main - INFO - Saving merged vector database
2025-04-26 16:12:44,594 - main - INFO - Document vectors integrated successfully for document 14
2025-04-26 16:12:44,642 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 16:12:44,644 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 16:12:44,646 - main - INFO - Loading vector store...
2025-04-26 16:12:44,647 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 16:12:46,969 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 16:12:47,338 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 16:12:48,396 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 16:13:38,295 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 16:13:38,296 - main - INFO - Raw request body length: 229
2025-04-26 16:13:38,296 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:13:38,296 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 16:13:38,296 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', user_id: 3
2025-04-26 16:13:38,376 - main - INFO - Found 3 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải
2025-04-26 16:13:38,377 - main - INFO - Document 1: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày ...
2025-04-26 16:13:38,377 - main - INFO - Document 2: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 16:13:38,378 - main - INFO - Document 3: Như vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 ...
2025-04-26 16:14:05,875 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 16:14:05,876 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày 16 đến 18/1. Đây là chuyến thăm chính đầu tiên của Thủ tướng Việt Nam đến Ba Lan sau 15 năm."\n\nTôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'processing_time': '27.58 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 16:18:11,596 - main - INFO - Reloading configuration settings...
2025-04-26 16:18:11,625 - main - INFO - Using provided configuration directly.
2025-04-26 16:18:11,625 - main - INFO - Reinitializing OpenAI model...
2025-04-26 16:18:11,626 - main - INFO - Initializing OpenAI model...
2025-04-26 16:18:11,626 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 16:18:11,626 - main - INFO - Creating OpenAI client...
2025-04-26 16:18:11,627 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:18:11,627 - main - INFO - Trying alternative initialization method
2025-04-26 16:18:11,627 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 16:18:11,627 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 16:18:11,628 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:18:11,628 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 16:18:11,628 - main - WARNING - OpenAI model reinitialization returned None
2025-04-26 16:18:24,052 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '229'}
2025-04-26 16:18:24,053 - main - INFO - Raw request body length: 229
2025-04-26 16:18:24,053 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:18:24,053 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 16:18:24,053 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', user_id: 3
2025-04-26 16:18:24,054 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 16:18:24,054 - main - INFO - Initializing OpenAI model...
2025-04-26 16:18:24,054 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 16:18:24,054 - main - INFO - Creating OpenAI client...
2025-04-26 16:18:24,055 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:18:24,055 - main - INFO - Trying alternative initialization method
2025-04-26 16:18:24,055 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 16:18:24,055 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 16:18:24,056 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:18:24,056 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 16:18:24,074 - main - INFO - Found 3 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải
2025-04-26 16:18:24,075 - main - INFO - Document 1: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày ...
2025-04-26 16:18:24,075 - main - INFO - Document 2: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 16:18:24,076 - main - INFO - Document 3: Như vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 ...
2025-04-26 16:18:24,076 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 16:18:24,076 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày 16 đến 18/1. Đây là chuyến thăm chính đầu tiên của Thủ tướng Việt Nam đến Ba Lan sau 15 năm.\n\nAnh Tú\n\nNgoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nNhư vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 tỉ đồng, ước tính hoa hậu này lãi khoảng 3 tỉ đồng\n\nLê Tỉnh', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 16:24:31,817 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '268'}
2025-04-26 16:24:31,817 - main - INFO - Raw request body length: 268
2025-04-26 16:24:31,818 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:24:31,818 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14], 'doc_ids': [14], 'document_ids_str': '14'}
2025-04-26 16:24:31,818 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', user_id: 3
2025-04-26 16:24:31,818 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 16:24:31,819 - main - INFO - Initializing OpenAI model...
2025-04-26 16:24:31,819 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 16:24:31,819 - main - INFO - Creating OpenAI client...
2025-04-26 16:24:31,820 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:24:31,820 - main - INFO - Trying alternative initialization method
2025-04-26 16:24:31,820 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 16:24:31,820 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 16:24:31,821 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:24:31,821 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 16:24:31,902 - main - INFO - Found 3 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải
2025-04-26 16:24:31,903 - main - INFO - Document 1: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày ...
2025-04-26 16:24:31,903 - main - INFO - Document 2: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 16:24:31,904 - main - INFO - Document 3: Như vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 ...
2025-04-26 16:24:31,904 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 16:24:31,905 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày 16 đến 18/1. Đây là chuyến thăm chính đầu tiên của Thủ tướng Việt Nam đến Ba Lan sau 15 năm.\n\nAnh Tú\n\nNgoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nNhư vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 tỉ đồng, ước tính hoa hậu này lãi khoảng 3 tỉ đồng\n\nLê Tỉnh', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'processing_time': '0.09 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 16:27:15,060 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '237'}
2025-04-26 16:27:15,061 - main - INFO - Raw request body length: 237
2025-04-26 16:27:15,061 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:27:15,062 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'user_id': 3, 'document_ids': ['14'], 'documentIds': ['14'], 'context_document_ids': ['14'], 'support_doc_ids': ['14']}
2025-04-26 16:27:15,062 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', user_id: 3
2025-04-26 16:27:15,062 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 16:27:15,062 - main - INFO - Initializing OpenAI model...
2025-04-26 16:27:15,063 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 16:27:15,063 - main - INFO - Creating OpenAI client...
2025-04-26 16:27:15,063 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:27:15,064 - main - INFO - Trying alternative initialization method
2025-04-26 16:27:15,064 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 16:27:15,064 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 16:27:15,064 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:27:15,065 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 16:27:15,082 - main - INFO - Found 3 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải
2025-04-26 16:27:15,083 - main - INFO - Document 1: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày ...
2025-04-26 16:27:15,083 - main - INFO - Document 2: Ngoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyệ...
2025-04-26 16:27:15,084 - main - INFO - Document 3: Như vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 ...
2025-04-26 16:27:15,084 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 16:27:15,084 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Thủ tướng Phạm Minh Chínhđang thăm chính thức Ba Lan theo lời mời của Thủ tướng Donald Tusk từ ngày 16 đến 18/1. Đây là chuyến thăm chính đầu tiên của Thủ tướng Việt Nam đến Ba Lan sau 15 năm.\n\nAnh Tú\n\nNgoài ra, bà Nguyễn Thị Mỹ Hạnh cũng từ nhiệm thành viên độc lập Hội đồng quản trị. Đây vừa là nguyện vọng cá nhân của bà, vừa theo định hướng tái cấu trúc của Novaland.\n\nTất Đạt\n\nNhư vậy, chưa tới 2 ngày, khoản đầu tư của Mai Phương Thúy đã tăng giá trị từ 21,3 tỉ đồng lên 24,3 tỉ đồng, ước tính hoa hậu này lãi khoảng 3 tỉ đồng\n\nLê Tỉnh', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 16:27:31,646 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '325'}
2025-04-26 16:27:31,646 - main - INFO - Raw request body length: 325
2025-04-26 16:27:31,647 - main - INFO - Used utf-8 encoding for request body
2025-04-26 16:27:31,647 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất và trao đổi mà là hệ thống', 'user_id': 3, 'document_ids': ['14'], 'documentIds': ['14'], 'context_document_ids': ['14'], 'support_doc_ids': ['14']}
2025-04-26 16:27:31,647 - main - INFO - Extracted message: 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất và trao đổi mà là hệ thống', user_id: 3
2025-04-26 16:27:31,647 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 16:27:31,647 - main - INFO - Initializing OpenAI model...
2025-04-26 16:27:31,648 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 16:27:31,648 - main - INFO - Creating OpenAI client...
2025-04-26 16:27:31,648 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:27:31,648 - main - INFO - Trying alternative initialization method
2025-04-26 16:27:31,648 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 16:27:31,649 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 16:27:31,649 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 16:27:31,650 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 16:27:31,692 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất và trao đổi mà là hệ thống
2025-04-26 16:27:31,692 - main - INFO - Document 1: Khi đó, nhà mạng này được lựa chọn bởi có tình hình tài chính và kết quả kinh doanh tốt trong 3 doan...
2025-04-26 16:27:31,692 - main - INFO - Document 2: Tám là,tăng cường công tác thông tin, tuyên truyền và định hướng dư luận. Bộ sẽ đẩy mạnh truyền thôn...
2025-04-26 16:27:31,693 - main - INFO - Document 3: Ngoài ra, một bảng phụ lục mới cũng được bổ sung nhằm chỉnh sửa những cụm từ “trước thông quan, sau ...
2025-04-26 16:27:31,693 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 16:27:31,693 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Khi đó, nhà mạng này được lựa chọn bởi có tình hình tài chính và kết quả kinh doanh tốt trong 3 doanh nghiệp viễn thông. Thực tế, đến nay, so với các doanh nghiệp khác trên thị trường, MobiFone cũng ít chịu áp lực về tài chính do tỷ lệ vay nợ thấp.\n\nAnh Tú\n\nTám là,tăng cường công tác thông tin, tuyên truyền và định hướng dư luận. Bộ sẽ đẩy mạnh truyền thông chính sách phát triển ngành, lan tỏa các mô hình sản xuất - kinh doanh hiệu quả và chủ động phản bác thông tin sai lệch gây ảnh hưởng đến tâm lý người tiêu dùng cũng như uy tín sản phẩm nông nghiệp Việt Nam.\n\nHưng Nhật\n\nNgoài ra, một bảng phụ lục mới cũng được bổ sung nhằm chỉnh sửa những cụm từ “trước thông quan, sau thông quan”, cập nhật những quy chuẩn kỹ thuật mới đối với danh mục hàng hoá phải kiểm tra chất lượng nhằm bảo đảm thống nhất, đồng bộ trong hệ thống pháp luật.', 'query': 'Kinh tế chính trị không nghiên cứu biểu hiện kỹ thuật của sự sàn xuất và trao đổi mà là hệ thống', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:03:12,554 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '158'}
2025-04-26 17:03:12,555 - main - INFO - Raw request body length: 158
2025-04-26 17:03:12,555 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:03:12,556 - main - INFO - Parsed JSON: {'message': 'TÓM TẲT CHƯƠNG', 'user_id': 3, 'document_ids': ['14'], 'documentIds': ['14'], 'context_document_ids': ['14'], 'support_doc_ids': ['14']}
2025-04-26 17:03:12,556 - main - INFO - Extracted message: 'TÓM TẲT CHƯƠNG', user_id: 3
2025-04-26 17:03:12,556 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:03:12,557 - main - INFO - Initializing OpenAI model...
2025-04-26 17:03:12,557 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:03:12,557 - main - INFO - Creating OpenAI client...
2025-04-26 17:03:12,558 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:03:12,558 - main - INFO - Trying alternative initialization method
2025-04-26 17:03:12,558 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:03:12,559 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:03:12,559 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:03:12,574 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 325, in initialize_openai
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:03:12,643 - main - INFO - Found 3 relevant documents for query: TÓM TẲT CHƯƠNG
2025-04-26 17:03:12,644 - main - INFO - Document 1: Đảng Dân chủ cũng chỉ trích động thái của ông Trump. Nghị sĩ Greg Stanton, đảng viên Đảng Dân chủ đế...
2025-04-26 17:03:12,644 - main - INFO - Document 2: Vào năm ngoái, bà Judy Shelton - người được cho là có thể sẽ được ông Trump chọn cho ghế Chủ tịch Fe...
2025-04-26 17:03:12,644 - main - INFO - Document 3: Trong diễn đàn trực tuyến do Trường Harvard Kennedy tổ chức tuần trước, nhà kinh tế Lydia Cox tại Đạ...
2025-04-26 17:03:12,645 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:03:12,646 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đảng Dân chủ cũng chỉ trích động thái của ông Trump. Nghị sĩ Greg Stanton, đảng viên Đảng Dân chủ đến từ bang Arizona và khoảng 40 đồng nghiệp đã viết trong một lá thư hôm 1/2: “Những mức thuế này sẽ gây thiệt hại nặng nề cho người tiêu dùng Mỹ. Tiếp đó, ông Stanton viết X: “Thuế quan mà ông Trump áp lên Mexico và Canada sẽ khiến cuộc sống của các bạn trở nên đắt đỏ hơn”.\n\nVào năm ngoái, bà Judy Shelton - người được cho là có thể sẽ được ông Trump chọn cho ghế Chủ tịch Fed một khi Chủ tịch Fed hiện tại là ông Jerome Powell mãn nhiệm - đưa ra ý tưởng Chính phủ Mỹ phát hành trái phiếu có thể thanh toán bằng vàng.\n\nTrong diễn đàn trực tuyến do Trường Harvard Kennedy tổ chức tuần trước, nhà kinh tế Lydia Cox tại Đại học Wisconsin-Madison mô tả thuế quan là "một công cụ khá thô bạo". Theo bà, thuế quan mang lại một số lợi ích tiềm năng cho các ngành được bảo hộ nhưng "tạo ra rất nhiều thiệt hại kèm theo".\n\nCùng với Canada, Mexico từng cảnh báo sẽ áp dụng thuế quan riêng với hàng xuất khẩu của Mỹ khi ông Trump nêu đe dọa trước thời điểm nhậm chức.\n\nPhiên An(theo AP, NYT)', 'query': 'TÓM TẲT CHƯƠNG', 'processing_time': '0.09 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:18:00,994 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 17:18:01,013 - main - INFO - Initializing vector database...
2025-04-26 17:18:01,013 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 17:18:01,016 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 17:18:01,016 - main - INFO - Loading vector store...
2025-04-26 17:18:03,404 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:18:09,753 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 17:18:17,760 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:18:17,769 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 17:18:17,797 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 17:18:18,132 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:18:19,252 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 17:18:19,252 - main - INFO - Vector database retriever configured successfully
2025-04-26 17:18:19,253 - main - INFO - Testing retriever with a simple query
2025-04-26 17:18:19,296 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 17:18:19,297 - main - INFO - Initializing OpenAI model...
2025-04-26 17:18:19,297 - main - INFO - Initializing OpenAI model...
2025-04-26 17:18:19,298 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:18:19,298 - main - INFO - Creating OpenAI client...
2025-04-26 17:18:19,299 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:18:19,299 - main - INFO - Trying alternative initialization method
2025-04-26 17:18:19,300 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:18:19,300 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:18:19,301 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:18:19,304 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:18:19,304 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 17:21:58,761 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '580'}
2025-04-26 17:21:58,762 - main - INFO - Raw request body length: 580
2025-04-26 17:21:58,763 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:21:58,763 - main - INFO - Parsed JSON: {'message': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 17:21:58,763 - main - INFO - Extracted message: 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', user_id: 3
2025-04-26 17:21:58,763 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:21:58,764 - main - INFO - Initializing OpenAI model...
2025-04-26 17:21:58,764 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:21:58,764 - main - INFO - Creating OpenAI client...
2025-04-26 17:21:58,764 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:21:58,765 - main - INFO - Trying alternative initialization method
2025-04-26 17:21:58,765 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:21:58,765 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:21:58,766 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:21:58,766 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:21:58,813 - main - INFO - Found 3 relevant documents for query: Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.
2025-04-26 17:21:58,813 - main - INFO - Document 1: Với các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ tr...
2025-04-26 17:21:58,813 - main - INFO - Document 2: Đồng thời, thực hiện đồng bộ việc quy hoạch, phát triển khu công nghiệp với các công trình nhà ở, xã...
2025-04-26 17:21:58,814 - main - INFO - Document 3: Đồng thời, hỗ trợ phát triển các hợp tác xã gắn hoạt động sản xuất kinh doanh với chuỗi giá trị sản ...
2025-04-26 17:21:58,814 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:21:58,814 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Với các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ trợ kịp thời từ Chính phủ và các bộ, ngành, nhằm duy trì chuỗi sản xuất – xuất khẩu, bảo đảm việc làm cho người lao động và ổn định sinh kế cho cộng đồng nông - ngư dân trong bối cảnh nhiều biến động.\n\nNguyễn Phương Anh\n\nĐồng thời, thực hiện đồng bộ việc quy hoạch, phát triển khu công nghiệp với các công trình nhà ở, xã hội và văn hóa thể thao cho người lao động làm việc trong khu công nghiệp; đảm bảo việc cung cấp hạ tầng kỹ thuật và hạ tầng xã hội ngoài hàng rào phục vụ cho hoạt động của khu công nghiệp; có giải pháp ổn định đời sống và xây dựng phương án hỗ trợ việc làm, đào tạo nghề cho người dân, người lao động bị ảnh hưởng.../.\n\nĐồng thời, hỗ trợ phát triển các hợp tác xã gắn hoạt động sản xuất kinh doanh với chuỗi giá trị sản phẩm, ứng dụng khoa học công nghệ, đổi mới sáng tạo và chuyển đổi số, phát triển nông nghiệp xanh, hữu cơ, tuần hoàn.\n\nThảo Ngân\n\nTheo Cổng TTĐT Chính phủ, TTXVN', 'query': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'processing_time': '0.05 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:24:10,160 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '580'}
2025-04-26 17:24:10,160 - main - INFO - Raw request body length: 580
2025-04-26 17:24:10,161 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:24:10,161 - main - INFO - Parsed JSON: {'message': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 17:24:10,161 - main - INFO - Extracted message: 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', user_id: 3
2025-04-26 17:24:10,161 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:24:10,162 - main - INFO - Initializing OpenAI model...
2025-04-26 17:24:10,162 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:24:10,162 - main - INFO - Creating OpenAI client...
2025-04-26 17:24:10,162 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:24:10,163 - main - INFO - Trying alternative initialization method
2025-04-26 17:24:10,163 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:24:10,163 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:24:10,163 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:24:10,164 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:24:10,186 - main - INFO - Found 3 relevant documents for query: Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.
2025-04-26 17:24:10,187 - main - INFO - Document 1: Với các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ tr...
2025-04-26 17:24:10,187 - main - INFO - Document 2: Đồng thời, thực hiện đồng bộ việc quy hoạch, phát triển khu công nghiệp với các công trình nhà ở, xã...
2025-04-26 17:24:10,187 - main - INFO - Document 3: Đồng thời, hỗ trợ phát triển các hợp tác xã gắn hoạt động sản xuất kinh doanh với chuỗi giá trị sản ...
2025-04-26 17:24:10,188 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:24:10,188 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Với các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ trợ kịp thời từ Chính phủ và các bộ, ngành, nhằm duy trì chuỗi sản xuất – xuất khẩu, bảo đảm việc làm cho người lao động và ổn định sinh kế cho cộng đồng nông - ngư dân trong bối cảnh nhiều biến động.\n\nNguyễn Phương Anh\n\nĐồng thời, thực hiện đồng bộ việc quy hoạch, phát triển khu công nghiệp với các công trình nhà ở, xã hội và văn hóa thể thao cho người lao động làm việc trong khu công nghiệp; đảm bảo việc cung cấp hạ tầng kỹ thuật và hạ tầng xã hội ngoài hàng rào phục vụ cho hoạt động của khu công nghiệp; có giải pháp ổn định đời sống và xây dựng phương án hỗ trợ việc làm, đào tạo nghề cho người dân, người lao động bị ảnh hưởng.../.\n\nĐồng thời, hỗ trợ phát triển các hợp tác xã gắn hoạt động sản xuất kinh doanh với chuỗi giá trị sản phẩm, ứng dụng khoa học công nghệ, đổi mới sáng tạo và chuyển đổi số, phát triển nông nghiệp xanh, hữu cơ, tuần hoàn.\n\nThảo Ngân\n\nTheo Cổng TTĐT Chính phủ, TTXVN', 'query': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:25:25,604 - main - INFO - Processing document ID: 15, File path: documents/3/1745687996_giao-trinh.txt
2025-04-26 17:25:25,604 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745687996_giao-trinh.txt
2025-04-26 17:25:25,606 - main - INFO - Loading document: /app/storage/documents/3/1745687996_giao-trinh.txt
2025-04-26 17:25:25,607 - main - INFO - Using TextLoader
2025-04-26 17:25:25,609 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 17:25:25,624 - main - INFO - Document split into 476 chunks with chunk_size=100, chunk_overlap=50
2025-04-26 17:25:25,624 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:25:29,859 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:25:29,862 - main - INFO - Creating vector store at /app/vector_db/doc_15
2025-04-26 17:25:31,898 - main - INFO - Vector store created successfully for document 15
2025-04-26 17:25:31,899 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 17:25:31,920 - main - INFO - Integrating document ID: 15
2025-04-26 17:25:31,920 - main - INFO - Integrating document vectors for document ID: 15
2025-04-26 17:25:31,922 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:25:34,302 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:25:34,627 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:25:35,897 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:25:35,900 - main - INFO - Merging document vectors into main vector database
2025-04-26 17:25:35,944 - main - INFO - Saving merged vector database
2025-04-26 17:25:37,487 - main - INFO - Document vectors integrated successfully for document 15
2025-04-26 17:25:37,536 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 17:25:37,539 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 17:25:37,539 - main - INFO - Loading vector store...
2025-04-26 17:25:37,540 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:25:39,974 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:25:40,321 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:25:41,555 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 17:26:24,866 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '580'}
2025-04-26 17:26:24,867 - main - INFO - Raw request body length: 580
2025-04-26 17:26:24,867 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:26:24,868 - main - INFO - Parsed JSON: {'message': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'user_id': 3, 'document_ids': [15], 'documentIds': [15], 'context_document_ids': [15], 'support_doc_ids': [15]}
2025-04-26 17:26:24,868 - main - INFO - Extracted message: 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', user_id: 3
2025-04-26 17:26:24,868 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:26:24,869 - main - INFO - Initializing OpenAI model...
2025-04-26 17:26:24,869 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:26:24,869 - main - INFO - Creating OpenAI client...
2025-04-26 17:26:24,869 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:26:24,870 - main - INFO - Trying alternative initialization method
2025-04-26 17:26:24,870 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:26:24,870 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:26:24,871 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:26:24,871 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:26:24,897 - main - INFO - Found 3 relevant documents for query: Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.
2025-04-26 17:26:24,898 - main - INFO - Document 1: Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội
2025-04-26 17:26:24,898 - main - INFO - Document 2: động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau,
2025-04-26 17:26:24,898 - main - INFO - Document 3: Với các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ tr...
2025-04-26 17:26:24,899 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:26:24,900 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội\n\nđộng xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau,\n\nVới các đề xuất trên, Hiệp hội VASEP cùng cộng đồng doanh nghiệp thủy sản kỳ vọng nhận được sự hỗ trợ kịp thời từ Chính phủ và các bộ, ngành, nhằm duy trì chuỗi sản xuất – xuất khẩu, bảo đảm việc làm cho người lao động và ổn định sinh kế cho cộng đồng nông - ngư dân trong bối cảnh nhiều biến động.\n\nNguyễn Phương Anh', 'query': 'Một là, phân công lao động xã hội. Phân công lao động xã hội là sự phân chia lao động trong xã hội thành các ngành, các lĩnh vực sản xuất khác nhau, tạo nen sự chuyên môn hóa cùa những người sản xuất thành những ngành, nghề khác nhau.', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:27:37,546 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '510'}
2025-04-26 17:27:37,547 - main - INFO - Raw request body length: 510
2025-04-26 17:27:37,547 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:27:37,548 - main - INFO - Parsed JSON: {'message': 'Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc,', 'user_id': 3, 'document_ids': [15], 'documentIds': [15], 'context_document_ids': [15], 'support_doc_ids': [15]}
2025-04-26 17:27:37,548 - main - INFO - Extracted message: 'Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc,', user_id: 3
2025-04-26 17:27:37,548 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:27:37,549 - main - INFO - Initializing OpenAI model...
2025-04-26 17:27:37,549 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:27:37,549 - main - INFO - Creating OpenAI client...
2025-04-26 17:27:37,549 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:27:37,550 - main - INFO - Trying alternative initialization method
2025-04-26 17:27:37,550 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:27:37,550 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:27:37,550 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:27:37,551 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:27:37,602 - main - INFO - Found 3 relevant documents for query: Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc,
2025-04-26 17:27:37,603 - main - INFO - Document 1: Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự
2025-04-26 17:27:37,603 - main - INFO - Document 2: các chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát
2025-04-26 17:27:37,604 - main - INFO - Document 3: tách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc, hàng
2025-04-26 17:27:37,604 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:27:37,605 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự\n\ncác chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát\n\ntách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc, hàng', 'query': 'Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa trôn sự tách biệt về sở hữu. Xã hội loài người càng phát triển, sự tách biệt về sở hữu càng sâu sắc,', 'processing_time': '0.06 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:28:20,178 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '473'}
2025-04-26 17:28:20,179 - main - INFO - Raw request body length: 473
2025-04-26 17:28:20,179 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:28:20,180 - main - INFO - Parsed JSON: {'message': 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', 'user_id': 3, 'document_ids': [15], 'documentIds': [15], 'context_document_ids': [15], 'support_doc_ids': [15]}
2025-04-26 17:28:20,180 - main - INFO - Extracted message: 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', user_id: 3
2025-04-26 17:28:20,180 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:28:20,180 - main - INFO - Initializing OpenAI model...
2025-04-26 17:28:20,181 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:28:20,181 - main - INFO - Creating OpenAI client...
2025-04-26 17:28:20,182 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:28:20,182 - main - INFO - Trying alternative initialization method
2025-04-26 17:28:20,182 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:28:20,182 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:28:20,183 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:28:20,183 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:28:20,212 - main - INFO - Found 3 relevant documents for query: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,
2025-04-26 17:28:20,212 - main - INFO - Document 1: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:28:20,213 - main - INFO - Document 2: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:28:20,213 - main - INFO - Document 3: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:28:20,214 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:28:20,214 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa, se làm cho xã hội đi tới chỗ khan hiếm và khủng hoảng. Với ỷ nghĩa đó, cần khẳng định, nền sàn xuất hàng hóa có ưu thế tích cực vượt trội so với nền sản xuất tự cấp, tự túc.\n\nKhi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa, se làm cho xã hội đi tới chỗ khan hiếm và khủng hoảng. Với ỷ nghĩa đó, cần khẳng định, nền sàn xuất hàng hóa có ưu thế tích cực vượt trội so với nền sản xuất tự cấp, tự túc.\n\nKhi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa, se làm cho xã hội đi tới chỗ khan hiếm và khủng hoảng. Với ỷ nghĩa đó, cần khẳng định, nền sàn xuất hàng hóa có ưu thế tích cực vượt trội so với nền sản xuất tự cấp, tự túc.', 'query': 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:34:39,498 - main - INFO - Processing document ID: 16, File path: documents/3/1745688872_giao-trinh.txt
2025-04-26 17:34:39,499 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745688872_giao-trinh.txt
2025-04-26 17:34:39,501 - main - INFO - Loading document: /app/storage/documents/3/1745688872_giao-trinh.txt
2025-04-26 17:34:39,501 - main - INFO - Using TextLoader
2025-04-26 17:34:39,504 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 17:34:39,524 - main - INFO - Document split into 818 chunks with chunk_size=60, chunk_overlap=30
2025-04-26 17:34:39,524 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:34:42,354 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:34:42,357 - main - INFO - Creating vector store at /app/vector_db/doc_16
2025-04-26 17:34:44,677 - main - INFO - Vector store created successfully for document 16
2025-04-26 17:34:44,678 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 17:34:44,700 - main - INFO - Integrating document ID: 16
2025-04-26 17:34:44,700 - main - INFO - Integrating document vectors for document ID: 16
2025-04-26 17:34:44,701 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:34:47,102 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:34:47,469 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:34:48,594 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:34:48,598 - main - INFO - Merging document vectors into main vector database
2025-04-26 17:34:48,638 - main - INFO - Saving merged vector database
2025-04-26 17:34:50,281 - main - INFO - Document vectors integrated successfully for document 16
2025-04-26 17:34:50,329 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 17:34:50,334 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 17:34:50,334 - main - INFO - Loading vector store...
2025-04-26 17:34:50,335 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:34:52,727 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:34:53,075 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:34:54,152 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 17:35:58,119 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '226'}
2025-04-26 17:35:58,119 - main - INFO - Raw request body length: 226
2025-04-26 17:35:58,120 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:35:58,120 - main - INFO - Parsed JSON: {'message': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:35:58,120 - main - INFO - Extracted message: 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', user_id: 3
2025-04-26 17:35:58,120 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:35:58,120 - main - INFO - Initializing OpenAI model...
2025-04-26 17:35:58,121 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:35:58,121 - main - INFO - Creating OpenAI client...
2025-04-26 17:35:58,121 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:35:58,121 - main - INFO - Trying alternative initialization method
2025-04-26 17:35:58,122 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:35:58,122 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:35:58,122 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:35:58,126 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:35:58,210 - main - INFO - Found 3 relevant documents for query: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học
2025-04-26 17:35:58,211 - main - INFO - Document 1: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như
2025-04-26 17:35:58,211 - main - INFO - Document 2: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp
2025-04-26 17:35:58,212 - main - INFO - Document 3: thực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về
2025-04-26 17:35:58,212 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:35:58,213 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như\n\nmặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp\n\nthực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về', 'query': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'processing_time': '0.09 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:38:35,313 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '305'}
2025-04-26 17:38:35,315 - main - INFO - Raw request body length: 305
2025-04-26 17:38:35,315 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:38:35,316 - main - INFO - Parsed JSON: {'message': 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:38:35,316 - main - INFO - Extracted message: 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 17:38:35,316 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:38:35,317 - main - INFO - Initializing OpenAI model...
2025-04-26 17:38:35,317 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:38:35,317 - main - INFO - Creating OpenAI client...
2025-04-26 17:38:35,318 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:38:35,318 - main - INFO - Trying alternative initialization method
2025-04-26 17:38:35,318 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:38:35,318 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:38:35,319 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:38:35,319 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:38:35,349 - main - INFO - Found 3 relevant documents for query: Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 17:38:35,350 - main - INFO - Document 1: 6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 17:38:35,350 - main - INFO - Document 2: chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học
2025-04-26 17:38:35,351 - main - INFO - Document 3: tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương
2025-04-26 17:38:35,351 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:38:35,351 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: 6\n\nChương 1\n\nĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN\n\nchính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học\n\ntế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương', 'query': 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '0.04 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:47:51,263 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 17:47:51,280 - main - INFO - Initializing vector database...
2025-04-26 17:47:51,281 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 17:47:51,283 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 17:47:51,283 - main - INFO - Loading vector store...
2025-04-26 17:47:53,376 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:48:00,648 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 17:48:09,781 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:48:09,788 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 17:48:09,805 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 17:48:10,119 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:48:11,353 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 17:48:11,353 - main - INFO - Vector database retriever configured successfully
2025-04-26 17:48:11,354 - main - INFO - Testing retriever with a simple query
2025-04-26 17:48:11,399 - main - INFO - Retriever test successful, found 5 document(s)
2025-04-26 17:48:11,400 - main - INFO - Initializing OpenAI model...
2025-04-26 17:48:11,400 - main - INFO - Initializing OpenAI model...
2025-04-26 17:48:11,400 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:48:11,401 - main - INFO - Creating OpenAI client...
2025-04-26 17:48:11,401 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:48:11,401 - main - INFO - Trying alternative initialization method
2025-04-26 17:48:11,402 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:48:11,402 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:48:11,402 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:48:11,405 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:48:11,406 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 17:48:27,388 - main - INFO - Reloading configuration settings...
2025-04-26 17:48:27,408 - main - INFO - Using provided configuration directly.
2025-04-26 17:48:27,408 - main - INFO - Reinitializing Gemini model...
2025-04-26 17:48:27,408 - main - INFO - Initializing Gemini model...
2025-04-26 17:48:27,409 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 17:48:27,409 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 17:49:06,115 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  Is there anything specific you would like me to do now?

2025-04-26 17:49:06,115 - main - INFO - Gemini model reinitialized successfully
2025-04-26 17:49:06,115 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 17:49:21,801 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '305'}
2025-04-26 17:49:21,802 - main - INFO - Raw request body length: 305
2025-04-26 17:49:21,802 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:49:21,802 - main - INFO - Parsed JSON: {'message': 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:49:21,802 - main - INFO - Extracted message: 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', user_id: 3
2025-04-26 17:49:21,834 - main - INFO - Found 5 relevant documents for query: Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 17:49:21,834 - main - INFO - Document 1: 6

Chương 1

ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 17:49:21,835 - main - INFO - Document 2: chính trị Mác - Lênin; về đối tượng nghiên cứu, phương pháp nghiên cứu và chức năng của khoa học
2025-04-26 17:49:21,835 - main - INFO - Document 3: đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin tất yếu
2025-04-26 17:49:21,835 - main - INFO - Document 4: cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN
2025-04-26 17:49:21,836 - main - INFO - Document 5: ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ
2025-04-26 17:49:57,460 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 17:49:57,460 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu".\n', 'query': 'Chương 1 ĐỐI TƯỢNG, PHƯƠNG PHÁP NGHIÊN cứu VÀ CHƯC NĂNG CỦA KINH TÉ CHÍNH TRỊ MÁC - LÊNIN', 'processing_time': '35.66 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 17:50:25,417 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '226'}
2025-04-26 17:50:25,418 - main - INFO - Raw request body length: 226
2025-04-26 17:50:25,418 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:50:25,419 - main - INFO - Parsed JSON: {'message': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:50:25,419 - main - INFO - Extracted message: 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', user_id: 3
2025-04-26 17:50:25,451 - main - INFO - Found 5 relevant documents for query: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học
2025-04-26 17:50:25,452 - main - INFO - Document 1: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như
2025-04-26 17:50:25,452 - main - INFO - Document 2: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp
2025-04-26 17:50:25,452 - main - INFO - Document 3: luận Mỗi môn khoa học kinh tế có hệ thống phạm trù, khái
2025-04-26 17:50:25,453 - main - INFO - Document 4: thực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về
2025-04-26 17:50:25,453 - main - INFO - Document 5: của Các trong bối cảnh ngày nay. Trên cơ sở hệ thống lý
2025-04-26 17:51:02,239 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 17:51:02,239 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Không có thông tin đủ liên quan". Tôi không tìm thấy thông tin liên quan trong cơ sở dữ liệu.\n', 'query': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'processing_time': '36.82 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 17:51:17,883 - main - INFO - Reloading configuration settings...
2025-04-26 17:51:17,899 - main - INFO - Using provided configuration directly.
2025-04-26 17:51:17,900 - main - INFO - Reinitializing OpenAI model...
2025-04-26 17:51:17,900 - main - INFO - Initializing OpenAI model...
2025-04-26 17:51:17,900 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:51:17,900 - main - INFO - Creating OpenAI client...
2025-04-26 17:51:17,901 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:17,901 - main - INFO - Trying alternative initialization method
2025-04-26 17:51:17,901 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:51:17,902 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:51:17,902 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:17,903 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:51:17,903 - main - WARNING - OpenAI model reinitialization returned None
2025-04-26 17:51:27,056 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '226'}
2025-04-26 17:51:27,057 - main - INFO - Raw request body length: 226
2025-04-26 17:51:27,057 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:51:27,057 - main - INFO - Parsed JSON: {'message': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:51:27,057 - main - INFO - Extracted message: 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', user_id: 3
2025-04-26 17:51:27,058 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:51:27,058 - main - INFO - Initializing OpenAI model...
2025-04-26 17:51:27,058 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:51:27,058 - main - INFO - Creating OpenAI client...
2025-04-26 17:51:27,059 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:27,059 - main - INFO - Trying alternative initialization method
2025-04-26 17:51:27,059 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:51:27,059 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:51:27,060 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:27,060 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:51:27,077 - main - INFO - Found 5 relevant documents for query: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học
2025-04-26 17:51:27,078 - main - INFO - Document 1: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như
2025-04-26 17:51:27,078 - main - INFO - Document 2: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp
2025-04-26 17:51:27,078 - main - INFO - Document 3: luận Mỗi môn khoa học kinh tế có hệ thống phạm trù, khái
2025-04-26 17:51:27,079 - main - INFO - Document 4: thực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về
2025-04-26 17:51:27,079 - main - INFO - Document 5: của Các trong bối cảnh ngày nay. Trên cơ sở hệ thống lý
2025-04-26 17:51:27,080 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:51:27,080 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin đầy đủ về chủ đề này trong cơ sở dữ liệu.', 'query': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:51:48,228 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '473'}
2025-04-26 17:51:48,229 - main - INFO - Raw request body length: 473
2025-04-26 17:51:48,229 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:51:48,229 - main - INFO - Parsed JSON: {'message': 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:51:48,229 - main - INFO - Extracted message: 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', user_id: 3
2025-04-26 17:51:48,230 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:51:48,230 - main - INFO - Initializing OpenAI model...
2025-04-26 17:51:48,230 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:51:48,230 - main - INFO - Creating OpenAI client...
2025-04-26 17:51:48,231 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:48,231 - main - INFO - Trying alternative initialization method
2025-04-26 17:51:48,231 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:51:48,231 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:51:48,232 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:51:48,232 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:51:48,257 - main - INFO - Found 5 relevant documents for query: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,
2025-04-26 17:51:48,257 - main - INFO - Document 1: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:51:48,258 - main - INFO - Document 2: con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ
2025-04-26 17:51:48,258 - main - INFO - Document 3: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:51:48,258 - main - INFO - Document 4: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:51:48,259 - main - INFO - Document 5: Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền...
2025-04-26 17:51:48,259 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:51:48,260 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Tôi không tìm thấy thông tin đầy đủ về chủ đề này trong cơ sở dữ liệu.', 'query': 'Khi còn sự tồn tại của hai diều kiện nêu trên, con người không thể dùng ý chí chù quan mà xóa bỏ nền sản xuất hàng hóa được. Việc cố tình xóa bỏ nền sản xuất hàng hóa,', 'processing_time': '0.03 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:52:52,184 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 17:52:52,201 - main - INFO - Initializing vector database...
2025-04-26 17:52:52,201 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 17:52:52,204 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 17:52:52,204 - main - INFO - Loading vector store...
2025-04-26 17:52:54,308 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 17:53:00,165 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 17:53:08,771 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 17:53:08,789 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 17:53:08,806 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 17:53:09,208 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 17:53:10,306 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 17:53:10,307 - main - INFO - Vector database retriever configured successfully
2025-04-26 17:53:10,307 - main - INFO - Testing retriever with a simple query
2025-04-26 17:53:10,354 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 17:53:10,354 - main - INFO - Initializing OpenAI model...
2025-04-26 17:53:10,355 - main - INFO - Initializing OpenAI model...
2025-04-26 17:53:10,355 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:53:10,355 - main - INFO - Creating OpenAI client...
2025-04-26 17:53:10,356 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:10,356 - main - INFO - Trying alternative initialization method
2025-04-26 17:53:10,356 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:53:10,356 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:53:10,357 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:10,360 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:53:10,360 - main - WARNING - OpenAI model initialization returned None, continuing without model
2025-04-26 17:53:15,879 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '226'}
2025-04-26 17:53:15,881 - main - INFO - Raw request body length: 226
2025-04-26 17:53:15,881 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:53:15,881 - main - INFO - Parsed JSON: {'message': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:53:15,882 - main - INFO - Extracted message: 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', user_id: 3
2025-04-26 17:53:15,882 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:53:15,882 - main - INFO - Initializing OpenAI model...
2025-04-26 17:53:15,883 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:53:15,883 - main - INFO - Creating OpenAI client...
2025-04-26 17:53:15,883 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:15,884 - main - INFO - Trying alternative initialization method
2025-04-26 17:53:15,884 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:53:15,884 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:53:15,884 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:15,885 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:53:15,900 - main - INFO - Found 3 relevant documents for query: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học
2025-04-26 17:53:15,901 - main - INFO - Document 1: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như
2025-04-26 17:53:15,901 - main - INFO - Document 2: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp
2025-04-26 17:53:15,902 - main - INFO - Document 3: thực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về
2025-04-26 17:53:15,902 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:53:15,902 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như\n\nmặt xã hội. Trên cơ sở hệ thống những tri thức khoa học như vậy, kinh tế chính trị Mác - Lênin góp\n\nthực hiện xây dựng hệ thống lý luận kinh tế chính trị mang tính cách mạng, khoa học, toàn diện về', 'query': 'mặt xã hội. Trên cơ sở hệ thống những tri thức khoa học', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:53:54,460 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '321'}
2025-04-26 17:53:54,461 - main - INFO - Raw request body length: 321
2025-04-26 17:53:54,461 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:53:54,461 - main - INFO - Parsed JSON: {'message': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:53:54,462 - main - INFO - Extracted message: 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', user_id: 3
2025-04-26 17:53:54,462 - main - INFO - OpenAI client not initialized, trying to reinitialize...
2025-04-26 17:53:54,462 - main - INFO - Initializing OpenAI model...
2025-04-26 17:53:54,463 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 17:53:54,463 - main - INFO - Creating OpenAI client...
2025-04-26 17:53:54,463 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:54,463 - main - INFO - Trying alternative initialization method
2025-04-26 17:53:54,464 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 17:53:54,464 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 17:53:54,464 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 17:53:54,465 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 17:53:54,484 - main - INFO - Found 3 relevant documents for query: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A
2025-04-26 17:53:54,484 - main - INFO - Document 1: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận
2025-04-26 17:53:54,485 - main - INFO - Document 2: hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A khái quát dựa trên các quan sát mang
2025-04-26 17:53:54,485 - main - INFO - Document 3: chính: Dòng lý thuyết khai thác các luận điểm của A khái
2025-04-26 17:53:54,486 - main - WARNING - Using fallback mode (no openai model available)
2025-04-26 17:53:54,486 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận\n\nhai dòng chính: Dòng lý thuyết khai thác các luận điểm của A khái quát dựa trên các quan sát mang\n\nchính: Dòng lý thuyết khai thác các luận điểm của A khái', 'query': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', 'processing_time': '0.02 seconds', 'model': 'fallback', 'api_status': 'OpenAI API không khả dụng'}
2025-04-26 17:55:38,390 - main - INFO - Reloading configuration settings...
2025-04-26 17:55:38,421 - main - INFO - Using provided configuration directly.
2025-04-26 17:55:38,421 - main - INFO - Reinitializing Gemini model...
2025-04-26 17:55:38,422 - main - INFO - Initializing Gemini model...
2025-04-26 17:55:38,422 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 17:55:38,422 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 17:56:10,710 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you?

2025-04-26 17:56:10,711 - main - INFO - Gemini model reinitialized successfully
2025-04-26 17:56:10,711 - main - INFO - Updated CORS origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 17:58:07,316 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '321'}
2025-04-26 17:58:07,317 - main - INFO - Raw request body length: 321
2025-04-26 17:58:07,317 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:58:07,318 - main - INFO - Parsed JSON: {'message': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:58:07,318 - main - INFO - Extracted message: 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', user_id: 3
2025-04-26 17:58:07,336 - main - INFO - Found 3 relevant documents for query: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A
2025-04-26 17:58:07,336 - main - INFO - Document 1: Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận
2025-04-26 17:58:07,337 - main - INFO - Document 2: hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A khái quát dựa trên các quan sát mang
2025-04-26 17:58:07,337 - main - INFO - Document 3: chính: Dòng lý thuyết khai thác các luận điểm của A khái
2025-04-26 17:58:22,509 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 17:58:22,509 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A..."\n', 'query': 'Kể từ sau A, lỷ luận kinh tế chính trị chia thành hai dòng chính: Dòng lý thuyết khai thác các luận điểm của A', 'processing_time': '15.19 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 17:59:31,288 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '286'}
2025-04-26 17:59:31,289 - main - INFO - Raw request body length: 286
2025-04-26 17:59:31,289 - main - INFO - Used utf-8 encoding for request body
2025-04-26 17:59:31,289 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất?', 'user_id': 3, 'document_ids': [16], 'documentIds': [16], 'context_document_ids': [16], 'support_doc_ids': [16]}
2025-04-26 17:59:31,290 - main - INFO - Extracted message: 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất?', user_id: 3
2025-04-26 17:59:31,341 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất?
2025-04-26 17:59:31,342 - main - INFO - Document 1: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình
2025-04-26 17:59:31,342 - main - INFO - Document 2: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh
2025-04-26 17:59:31,342 - main - INFO - Document 3: nghiên cứu các quan hệ kinh tế trong quá trình tái sản
2025-04-26 17:59:56,268 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 17:59:56,268 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất".\n', 'query': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất?', 'processing_time': '24.98 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:00:25,398 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '285'}
2025-04-26 18:00:25,401 - main - INFO - Raw request body length: 285
2025-04-26 18:00:25,403 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:00:25,404 - main - INFO - Parsed JSON: {'message': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 18:00:25,405 - main - INFO - Extracted message: 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất', user_id: 3
2025-04-26 18:00:25,437 - main - INFO - Found 3 relevant documents for query: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất
2025-04-26 18:00:25,438 - main - INFO - Document 1: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất, trình
2025-04-26 18:00:25,438 - main - INFO - Document 2: Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh
2025-04-26 18:00:25,439 - main - INFO - Document 3: nghiên cứu các quan hệ kinh tế trong quá trình tái sản
2025-04-26 18:00:52,039 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:00:52,039 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: "Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất".\n', 'query': 'Kinh tế chính trị cổ điển Anh nghiên cứu các quan hệ kinh tế trong quá trình tái sản xuất', 'processing_time': '26.63 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:03:36,496 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 18:03:36,512 - main - INFO - Initializing vector database...
2025-04-26 18:03:36,513 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 18:03:36,515 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 18:03:36,515 - main - INFO - Loading vector store...
2025-04-26 18:03:38,565 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:03:45,097 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 18:04:21,739 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 18:04:21,755 - main - INFO - Initializing vector database...
2025-04-26 18:04:21,756 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 18:04:21,758 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 18:04:21,759 - main - INFO - Loading vector store...
2025-04-26 18:04:22,803 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:04:28,023 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 18:04:35,991 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:04:35,999 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 18:04:36,015 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 18:04:36,385 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:04:37,478 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 18:04:37,479 - main - INFO - Vector database retriever configured successfully
2025-04-26 18:04:37,479 - main - INFO - Testing retriever with a simple query
2025-04-26 18:04:37,506 - main - INFO - Retriever test successful, found 3 document(s)
2025-04-26 18:04:37,506 - main - INFO - Initializing Gemini model...
2025-04-26 18:04:37,506 - main - INFO - Initializing Gemini model...
2025-04-26 18:04:37,507 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 18:04:37,507 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 18:05:08,458 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you?

2025-04-26 18:05:08,459 - main - INFO - Gemini model initialized successfully
2025-04-26 18:05:19,928 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '266'}
2025-04-26 18:05:19,929 - main - INFO - Raw request body length: 266
2025-04-26 18:05:19,930 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:05:19,930 - main - INFO - Parsed JSON: {'message': 'Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ phát triển', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 18:05:19,930 - main - INFO - Extracted message: 'Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ phát triển', user_id: 3
2025-04-26 18:05:19,947 - main - INFO - Found 3 relevant documents for query: Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ phát triển
2025-04-26 18:05:19,948 - main - INFO - Document 1: Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ
2025-04-26 18:05:19,948 - main - INFO - Document 2: Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ phát triển, có các hướng xác định tìm
2025-04-26 18:05:19,948 - main - INFO - Document 3: trị, trước Các, ở mỗi thời kỳ phát triển, có các hướng xác
2025-04-26 18:05:36,069 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:05:36,069 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: ở mỗi thời kỳ phát triển, trước Các, có các hướng xác định tìm trị.\n', 'query': 'Trở lại lịch sử kinh tế chính trị, trước Các, ở mỗi thời kỳ phát triển', 'processing_time': '16.14 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:13:02,800 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 18:13:02,818 - main - INFO - Initializing vector database...
2025-04-26 18:13:02,818 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 18:13:02,820 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 18:13:02,820 - main - INFO - Loading vector store...
2025-04-26 18:13:04,938 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:13:12,921 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 18:13:21,694 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:13:21,712 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 18:13:21,728 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 18:13:22,039 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:13:23,162 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 18:13:23,163 - main - INFO - Vector database retriever configured with MMR for better diversity and relevance
2025-04-26 18:13:23,163 - main - INFO - Testing retriever with a simple query
2025-04-26 18:13:23,194 - main - INFO - Retriever test successful, found 5 document(s)
2025-04-26 18:13:23,194 - main - INFO - Initializing Gemini model...
2025-04-26 18:13:23,194 - main - INFO - Initializing Gemini model...
2025-04-26 18:13:23,195 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 18:13:23,195 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 18:13:50,902 - main - INFO - Gemini model test response: The connection appears to be working.  How can I help you today?

2025-04-26 18:13:50,902 - main - INFO - Gemini model initialized successfully
2025-04-26 18:18:48,103 - main - INFO - CORS enabled for origins: ['http://localhost:8000', 'http://127.0.0.1:8000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080', '*']
2025-04-26 18:18:48,120 - main - INFO - Initializing vector database...
2025-04-26 18:18:48,120 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 18:18:48,122 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 18:18:48,122 - main - INFO - Loading vector store...
2025-04-26 18:18:50,177 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:18:57,160 - huggingface_hub.file_download - WARNING - Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
2025-04-26 18:19:05,382 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:19:05,400 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-26 18:19:05,417 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-26 18:19:05,805 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:19:06,891 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 18:19:06,892 - main - INFO - Vector database retriever configured with MMR for better diversity and relevance
2025-04-26 18:19:06,892 - main - INFO - Testing retriever with a simple query
2025-04-26 18:19:06,934 - main - INFO - Retriever test successful, found 5 document(s)
2025-04-26 18:19:06,934 - main - INFO - Initializing Gemini model...
2025-04-26 18:19:06,935 - main - INFO - Initializing Gemini model...
2025-04-26 18:19:06,935 - main - INFO - Using API key: AIzaS...FUdVw (middle part hidden)
2025-04-26 18:19:06,936 - main - INFO - Initializing Gemini model: gemini-1.5-pro
2025-04-26 18:19:17,504 - main - INFO - Gemini model test response: The connection appears to be working.  I've received your message and am able to respond.  How can I help you today?

2025-04-26 18:19:17,504 - main - INFO - Gemini model initialized successfully
2025-04-26 18:19:45,401 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '289'}
2025-04-26 18:19:45,402 - main - INFO - Raw request body length: 289
2025-04-26 18:19:45,402 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:19:45,402 - main - INFO - Parsed JSON: {'message': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải là quan hộ thuộc một lĩnh vực', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 18:19:45,403 - main - INFO - Extracted message: 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải là quan hộ thuộc một lĩnh vực', user_id: 3
2025-04-26 18:19:45,437 - main - INFO - Found 5 relevant documents for query: Đối tượng nghiên cứu cùa kinh tế chính trị không phải là quan hộ thuộc một lĩnh vực
2025-04-26 18:19:45,437 - main - INFO - Document 1 (score: N/A): Đối tượng nghiên cứu cùa kinh tế chính trị không phải là quan hộ thuộc một lĩnh vực, một khía cạnh
2025-04-26 18:19:45,438 - main - INFO - Document 2 (score: N/A): Đối tượng nghiên cứu cùa kinh tế chính trị là các quan hệ
2025-04-26 18:19:45,438 - main - INFO - Document 3 (score: N/A): tế chính trị không phải là quan hộ thuộc một lĩnh vực, một
2025-04-26 18:19:45,438 - main - INFO - Document 4 (score: N/A): Đối tượng nghiên cứu cùa kinh tế chính trị không phải là
2025-04-26 18:19:45,439 - main - INFO - Document 5 (score: N/A): trị cồ điển Anh vào lĩnh vực lý luận kinh tế chính trị cùa
2025-04-26 18:20:03,996 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:20:03,996 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Đối tượng nghiên cứu của kinh tế chính trị **không phải** là quan hệ thuộc một lĩnh vực, một khía cạnh.  Các đoạn thông tin được cung cấp đều lặp lại và nhấn mạnh điều này.  Mặc dù các đoạn văn bản bị cắt xén và không đầy đủ, nhưng chúng đều thống nhất về ý chính là đối tượng nghiên cứu của kinh tế chính trị bao hàm nhiều lĩnh vực và khía cạnh khác nhau, chứ không chỉ giới hạn trong một lĩnh vực đơn lẻ.\n', 'query': 'Đối tượng nghiên cứu cùa kinh tế chính trị không phải là quan hộ thuộc một lĩnh vực', 'processing_time': '18.59 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:21:44,970 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '387'}
2025-04-26 18:21:44,971 - main - INFO - Raw request body length: 387
2025-04-26 18:21:44,971 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:21:44,971 - main - INFO - Parsed JSON: {'message': 'Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực lượng sản xuất mà còn', 'user_id': 3, 'document_ids': [14], 'documentIds': [14], 'context_document_ids': [14], 'support_doc_ids': [14]}
2025-04-26 18:21:44,971 - main - INFO - Extracted message: 'Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực lượng sản xuất mà còn', user_id: 3
2025-04-26 18:21:45,025 - main - INFO - Found 5 relevant documents for query: Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực lượng sản xuất mà còn
2025-04-26 18:21:45,026 - main - INFO - Document 1 (score: N/A): Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực
2025-04-26 18:21:45,026 - main - INFO - Document 2 (score: N/A): Các quan hệ của sản xuất và trao đổi chịu sự tác động biện
2025-04-26 18:21:45,027 - main - INFO - Document 3 (score: N/A): của không chỉ bởi trình độ của lực lượng sản xuất mà còn cả
2025-04-26 18:21:45,027 - main - INFO - Document 4 (score: N/A): các quan hệ của sàn xuất và trao đổi trong phương thức sản xuất mà các quan hệ đó hình thành và
2025-04-26 18:21:45,027 - main - INFO - Document 5 (score: N/A): xã hội của sản xuất và trao đổi trong mối liên hệ biện chứng với trình độ của lực lượng sản xuất và
2025-04-26 18:22:07,852 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:22:07,852 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực lượng sản xuất mà còn cả các quan hệ của sản xuất và trao đổi trong phương thức sản xuất mà các quan hệ đó hình thành và xã hội của sản xuất và trao đổi trong mối liên hệ biện chứng với trình độ của lực lượng sản xuất.\n\nCó vẻ như dữ liệu được cung cấp bị phân mảnh và lặp lại, khiến việc xác định yếu tố "mà còn cả" một cách chính xác trở nên khó khăn.  Các đoạn văn bản đều nhấn mạnh sự ảnh hưởng biện chứng của lực lượng sản xuất lên quan hệ sản xuất và trao đổi, nhưng lại không nói rõ yếu tố bổ sung nào khác.  Chúng ta có thể suy luận rằng "mà còn cả" ám chỉ đến sự tương tác phức tạp giữa các quan hệ sản xuất và trao đổi với chính bản thân chúng trong một phương thức sản xuất cụ thể và trong bối cảnh xã hội rộng lớn hơn.  Nói cách khác, không chỉ lực lượng sản xuất định hình quan hệ sản xuất và trao đổi, mà chính các quan hệ này cũng tác động lẫn nhau và chịu ảnh hưởng bởi cấu trúc xã hội mà chúng tồn tại.\n', 'query': 'Các quan hệ của sản xuất và trao đổi chịu sự tác động biện chứng của không chỉ bởi trình độ của lực lượng sản xuất mà còn', 'processing_time': '22.88 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:33:56,640 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:33:56,643 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:33:56,646 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:33:56,646 - main - INFO - Using Docx2txtLoader
2025-04-26 18:33:56,649 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:34:05,336 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:34:05,337 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:34:05,338 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:34:05,339 - main - INFO - Using Docx2txtLoader
2025-04-26 18:34:05,341 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:35:08,069 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:35:08,070 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:35:08,071 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:35:08,072 - main - INFO - Using Docx2txtLoader
2025-04-26 18:35:08,074 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:36:58,517 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '313'}
2025-04-26 18:36:58,518 - main - INFO - Raw request body length: 313
2025-04-26 18:36:58,519 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:36:58,519 - main - INFO - Parsed JSON: {'message': 'Bưởi Việt Nam chính thức có mặt trên kệ siêu thị Hàn Quốc, triển vọng tăng trưởng khả quan', 'user_id': 3, 'document_ids': [15, 16], 'documentIds': [15, 16], 'context_document_ids': [15, 16], 'support_doc_ids': [15, 16]}
2025-04-26 18:36:58,519 - main - INFO - Extracted message: 'Bưởi Việt Nam chính thức có mặt trên kệ siêu thị Hàn Quốc, triển vọng tăng trưởng khả quan', user_id: 3
2025-04-26 18:36:58,569 - main - INFO - Found 5 relevant documents for query: Bưởi Việt Nam chính thức có mặt trên kệ siêu thị Hàn Quốc, triển vọng tăng trưởng khả quan
2025-04-26 18:36:58,569 - main - INFO - Document 1 (score: N/A): Theo dự báo của Tổ chức Hợp tác và Phát triển Kinh tế (OECD), tiêu thụ thịt heo tại Việt Nam năm 202...
2025-04-26 18:36:58,570 - main - INFO - Document 2 (score: N/A): TITLE: Bưởi Việt Nam chính thức có mặt trên kệ siêu thị Hàn Quốc, triển vọng tăng trưởng khả quan

U...
2025-04-26 18:36:58,570 - main - INFO - Document 3 (score: N/A): là A, kinh tế chính trị chính thức trở thành môn học với các phạm trù, khái niệm chuyên ngành. Từ
2025-04-26 18:36:58,570 - main - INFO - Document 4 (score: N/A): Trước mắt, có thể một số ngành phải hy sinh lợi ích ngắn hạn, nhưng phần thưởng dài hạn là một nền k...
2025-04-26 18:36:58,571 - main - INFO - Document 5 (score: N/A): TapTap là nền tảng khách hàng thân thiết, do Công ty TNHH Thương mại Vui Việt Nam phát triển và đầu ...
2025-04-26 18:37:03,146 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:37:03,146 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Bưởi Việt Nam đã chính thức có mặt trên kệ siêu thị Lotte Mart tại Hàn Quốc. Sự kiện này đánh dấu một bước tiến quan trọng trong việc xuất khẩu nông sản Việt Nam sang thị trường Hàn Quốc, cho thấy chất lượng nông sản Việt Nam đáp ứng được yêu cầu khắt khe của thị trường quốc tế.  Sự kiện có sự tham gia của đại diện Thương vụ Việt Nam tại Hàn Quốc, đại diện Công ty TNHH MTV Hoàng Huy (đơn vị xuất khẩu) và lãnh đạo cấp cao của Lotte Mart.  Việc này không chỉ minh chứng cho chất lượng nông sản Việt Nam mà còn khẳng định nỗ lực thúc đẩy hợp tác kinh tế giữa hai nước.  Triển vọng tăng trưởng cho xuất khẩu bưởi Việt Nam sang Hàn Quốc được đánh giá là khả quan.\n\nThông tin cung cấp không đề cập đến tiêu thụ thịt heo, nền tảng TapTap hay các vấn đề kinh tế chính trị khác.  Vì vậy, câu trả lời chỉ tập trung vào thông tin liên quan đến việc bưởi Việt Nam xuất khẩu sang Hàn Quốc.\n', 'query': 'Bưởi Việt Nam chính thức có mặt trên kệ siêu thị Hàn Quốc, triển vọng tăng trưởng khả quan', 'processing_time': '4.63 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:41:23,456 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:41:23,457 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:41:23,459 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:41:23,459 - main - INFO - Using Docx2txtLoader
2025-04-26 18:41:23,462 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:41:28,122 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:41:28,122 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:41:28,124 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:41:28,124 - main - INFO - Using Docx2txtLoader
2025-04-26 18:41:28,127 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:43:22,026 - main - INFO - Processing document ID: 17, File path: documents/3/1745692430_openai.docx
2025-04-26 18:43:22,027 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:43:22,029 - main - INFO - Loading document: /app/storage/documents/3/1745692430_openai.docx
2025-04-26 18:43:22,029 - main - INFO - Using Docx2txtLoader
2025-04-26 18:43:22,032 - main - ERROR - Error loading document: No module named 'docx2txt'
2025-04-26 18:43:31,558 - main - INFO - Processing document ID: 18, File path: documents/3/1745692983_openai.txt
2025-04-26 18:43:31,558 - main - INFO - Sử dụng đường dẫn tương đối: /app/storage/documents/3/1745692983_openai.txt
2025-04-26 18:43:31,561 - main - INFO - Loading document: /app/storage/documents/3/1745692983_openai.txt
2025-04-26 18:43:31,562 - main - INFO - Using TextLoader
2025-04-26 18:43:31,564 - main - INFO - Document loaded successfully, pages/chunks: 1
2025-04-26 18:43:31,566 - main - INFO - Document split into 28 chunks with chunk_size=100, chunk_overlap=50
2025-04-26 18:43:31,567 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:43:35,026 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:43:35,029 - main - INFO - Creating vector store at /app/vector_db/doc_18
2025-04-26 18:43:35,173 - main - INFO - Vector store created successfully for document 18
2025-04-26 18:43:35,173 - main - ERROR - Test query failed: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-04-26 18:43:35,194 - main - INFO - Integrating document ID: 18
2025-04-26 18:43:35,195 - main - INFO - Integrating document vectors for document ID: 18
2025-04-26 18:43:35,196 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:43:37,543 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:43:38,033 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:43:39,570 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:43:39,571 - main - INFO - Merging document vectors into main vector database
2025-04-26 18:43:39,621 - main - INFO - Saving merged vector database
2025-04-26 18:43:41,032 - main - INFO - Document vectors integrated successfully for document 18
2025-04-26 18:43:41,082 - main - INFO - Attempting to initialize vector database from /app/vector_db
2025-04-26 18:43:41,085 - main - INFO - Found vector store files at /app/vector_db
2025-04-26 18:43:41,085 - main - INFO - Loading vector store...
2025-04-26 18:43:41,085 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-04-26 18:43:43,412 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
2025-04-26 18:43:43,783 - main - INFO - ALLOW_PICKLE=true, enabling pickle loading for vector database
2025-04-26 18:43:45,377 - main - INFO - Vector store loaded successfully with allow_dangerous_deserialization=True
2025-04-26 18:44:39,773 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '135'}
2025-04-26 18:44:39,774 - main - INFO - Raw request body length: 135
2025-04-26 18:44:39,774 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:44:39,774 - main - INFO - Parsed JSON: {'message': 'open ai', 'user_id': 3, 'document_ids': [18, 16], 'documentIds': [18, 16], 'context_document_ids': [18, 16], 'support_doc_ids': [18, 16]}
2025-04-26 18:44:39,774 - main - INFO - Extracted message: 'open ai', user_id: 3
2025-04-26 18:44:39,854 - main - INFO - Found 5 relevant documents for query: open ai
2025-04-26 18:44:39,854 - main - INFO - Document 1 (score: N/A): bước tiến vượt bậc trong lĩnh vực học sâu (deep learning), xử lý ngôn ngữ tự nhiên (NLP), và đặc
2025-04-26 18:44:39,855 - main - INFO - Document 2 (score: N/A): bảo rằng trí tuệ nhân tạo tổng quát mang lại lợi ích cho toàn nhân loại." OpenAI nổi bật nhờ những
2025-04-26 18:44:39,855 - main - INFO - Document 3 (score: N/A): "AI agents", hay còn gọi là trí tuệ nhân tạo tác nhân, cho phép doanh nghiệp thiết kế mô hình ngôn n...
2025-04-26 18:44:39,856 - main - INFO - Document 4 (score: N/A): ích cho toàn nhân loại." OpenAI nổi bật nhờ những bước tiến vượt bậc trong lĩnh vực học sâu (deep
2025-04-26 18:44:39,856 - main - INFO - Document 5 (score: N/A): Ông Michael Intrator từ CoreWeave dự đoán sự rút lui của Microsoft có thể do tình hình cụ thể tại cô...
2025-04-26 18:44:46,565 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:44:46,566 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: OpenAI là một công ty nổi bật nhờ "những bước tiến vượt bậc trong lĩnh vực học sâu (deep learning), xử lý ngôn ngữ tự nhiên (NLP)" và đặt mục tiêu "bảo đảm rằng trí tuệ nhân tạo tổng quát mang lại lợi ích cho toàn nhân loại."  Một trong những thành tựu đáng chú ý của OpenAI là phát triển "AI agents" (trí tuệ nhân tạo tác nhân). Công nghệ này cho phép doanh nghiệp sử dụng mô hình ngôn ngữ lớn (LLMs) để tự động hóa các nhiệm vụ.  Các đối thủ cạnh tranh như Google Cloud (với Vertex AI), LinkedIn, Microsoft, và sắp tới có thể là Google Gemini (với Project Jarvis) cũng đang phát triển công nghệ tương tự.\n\nSự xuất hiện của AI agents đã tạo ra nhiều ý kiến trái chiều.  Một số người tỏ ra lạc quan, tin rằng đây là một "bước thay đổi lớn" cho phép tạo ra nhiều loại trợ lý cá nhân đáng tin cậy hơn.  Tuy nhiên, cũng có những lo ngại về việc trao quá nhiều quyền kiểm soát và công việc cho AI.\n\nMặc dù thông tin không đề cập trực tiếp đến tất cả hoạt động của OpenAI, nhưng đoạn trích về việc Microsoft có thể rút lui khỏi một số hợp tác (dù không rõ chi tiết và được cho là do "vấn đề nội bộ") cho thấy mối quan hệ phức tạp và  liên tục thay đổi giữa các công ty công nghệ trong lĩnh vực AI.\n', 'query': 'open ai', 'processing_time': '6.79 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:47:03,311 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '275'}
2025-04-26 18:47:03,312 - main - INFO - Raw request body length: 275
2025-04-26 18:47:03,312 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:47:03,313 - main - INFO - Parsed JSON: {'message': 'Do vậy, khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin', 'user_id': 3, 'document_ids': [18, 16], 'documentIds': [18, 16], 'context_document_ids': [18, 16], 'support_doc_ids': [18, 16]}
2025-04-26 18:47:03,313 - main - INFO - Extracted message: 'Do vậy, khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin', user_id: 3
2025-04-26 18:47:03,383 - main - INFO - Found 5 relevant documents for query: Do vậy, khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin
2025-04-26 18:47:03,383 - main - INFO - Document 1 (score: N/A): Do vậy, khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin tất yếu đặt các quan hệ xã
2025-04-26 18:47:03,384 - main - INFO - Document 2 (score: N/A): tế chính trị Mác - Lênin; về đối tượng nghiên cứu, phương
2025-04-26 18:47:03,384 - main - INFO - Document 3 (score: N/A): ứng. Do vậy, khi xác định đối tượng nghiên cứu, kinh tế
2025-04-26 18:47:03,384 - main - INFO - Document 4 (score: N/A): cô điên, kinh tế chỉnh trị Mác - Lênin, quan hệ xẫ hội của
2025-04-26 18:47:03,384 - main - INFO - Document 5 (score: N/A): đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin tất yếu
2025-04-26 18:47:06,415 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:47:06,415 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin tất yếu đặt các quan hệ xã hội làm trọng tâm.  Thông tin được lặp lại nhiều lần trong các đoạn văn bản được cung cấp, nhấn mạnh tầm quan trọng của các quan hệ xã hội trong việc nghiên cứu kinh tế chính trị Mác - Lênin.  Mặc dù có một số đoạn văn bản bị cắt xén hoặc chứa các từ không liên quan (như "cô điên"), ý chính vẫn rõ ràng và nhất quán.\n', 'query': 'Do vậy, khi xác định đối tượng nghiên cứu, kinh tế chính trị Mác - Lênin', 'processing_time': '3.10 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:49:16,678 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '164'}
2025-04-26 18:49:16,679 - main - INFO - Raw request body length: 164
2025-04-26 18:49:16,679 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:49:16,680 - main - INFO - Parsed JSON: {'message': 'lịch sử thế giới', 'user_id': 3, 'document_ids': [18, 16], 'documentIds': [18, 16], 'context_document_ids': [18, 16], 'support_doc_ids': [18, 16]}
2025-04-26 18:49:16,680 - main - INFO - Extracted message: 'lịch sử thế giới', user_id: 3
2025-04-26 18:49:16,713 - main - INFO - Found 5 relevant documents for query: lịch sử thế giới
2025-04-26 18:49:16,714 - main - INFO - Document 1 (score: N/A): Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể
2025-04-26 18:49:16,714 - main - INFO - Document 2 (score: N/A): trị Mác - Lênin cần vận dụng thành thạo phép biện chứng duy
2025-04-26 18:49:16,714 - main - INFO - Document 3 (score: N/A): về lịch sử, Các và Ph.Ăngghen xác định:
2025-04-26 18:49:16,715 - main - INFO - Document 4 (score: N/A): thù trình độ phát triển ứng với mỗi giai đoạn lịch sử, mỗi
2025-04-26 18:49:16,715 - main - INFO - Document 5 (score: N/A): đại lịch sử..ôn kinh tế chính trị, về thực chất là một môn khoa học có tính lịch sử... nó nghiên
2025-04-26 18:49:22,038 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:49:22,039 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Thông tin được cung cấp đề cập đến sự tách biệt về mặt kinh tế trong lịch sử, tầm quan trọng của phép biện chứng duy vật trong việc phân tích lịch sử theo quan điểm Mác - Lênin, và tính chất lịch sử của môn kinh tế chính trị.  Cụ thể, "sự tách biệt về mặt kinh tế giữa các chủ thể" được nhắc đến, nhưng không được giải thích rõ ràng. Việc vận dụng phép biện chứng duy vật được nhấn mạnh, cho rằng cần phải xem xét "trình độ phát triển ứng với mỗi giai đoạn lịch sử".  Cuối cùng, khẳng định rằng "kinh tế chính trị, về thực chất là một môn khoa học có tính lịch sử".\n\nTuy nhiên, các đoạn thông tin này rời rạc và không cung cấp đủ ngữ cảnh để trả lời câu hỏi về lịch sử thế giới một cách đầy đủ.  Chúng chỉ cung cấp những mảnh ghép nhỏ liên quan đến phương pháp luận phân tích lịch sử theo Mác - Lênin, chứ không phải là bức tranh toàn cảnh về lịch sử thế giới.  Để trả lời câu hỏi về lịch sử thế giới, cần nhiều thông tin hơn, bao quát các sự kiện, quá trình lịch sử, và các diễn giải khác nhau.\n', 'query': 'lịch sử thế giới', 'processing_time': '5.36 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:50:07,352 - main - INFO - Request headers: {'host': 'localhost:55050', 'user-agent': 'GuzzleHttp/7', 'accept': 'application/json', 'content-type': 'application/json', 'content-length': '145'}
2025-04-26 18:50:07,353 - main - INFO - Raw request body length: 145
2025-04-26 18:50:07,353 - main - INFO - Used utf-8 encoding for request body
2025-04-26 18:50:07,354 - main - INFO - Parsed JSON: {'message': 'hóa học', 'user_id': 3, 'document_ids': [18, 16], 'documentIds': [18, 16], 'context_document_ids': [18, 16], 'support_doc_ids': [18, 16]}
2025-04-26 18:50:07,354 - main - INFO - Extracted message: 'hóa học', user_id: 3
2025-04-26 18:50:07,399 - main - INFO - Found 5 relevant documents for query: hóa học
2025-04-26 18:50:07,400 - main - INFO - Document 1 (score: N/A): LÊ HOA
2025-04-26 18:50:07,400 - main - INFO - Document 2 (score: N/A): hiận khoa học của A, tiếp tục bo sung, hoàn chỉnh nội dung
2025-04-26 18:50:07,401 - main - INFO - Document 3 (score: N/A): Thu Hòa
2025-04-26 18:50:07,401 - main - INFO - Document 4 (score: N/A): Hoài Phương
2025-04-26 18:50:07,401 - main - INFO - Document 5 (score: N/A): MAI HOÀNG
2025-04-26 18:50:09,925 - main - INFO - Received response from Gemini API (gemini-1.5-pro)
2025-04-26 18:50:09,925 - main - INFO - Chat response: {'success': True, 'answer': 'Theo dữ liệu tìm được: Dữ liệu được cung cấp bao gồm tên riêng của một số người (Lê Hoa, Thu Hòa, Hoài Phương, Mai Hoàng) và một cụm từ "hiện khoa học của A, tiếp tục bổ sung, hoàn chỉnh nội dung".  Không có thông tin nào liên quan trực tiếp đến câu hỏi về "hóa học". Do đó, không thể trả lời câu hỏi dựa trên thông tin được cung cấp.\n', 'query': 'hóa học', 'processing_time': '2.57 seconds', 'model': 'gemini-1.5-pro'}
2025-04-26 18:55:24,200 - main - INFO - Reloading configuration settings...
2025-04-26 18:55:24,228 - main - INFO - Using provided configuration directly.
2025-04-26 18:55:24,228 - main - INFO - Reinitializing OpenAI model...
2025-04-26 18:55:24,229 - main - INFO - Initializing OpenAI model...
2025-04-26 18:55:24,229 - main - INFO - Using API key: sk-p...wCMA (middle part hidden)
2025-04-26 18:55:24,229 - main - INFO - Creating OpenAI client...
2025-04-26 18:55:24,230 - main - WARNING - Modern OpenAI client initialization failed: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 18:55:24,230 - main - INFO - Trying alternative initialization method
2025-04-26 18:55:24,230 - main - INFO - OpenAI client initialized with alternative method
2025-04-26 18:55:24,231 - main - INFO - Testing OpenAI connection with model: gpt-4o-mini
2025-04-26 18:55:24,231 - main - ERROR - Error testing OpenAI connection: __init__() got an unexpected keyword argument 'proxies'
2025-04-26 18:55:24,235 - main - ERROR - Traceback (most recent call last):
  File "/app/main.py", line 327, in initialize_openai
    if hasattr(client, 'chat') and hasattr(client.chat, 'completions'):
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 20, in __getattr__
    proxied = self.__get_proxied__()
  File "/usr/local/lib/python3.9/site-packages/openai/_utils/_proxy.py", line 55, in __get_proxied__
    return self.__load__()
  File "/usr/local/lib/python3.9/site-packages/openai/_module_client.py", line 12, in __load__
    return _load_client().chat
  File "/usr/local/lib/python3.9/site-packages/openai/__init__.py", line 297, in _load_client
    _client = _ModuleClient(
  File "/usr/local/lib/python3.9/site-packages/openai/_client.py", line 112, in __init__
    super().__init__(
  File "/usr/local/lib/python3.9/site-packages/openai/_base_client.py", line 793, in __init__
    self._client = http_client or SyncHttpxClientWrapper(
TypeError: __init__() got an unexpected keyword argument 'proxies'

2025-04-26 18:55:24,235 - main - WARNING - OpenAI model reinitialization returned None
2025-05-06 20:33:37 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 20:33:37 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:33:38 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 20:33:38 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:33:38 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 20:33:38 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 20:34:00 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 20:34:03 [app.services.chatbot] INFO: Vector database loaded with 67524 vectors
2025-05-06 20:34:03 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 20:34:03 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 20:34:04 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 20:34:50 [app.services.chatbot] INFO: Xử lý tài liệu ID: 55, Đường dẫn: documents/3/1746563688_bai-giang-kinh-te-vi-mo-1.docx
2025-05-06 20:34:50 [app.services.chatbot] INFO: Thư mục hiện tại: /app, Docker: True
2025-05-06 20:34:50 [app.services.chatbot] INFO: Kiểm tra đường dẫn Laravel: /app/web/public/storage/documents/55/1746563688_bai-giang-kinh-te-vi-mo-1.docx
2025-05-06 20:34:50 [app.services.chatbot] INFO: Kiểm tra đường dẫn Laravel: /app/web/public/storage/documents/3/1746563688_bai-giang-kinh-te-vi-mo-1.docx
2025-05-06 20:34:50 [app.services.chatbot] INFO: Tìm thấy file trong Laravel storage: /app/web/public/storage/documents/3/1746563688_bai-giang-kinh-te-vi-mo-1.docx
2025-05-06 20:34:50 [app.services.chatbot] INFO: Bắt đầu tạo vector cho tài liệu 55, người dùng: 0 với chunk_size=100, chunk_overlap=50
2025-05-06 20:34:50 [app.services.chatbot] INFO: Đang trích xuất văn bản từ tài liệu: /app/web/public/storage/documents/3/1746563688_bai-giang-kinh-te-vi-mo-1.docx, loại: application/vnd.openxmlformats-officedocument.wordprocessingml.document
2025-05-06 20:34:52 [app.services.chatbot] INFO: Đã trích xuất 134 trang từ tài liệu
2025-05-06 20:35:12 [app.services.chatbot] INFO: Đã tạo vector thành công cho tài liệu 55 với 4608 chunks
2025-05-06 20:35:12 [app.services.chatbot] INFO: Đang tích hợp vector của tài liệu ID: 55
2025-05-06 20:35:16 [app.services.chatbot] INFO: Đang kết hợp vector của tài liệu vào vector database chính
2025-05-06 20:35:16 [app.services.chatbot] INFO: Lưu vector database đã kết hợp
2025-05-06 20:35:18 [app.services.chatbot] INFO: Tích hợp vector thành công cho tài liệu 55
2025-05-06 20:35:18 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 20:35:21 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 20:35:22 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 20:35:22 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 20:36:42 [app.services.api_service] INFO: Query gốc: 'kinh tế vĩ mô là gì'
2025-05-06 20:36:45 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.017s
2025-05-06 20:36:45 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.05940844118595123, 0.03986666351556778, 0.05720529705286026, 0.0012687597190961242, -0.07618250697851181]...
2025-05-06 20:36:45 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 20:36:45 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 20:36:45 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 20:36:45 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 3, 'chunk_index': 11, 'content': 'Kinh tế học vi mô và kinh tế học vĩ mô', 'url': '/documents/55?page=3&highlight=11'}
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 1 - Preview: Kinh tế học vi mô và kinh tế học vĩ mô
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 61, 'chunk_index': 1, 'content': 'biên là gì? Mối quan hệ giữa tổng hữu dụng và hữu dụng biên?', 'url': '/documents/55?page=61&highlight=1'}
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 2 - Preview: biên là gì? Mối quan hệ giữa tổng hữu dụng và hữu dụng biên?
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 93, 'chunk_index': 4, 'content': 'Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?', 'url': '/documents/55?page=93&highlight=4'}
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 3 - Preview: Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 4 - Preview: Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 20:36:45 [app.services.api_service] INFO: Tài liệu 5 - Preview: hệ kinh tế ở lĩnh vực nông nghiệp; kinh tế chính trị cổ
2025-05-06 20:36:45 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 20:36:46 [app.services.api_service] INFO: Google API response received in 1.16 seconds
2025-05-06 20:36:46 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 20:42:05 [app.services.api_service] INFO: Query gốc: 'kinh tế vi mô là gì'
2025-05-06 20:42:08 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.010s
2025-05-06 20:42:08 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.05940844118595123, 0.03986666351556778, 0.05720529705286026, 0.0012687597190961242, -0.07618250697851181]...
2025-05-06 20:42:08 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 20:42:08 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 20:42:08 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 20:42:08 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 3, 'chunk_index': 11, 'content': 'Kinh tế học vi mô và kinh tế học vĩ mô', 'url': '/documents/55?page=3&highlight=11'}
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 1 - Preview: Kinh tế học vi mô và kinh tế học vĩ mô
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 61, 'chunk_index': 1, 'content': 'biên là gì? Mối quan hệ giữa tổng hữu dụng và hữu dụng biên?', 'url': '/documents/55?page=61&highlight=1'}
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 2 - Preview: biên là gì? Mối quan hệ giữa tổng hữu dụng và hữu dụng biên?
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 93, 'chunk_index': 4, 'content': 'Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?', 'url': '/documents/55?page=93&highlight=4'}
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 3 - Preview: Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 4 - Preview: Trong lịch sử, sự tách biệt về mặt kinh tế giữa các chủ thể
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 20:42:08 [app.services.api_service] INFO: Tài liệu 5 - Preview: hệ kinh tế ở lĩnh vực nông nghiệp; kinh tế chính trị cổ
2025-05-06 20:42:08 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 20:42:09 [app.services.api_service] INFO: Google API response received in 1.05 seconds
2025-05-06 20:42:09 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 20:56:47 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 20:56:47 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:56:47 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 20:56:47 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:56:47 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 20:56:47 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 20:56:53 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 20:56:54 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 20:56:54 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 20:56:54 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 20:56:57 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 20:58:24 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 20:58:24 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:58:24 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 20:58:24 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 20:58:24 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 20:58:24 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 20:58:40 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 20:58:47 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 20:58:47 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 20:58:47 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 20:58:49 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 21:00:34 [app.services.api_service] INFO: Query gốc: 'kinh tế học là gì'
2025-05-06 21:00:36 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.085s
2025-05-06 21:00:36 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.044227056205272675, 0.05768842250108719, 0.0477779395878315, -0.016408640891313553, -0.03367413207888603]...
2025-05-06 21:00:36 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 21:00:36 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 21:00:36 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 21:00:36 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 1 - Preview: Như vậy, có thề rút ra: Kinh tế chỉnh trị là môn khoa học
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 93, 'chunk_index': 4, 'content': 'Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?', 'url': '/documents/55?page=93&highlight=4'}
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 2 - Preview: Tính kinh tế và phi kinh tế theo quy mô là gì ? Tại sao nó lại xuất hiện ?
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 11, 'chunk_index': 4, 'content': 'Chủ thể kinh tế của thị trường', 'url': '/documents/55?page=11&highlight=4'}
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 3 - Preview: Chủ thể kinh tế của thị trường
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 4 - Preview: Giữa quy luật kinh tế và chính sách kinh tế có sự phân
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 3, 'chunk_index': 12, 'content': 'Kinh tế học vi mô là một bộ phận của kinh tế học', 'url': '/documents/55?page=3&highlight=12'}
2025-05-06 21:00:36 [app.services.api_service] INFO: Tài liệu 5 - Preview: Kinh tế học vi mô là một bộ phận của kinh tế học
2025-05-06 21:00:36 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 21:00:38 [app.services.api_service] INFO: Google API response received in 1.58 seconds
2025-05-06 21:00:38 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 21:47:45 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 21:47:45 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 21:47:45 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 21:47:45 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 21:47:45 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 21:47:45 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 21:48:03 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 21:48:06 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 21:48:06 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 21:48:06 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 21:48:08 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 21:49:40 [app.services.api_service] INFO: Query gốc: 'Thị trường cạnh tranh hoàn toàn'
2025-05-06 21:49:43 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.164s
2025-05-06 21:49:43 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.06926178932189941, 0.08047371357679367, -0.044885165989398956, -0.06434948742389679, -0.007962273433804512]...
2025-05-06 21:49:43 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 21:49:43 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 21:49:43 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 21:49:43 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 133, 'chunk_index': 17, 'content': 'Thị trường cạnh tranh độc quyền\tC. Thị trường cạnh tranh hoàn toàn', 'url': '/documents/55?page=133&highlight=17'}
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 1 - Preview: Thị trường cạnh tranh độc quyền	C. Thị trường cạnh tranh hoàn toàn
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 1, 'chunk_index': 25, 'content': 'của doanh nghiệp Chương 6: Thị trường cạnh tranh hoàn hảo', 'url': '/documents/55?page=1&highlight=25'}
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 2 - Preview: của doanh nghiệp Chương 6: Thị trường cạnh tranh hoàn hảo
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 95, 'chunk_index': 26, 'content': 'PHÂN TÍCH TRONG NGẮN HẠN\n\nCân bằng thị trường cạnh tranh hoàn hảo', 'url': '/documents/55?page=95&highlight=26'}
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 3 - Preview: PHÂN TÍCH TRONG NGẮN HẠN

Cân bằng thị trường cạnh tranh hoàn hảo
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 11, 'chunk_index': 0, 'content': 'Thị trường cạnh tranh hoàn toàn.\n\nThị trường cạnh tranh độc quyền.\n\nThị trường độc quyền hoàn toàn,…', 'url': '/documents/55?page=11&highlight=0'}
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 4 - Preview: Thị trường cạnh tranh hoàn toàn.

Thị trường cạnh tranh độc quyền.

Thị trường độc quyền hoàn toàn,…
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 132, 'chunk_index': 13, 'content': 'Thị trường độc quyền\tC. Thị trường cạnh tranh hoàn toàn', 'url': '/documents/55?page=132&highlight=13'}
2025-05-06 21:49:43 [app.services.api_service] INFO: Tài liệu 5 - Preview: Thị trường độc quyền	C. Thị trường cạnh tranh hoàn toàn
2025-05-06 21:49:43 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 21:49:45 [app.services.api_service] INFO: Google API response received in 2.56 seconds
2025-05-06 21:49:45 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 22:01:57 [app.services.api_service] INFO: Query gốc: 'Thị trường cạnh tranh độc quyền'
2025-05-06 22:02:00 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.016s
2025-05-06 22:02:00 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.09841758012771606, 0.04744909703731537, -0.05743949115276337, -0.037550050765275955, -0.07931232452392578]...
2025-05-06 22:02:00 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 22:02:00 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 22:02:00 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 22:02:00 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 113, 'chunk_index': 16, 'content': 'Đặc điểm thị trường cạnh tranh độc quyền', 'url': '/documents/55?page=113&highlight=16'}
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 1 - Preview: Đặc điểm thị trường cạnh tranh độc quyền
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 132, 'chunk_index': 16, 'content': 'Thị trường độc quyền .\tC. Thị trường cạnh tranh hoàn toàn', 'url': '/documents/55?page=132&highlight=16'}
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 2 - Preview: Thị trường độc quyền .	C. Thị trường cạnh tranh hoàn toàn
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 132, 'chunk_index': 24, 'content': 'Thị trường độc quyền nhóm\tD. Thị trường canh tranh độc quyền', 'url': '/documents/55?page=132&highlight=24'}
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 3 - Preview: Thị trường độc quyền nhóm	D. Thị trường canh tranh độc quyền
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 114, 'chunk_index': 7, 'content': 'Cân bằng thị trường cạnh tranh độc quyền', 'url': '/documents/55?page=114&highlight=7'}
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 4 - Preview: Cân bằng thị trường cạnh tranh độc quyền
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 133, 'chunk_index': 1, 'content': 'Thị trường độc quyền nhóm\tD. Thị trường canh tranh độc quyền', 'url': '/documents/55?page=133&highlight=1'}
2025-05-06 22:02:00 [app.services.api_service] INFO: Tài liệu 5 - Preview: Thị trường độc quyền nhóm	D. Thị trường canh tranh độc quyền
2025-05-06 22:02:00 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 22:02:01 [app.services.api_service] INFO: Google API response received in 1.32 seconds
2025-05-06 22:02:01 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 22:18:49 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 22:18:49 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:18:50 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 22:18:50 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:18:50 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 22:18:50 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 22:19:04 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 22:19:07 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 22:19:07 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 22:19:07 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 22:19:09 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 22:20:11 [app.services.api_service] INFO: Query gốc: 'nghiên cứu nền kinh tế'
2025-05-06 22:20:14 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.121s
2025-05-06 22:20:14 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.11894774436950684, 0.10237880796194077, 0.033012550324201584, -0.0038833962753415108, -0.07869989424943924]...
2025-05-06 22:20:14 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 22:20:14 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 22:20:14 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 22:20:14 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 1 - Preview: nghiên cứu của kinh tế chính trị.
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 6, 'chunk_index': 26, 'content': 'nghiệp (hay nền kinh tế) đã lựa chọn thực hiện khi doanh nghiệp (hay nền kinh tế) sử dụng hết một', 'url': '/documents/55?page=6&highlight=26'}
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 2 - Preview: nghiệp (hay nền kinh tế) đã lựa chọn thực hiện khi doanh nghiệp (hay nền kinh tế) sử dụng hết một
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 3, 'chunk_index': 26, 'content': 'nghiên cứu nền kinh tế như là một tổng thể thống nhất', 'url': '/documents/55?page=3&highlight=26'}
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 3 - Preview: nghiên cứu nền kinh tế như là một tổng thể thống nhất
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 4 - Preview: nghiên cứu trong các quan hệ kinh tế ở lĩnh vực nông
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1746404879_giao-trinh.txt', 'document_id': 47, 'title': 'GIÁO TRÌNH'}
2025-05-06 22:20:14 [app.services.api_service] INFO: Tài liệu 5 - Preview: họp khi nghiên cứu các khoa học kinh tế chuyên ngành
2025-05-06 22:20:14 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 22:20:16 [app.services.api_service] INFO: Google API response received in 2.41 seconds
2025-05-06 22:20:16 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 22:28:18 [app.services.api_service] INFO: Query gốc: 'Các yếu tố sản xuất là gì'
2025-05-06 22:28:22 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.019s
2025-05-06 22:28:22 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.029099108651280403, -0.03594297170639038, -0.019237011671066284, 0.008573701605200768, -0.0547434538602829]...
2025-05-06 22:28:22 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 22:28:22 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 22:28:22 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 22:28:22 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 12, 'chunk_index': 16, 'content': 'họ sẽ cung ứng các yếu tố này cho thị trường yếu tố sản xuất', 'url': '/documents/55?page=12&highlight=16'}
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 1 - Preview: họ sẽ cung ứng các yếu tố này cho thị trường yếu tố sản xuất
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 2 - Preview: mặt kinh tế giữa các chủ thể sản xuất hiện khách quan dựa
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 99, 'chunk_index': 2, 'content': 'tăng cầu các yếu tố sản xuất và không làm tăng giá các yếu tố đầu vào sản xuất', 'url': '/documents/55?page=99&highlight=2'}
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 3 - Preview: tăng cầu các yếu tố sản xuất và không làm tăng giá các yếu tố đầu vào sản xuất
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 15, 'content': 'Các yếu tố sản xuất khan hiếm tuyệt đối vì số lượng của các yếu tố là có giới hạn', 'url': '/documents/55?page=5&highlight=15'}
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 4 - Preview: Các yếu tố sản xuất khan hiếm tuyệt đối vì số lượng của các yếu tố là có giới hạn
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 10, 'content': '. Nên các yếu tố sản xuất luôn luôn khan hiếm.', 'url': '/documents/55?page=5&highlight=10'}
2025-05-06 22:28:22 [app.services.api_service] INFO: Tài liệu 5 - Preview: . Nên các yếu tố sản xuất luôn luôn khan hiếm.
2025-05-06 22:28:22 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 22:28:24 [app.services.api_service] INFO: Google API response received in 1.27 seconds
2025-05-06 22:28:24 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-07 05:36:08 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-07 05:36:08 [app.services.chatbot] INFO: System info: {'platform': 'Windows-10-10.0.26100-SP0', 'python_version': '3.10.6', 'cwd': 'D:\\ThucTap\\ChatBotKinhTe', 'log_file': 'D:\\ThucTap\\ChatBotKinhTe\\app.log', 'environment': 'Local', 'storage_dirs': ['D:\\ThucTap\\ChatBotKinhTe\\storage (exists, files: 1)', 'D:\\ThucTap\\ChatBotKinhTe\\web\\public\\storage (exists, files: 5)']}
2025-05-07 05:36:08 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-07 05:36:08 [app.services.api_service] INFO: System info: {'platform': 'Windows-10-10.0.26100-SP0', 'python_version': '3.10.6', 'cwd': 'D:\\ThucTap\\ChatBotKinhTe', 'log_file': 'D:\\ThucTap\\ChatBotKinhTe\\app.log', 'environment': 'Local', 'storage_dirs': ['D:\\ThucTap\\ChatBotKinhTe\\storage (exists, files: 1)', 'D:\\ThucTap\\ChatBotKinhTe\\web\\public\\storage (exists, files: 5)']}
2025-05-07 05:36:08 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-07 05:36:08 [app.services.chatbot] INFO: Initializing vector database...
2025-05-07 05:36:17 [app.services.chatbot] INFO: Loading vector database from ./vector_db
2025-05-07 05:36:18 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-07 05:36:18 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-07 05:36:18 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-07 05:36:20 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 22:38:48 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 22:38:48 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:38:48 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 22:38:48 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:38:48 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 22:38:48 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 22:39:06 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 22:39:08 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 22:39:08 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 22:39:08 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 22:39:09 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 22:40:16 [app.services.chatbot] ERROR: Lỗi khi truy vấn tài liệu 55: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).
2025-05-06 22:40:16 [app.services.chatbot] ERROR: Traceback (most recent call last):
  File "/app/app/services/chatbot.py", line 1210, in query_document_with_citation
    vector_store = FAISS.load_local(vector_dir, embeddings)
  File "/usr/local/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 1078, in load_local
    raise ValueError(
ValueError: The de-serialization relies loading a pickle file. Pickle files can be modified to deliver a malicious payload that results in execution of arbitrary code on your machine.You will need to set `allow_dangerous_deserialization` to `True` to enable deserialization. If you do this, make sure that you trust the source of the data. For example, if you are loading a file that you created, and no that no one else has modified the file, then this is safe to do. Do not set this to `True` if you are loading a file from an untrusted source (e.g., some random site on the internet.).

2025-05-06 22:40:16 [app.services.api_service] INFO: Query gốc: 'Quy luật khan hiếm'
2025-05-06 22:40:19 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.121s
2025-05-06 22:40:19 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.0859825611114502, 0.10135676711797714, 0.004191407468169928, 0.053022805601358414, -0.10554362088441849]...
2025-05-06 22:40:19 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 22:40:19 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 22:40:19 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 22:40:19 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 24, 'content': 'Quy luật khan hiếm và chi phí cơ hội', 'url': '/documents/55?page=5&highlight=24'}
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 1 - Preview: Quy luật khan hiếm và chi phí cơ hội
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 25, 'content': 'Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm', 'url': '/documents/55?page=5&highlight=25'}
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 2 - Preview: Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 10, 'content': '. Nên các yếu tố sản xuất luôn luôn khan hiếm.', 'url': '/documents/55?page=5&highlight=10'}
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 3 - Preview: . Nên các yếu tố sản xuất luôn luôn khan hiếm.
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 67, 'chunk_index': 36, 'content': 'tế khái quát thành quy luật và được gọi là quy luật năng suất biên giảm dần', 'url': '/documents/55?page=67&highlight=36'}
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 4 - Preview: tế khái quát thành quy luật và được gọi là quy luật năng suất biên giảm dần
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': 'data\\Bao_moi\\1879_Phát triển khai thác thủy sản hiệu quả bền vững và.txt'}
2025-05-06 22:40:19 [app.services.api_service] INFO: Tài liệu 5 - Preview: Khánh Phương
2025-05-06 22:40:19 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 22:40:21 [app.services.api_service] INFO: Google API response received in 2.07 seconds
2025-05-06 22:40:21 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 22:40:21 [app.services.api_service] INFO: Added 8 citations to the response
2025-05-07 05:52:10 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-07 05:52:10 [app.services.chatbot] INFO: System info: {'platform': 'Windows-10-10.0.26100-SP0', 'python_version': '3.10.6', 'cwd': 'D:\\ThucTap\\ChatBotKinhTe', 'log_file': 'D:\\ThucTap\\ChatBotKinhTe\\app.log', 'environment': 'Local', 'storage_dirs': ['D:\\ThucTap\\ChatBotKinhTe\\storage (exists, files: 1)', 'D:\\ThucTap\\ChatBotKinhTe\\web\\public\\storage (exists, files: 5)']}
2025-05-07 05:52:10 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-07 05:52:10 [app.services.api_service] INFO: System info: {'platform': 'Windows-10-10.0.26100-SP0', 'python_version': '3.10.6', 'cwd': 'D:\\ThucTap\\ChatBotKinhTe', 'log_file': 'D:\\ThucTap\\ChatBotKinhTe\\app.log', 'environment': 'Local', 'storage_dirs': ['D:\\ThucTap\\ChatBotKinhTe\\storage (exists, files: 1)', 'D:\\ThucTap\\ChatBotKinhTe\\web\\public\\storage (exists, files: 5)']}
2025-05-07 05:52:10 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-07 05:52:10 [app.services.chatbot] INFO: Initializing vector database...
2025-05-07 05:52:19 [app.services.chatbot] INFO: Loading vector database from ./vector_db
2025-05-07 05:52:20 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-07 05:52:20 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-07 05:52:20 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-07 05:52:22 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 22:54:44 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 22:54:44 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:54:44 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 22:54:44 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 22:54:44 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 22:54:44 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 22:55:00 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 22:55:03 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 22:55:03 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 22:55:03 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 22:55:04 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 23:28:51 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 23:28:51 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 23:28:51 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 23:28:51 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 23:28:51 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 23:28:51 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 23:29:09 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 23:29:16 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 23:29:16 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 23:29:16 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 23:29:17 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 23:34:34 [app.services.chatbot] INFO: Logger initialized: app.services.chatbot
2025-05-06 23:34:34 [app.services.chatbot] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 23:34:34 [app.services.api_service] INFO: Logger initialized: app.services.api_service
2025-05-06 23:34:34 [app.services.api_service] INFO: System info: {'platform': 'Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36', 'python_version': '3.10.17', 'cwd': '/app', 'log_file': '/app/app.log', 'environment': 'Docker', 'storage_dirs': ['/app/storage (exists, files: 1)', '/app/web/public/storage (exists, files: 5)']}
2025-05-06 23:34:34 [app.services.api_service] INFO: Initialized Google API service with model: gemini-2.0-flash
2025-05-06 23:34:34 [app.services.chatbot] INFO: Initializing vector database...
2025-05-06 23:34:49 [app.services.chatbot] INFO: Loading vector database from /app/vector_db
2025-05-06 23:34:52 [app.services.chatbot] INFO: Vector database loaded with 72132 vectors
2025-05-06 23:34:52 [app.services.chatbot] INFO: Vector database loaded and retriever configured with enhanced parameters
2025-05-06 23:34:52 [app.services.api_service] INFO: Initializing Gemini API with key: AIza...UdVw
2025-05-06 23:34:54 [app.services.api_service] INFO: Gemini API initialized successfully
2025-05-06 23:37:07 [app.services.api_service] INFO: Query gốc: 'dsadadadas'
2025-05-06 23:37:10 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.088s
2025-05-06 23:37:10 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.039135001599788666, 0.03642502799630165, -0.03504223749041557, -0.018884379416704178, -0.12126225978136063]...
2025-05-06 23:37:10 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 23:37:10 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 23:37:10 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 23:37:10 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'source': 'data\\Bao_moi\\52_Triển khai đồng bộ giải pháp thu ngân sách nhà nướ.txt'}
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 1 - Preview: MAI HOÀNG
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'source': 'data\\Vnexpress\\1591_Vàng rời mốc 3.000 USD, giá dầu xuống thấp nhất gầ.txt'}
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 2 - Preview: Tiểu Gu(theoReuters,Fortune,Kitco)
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 18, 'chunk_index': 35, 'content': 'Cầu thị trường', 'url': '/documents/55?page=18&highlight=35'}
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 3 - Preview: Cầu thị trường
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 124, 'chunk_index': 29, 'content': 'doanh nghiệp (1) với sản lượng doanh nghiệp (2): Q=Q1+Q2', 'url': '/documents/55?page=124&highlight=29'}
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 4 - Preview: doanh nghiệp (1) với sản lượng doanh nghiệp (2): Q=Q1+Q2
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 18, 'chunk_index': 29, 'content': 'Lượng cầu', 'url': '/documents/55?page=18&highlight=29'}
2025-05-06 23:37:10 [app.services.api_service] INFO: Tài liệu 5 - Preview: Lượng cầu
2025-05-06 23:37:10 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 23:37:12 [app.services.api_service] INFO: Google API response received in 1.69 seconds
2025-05-06 23:37:12 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 23:37:30 [app.services.api_service] INFO: Query gốc: 'Quy luật khan hiếm'
2025-05-06 23:37:33 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.015s
2025-05-06 23:37:33 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.0859825611114502, 0.10135676711797714, 0.004191407468169928, 0.053022805601358414, -0.10554362088441849]...
2025-05-06 23:37:33 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 23:37:33 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 23:37:33 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 23:37:33 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 24, 'content': 'Quy luật khan hiếm và chi phí cơ hội', 'url': '/documents/55?page=5&highlight=24'}
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 1 - Preview: Quy luật khan hiếm và chi phí cơ hội
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 25, 'content': 'Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm', 'url': '/documents/55?page=5&highlight=25'}
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 2 - Preview: Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 10, 'content': '. Nên các yếu tố sản xuất luôn luôn khan hiếm.', 'url': '/documents/55?page=5&highlight=10'}
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 3 - Preview: . Nên các yếu tố sản xuất luôn luôn khan hiếm.
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 67, 'chunk_index': 36, 'content': 'tế khái quát thành quy luật và được gọi là quy luật năng suất biên giảm dần', 'url': '/documents/55?page=67&highlight=36'}
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 4 - Preview: tế khái quát thành quy luật và được gọi là quy luật năng suất biên giảm dần
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': 'data\\Bao_moi\\1879_Phát triển khai thác thủy sản hiệu quả bền vững và.txt'}
2025-05-06 23:37:33 [app.services.api_service] INFO: Tài liệu 5 - Preview: Khánh Phương
2025-05-06 23:37:33 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 23:37:34 [app.services.api_service] INFO: Google API response received in 1.12 seconds
2025-05-06 23:37:34 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 23:37:49 [app.services.api_service] INFO: Query gốc: 'Khi quyết định lựa chọn, con người phải trả chi phí cơ hội cho sự lựa chọn đó'
2025-05-06 23:37:51 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.010s
2025-05-06 23:37:51 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.07331067323684692, -0.009529869072139263, 0.006565579678863287, 0.014193627052009106, -0.1063440591096878]...
2025-05-06 23:37:51 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 23:37:51 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 23:37:51 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 23:37:51 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 6, 'chunk_index': 3, 'content': 'Khi quyết định lựa chọn, con người phải trả chi phí cơ hội cho sự lựa chọn đó.', 'url': '/documents/55?page=6&highlight=3'}
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 1 - Preview: Khi quyết định lựa chọn, con người phải trả chi phí cơ hội cho sự lựa chọn đó.
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 126, 'chunk_index': 32, 'content': 'Chọn lựa giá để tối đa hóa lợi nhuận đối với sản phẩm có sự khác biệt', 'url': '/documents/55?page=126&highlight=32'}
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 2 - Preview: Chọn lựa giá để tối đa hóa lợi nhuận đối với sản phẩm có sự khác biệt
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 63, 'chunk_index': 13, 'content': 'để tối đa hóa sản lượng hoặc tối thiểu hóa chi phí cho doanh nghiệp', 'url': '/documents/55?page=63&highlight=13'}
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 3 - Preview: để tối đa hóa sản lượng hoặc tối thiểu hóa chi phí cho doanh nghiệp
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 70, 'chunk_index': 17, 'content': 'lượng sản phẩm đầu ra là lớn nhất với một chi phí cho trước', 'url': '/documents/55?page=70&highlight=17'}
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 4 - Preview: lượng sản phẩm đầu ra là lớn nhất với một chi phí cho trước
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 16, 'chunk_index': 22, 'content': '. Nếu chị Nga chọn phương án C thì chi phí cơ hội của phương án đó là:', 'url': '/documents/55?page=16&highlight=22'}
2025-05-06 23:37:51 [app.services.api_service] INFO: Tài liệu 5 - Preview: . Nếu chị Nga chọn phương án C thì chi phí cơ hội của phương án đó là:
2025-05-06 23:37:51 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 23:37:53 [app.services.api_service] INFO: Google API response received in 1.70 seconds
2025-05-06 23:37:53 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-06 23:57:52 [app.services.api_service] INFO: Query gốc: 'Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do'
2025-05-06 23:57:57 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.021s
2025-05-06 23:57:57 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.1214473694562912, 0.13579419255256653, 0.05802714824676514, 0.0010674974182620645, -0.04543335735797882]...
2025-05-06 23:57:57 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-06 23:57:57 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-06 23:57:57 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-06 23:57:57 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 5, 'chunk_index': 25, 'content': 'Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm', 'url': '/documents/55?page=5&highlight=25'}
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 1 - Preview: Quy luật khan hiếm: Kinh tế học nói rằng mọi nguồn lực đều hữu hạn do đó nó khan hiếm
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 2 - Preview: Quy luật kinh tế: Quy luật kinh té là những mối liên hệ
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 11, 'chunk_index': 11, 'content': 'Chủ thể kinh tế thứ nhất: Hộ gia đình', 'url': '/documents/55?page=11&highlight=11'}
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 3 - Preview: Chủ thể kinh tế thứ nhất: Hộ gia đình
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 19, 'chunk_index': 33, 'content': 'với ích lợi họ nhận được, hành vi này được lặp đi lặp lại ở mọi người mua', 'url': '/documents/55?page=19&highlight=33'}
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 4 - Preview: với ích lợi họ nhận được, hành vi này được lặp đi lặp lại ở mọi người mua
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-06 23:57:57 [app.services.api_service] INFO: Tài liệu 5 - Preview: khoa học mới - môn kinh tế chính trị. Tuy nhiên, tác phẩm
2025-05-06 23:57:57 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-06 23:57:58 [app.services.api_service] INFO: Google API response received in 0.91 seconds
2025-05-06 23:57:58 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-07 00:04:52 [app.services.api_service] INFO: Query gốc: 'giá gạo'
2025-05-07 00:04:55 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.011s
2025-05-07 00:04:55 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.12454856932163239, 0.054670680314302444, -0.059284742921590805, 0.03133486211299896, -0.028186583891510963]...
2025-05-07 00:04:55 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-07 00:04:55 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-07 00:04:55 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-07 00:04:55 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 17, 'chunk_index': 25, 'content': 'gạo, do đó, họ mặc nhiên coi giá lúa gạo là cho trước và chấp nhận giá', 'url': '/documents/55?page=17&highlight=25'}
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 1 - Preview: gạo, do đó, họ mặc nhiên coi giá lúa gạo là cho trước và chấp nhận giá
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 56, 'chunk_index': 24, 'content': 'giá sách', 'url': '/documents/55?page=56&highlight=24'}
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 2 - Preview: giá sách
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'source': 'data\\Bao_moi\\1528_Giá vàng hôm nay 124 Tăng mạnh gần 2 triệu đồnglượ.txt'}
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 3 - Preview: Lệ Giang
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'source': 'data\\Bao_moi\\110_Triển khai hiệu quả các chương trình tín dụng chín.txt'}
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 4 - Preview: Nguyễn Yến
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-07 00:04:55 [app.services.api_service] INFO: Tài liệu 5 - Preview: giáo trình các môn Lý luận Chính trị.
2025-05-07 00:04:55 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-07 00:04:56 [app.services.api_service] INFO: Google API response received in 1.10 seconds
2025-05-07 00:04:56 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-07 00:07:57 [app.services.api_service] INFO: Query gốc: 'phân tích thị trường chứng khoán'
2025-05-07 00:07:59 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.071s
2025-05-07 00:07:59 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.12589846551418304, 0.11871722340583801, -0.004907261114567518, -0.01973288133740425, -0.04331936687231064]...
2025-05-07 00:07:59 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-07 00:07:59 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-07 00:07:59 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-07 00:07:59 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 1 - Preview: triền và luận chứng vai trò lịch sừ của phương thức sàn
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'source': 'data\\thoi_bao_tai_chinh\\1246_Kinh tế vẫn chưa thoát khỏi khó khăn.txt'}
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 2 - Preview: Tính chung 4 tháng đầu năm 2023, có khoảng 76,8 nghìn doanh nghiệp rút lui khỏi thị trường.
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 126, 'chunk_index': 12, 'content': 'Thị trường chỉ có hai doanh nghiệp sản xuất những sản phẩm giống nhau, chúng có thể thay thế hoàn', 'url': '/documents/55?page=126&highlight=12'}
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 3 - Preview: Thị trường chỉ có hai doanh nghiệp sản xuất những sản phẩm giống nhau, chúng có thể thay thế hoàn
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 81, 'chunk_index': 13, 'content': 'cho chúng ta thấy điểm khác nhau quan trọng giữa phương pháp phân tích doanh nghiệp của nhà kinh tế', 'url': '/documents/55?page=81&highlight=13'}
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 4 - Preview: cho chúng ta thấy điểm khác nhau quan trọng giữa phương pháp phân tích doanh nghiệp của nhà kinh tế
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 132, 'chunk_index': 13, 'content': 'Thị trường độc quyền\tC. Thị trường cạnh tranh hoàn toàn', 'url': '/documents/55?page=132&highlight=13'}
2025-05-07 00:07:59 [app.services.api_service] INFO: Tài liệu 5 - Preview: Thị trường độc quyền	C. Thị trường cạnh tranh hoàn toàn
2025-05-07 00:07:59 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-07 00:08:01 [app.services.api_service] INFO: Google API response received in 1.74 seconds
2025-05-07 00:08:01 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-07 00:08:14 [app.services.api_service] INFO: Query gốc: 'đậu nành'
2025-05-07 00:08:17 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.009s
2025-05-07 00:08:17 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.041339389979839325, 0.08289994299411774, 0.007889976724982262, -0.031763434410095215, -0.013127291575074196]...
2025-05-07 00:08:17 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-07 00:08:17 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-07 00:08:17 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-07 00:08:17 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 20, 'chunk_index': 32, 'content': 'Đường cầu', 'url': '/documents/55?page=20&highlight=32'}
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 1 - Preview: Đường cầu
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 2 - Preview: những nhà hoạch định chính sách hình thành được năng lực,
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'source': 'data\\Bao_moi\\110_Triển khai hiệu quả các chương trình tín dụng chín.txt'}
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 3 - Preview: Nguyễn Yến
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 78, 'chunk_index': 8, 'content': '. Dẫn đến giá thành sản phẩm tăng.', 'url': '/documents/55?page=78&highlight=8'}
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 4 - Preview: . Dẫn đến giá thành sản phẩm tăng.
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'source': '/app/storage/documents/3/1745688872_giao-trinh.txt'}
2025-05-07 00:08:17 [app.services.api_service] INFO: Tài liệu 5 - Preview: mình. Từ đó mà xây dựng tu- duy và tầm nhìn, kỹ năng thực
2025-05-07 00:08:17 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-07 00:08:17 [app.services.api_service] INFO: Google API response received in 0.82 seconds
2025-05-07 00:08:17 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
2025-05-07 00:08:28 [app.services.api_service] INFO: Query gốc: 'lúa gạo'
2025-05-07 00:08:30 [app.services.api_service] INFO: API Service: Đã embedding câu hỏi thành vector kích thước 384, thời gian: 0.008s
2025-05-07 00:08:30 [app.services.api_service] INFO: Mẫu vector câu hỏi: [-0.10612981021404266, -0.004326512571424246, -0.059069517999887466, 0.034186363220214844, -0.016089921817183495]...
2025-05-07 00:08:30 [app.services.api_service] INFO: Sử dụng vector retriever để tìm kiếm: VectorStoreRetriever
2025-05-07 00:08:30 [app.services.api_service] INFO: Sử dụng phương thức get_relevant_documents
2025-05-07 00:08:30 [app.services.api_service] INFO: Tìm thấy 8 tài liệu
2025-05-07 00:08:30 [app.services.api_service] INFO: Tìm thấy 8 tài liệu liên quan từ vector database
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 1 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 18, 'chunk_index': 29, 'content': 'Lượng cầu', 'url': '/documents/55?page=18&highlight=29'}
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 1 - Preview: Lượng cầu
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 2 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 60, 'chunk_index': 24, 'content': 'hơn hiệu ứng thay thế nên người tiêu dùng sẽ mua nhiều gạo hơn khi giá gạo tăng', 'url': '/documents/55?page=60&highlight=24'}
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 2 - Preview: hơn hiệu ứng thay thế nên người tiêu dùng sẽ mua nhiều gạo hơn khi giá gạo tăng
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 3 - Metadata: {'source': 'data\\Vnexpress\\44_Giá lúa, gạo giảm.txt'}
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 3 - Preview: TITLE: Giá lúa, gạo giảm

URL: https://vnexpress.net/gia-lua-gao-giam-4802434.html

PUBLICATION DATE: 2024-10-11 10:03:00

CONTENT:

Ấn Độ bỏ lệnh cấm...
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 4 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 99, 'chunk_index': 6, 'content': '. Doanh nghiệp tăng sản lượng sản xuất, sản lượng của ngành tăng', 'url': '/documents/55?page=99&highlight=6'}
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 4 - Preview: . Doanh nghiệp tăng sản lượng sản xuất, sản lượng của ngành tăng
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 5 - Metadata: {'doc_id': 55, 'source': '1746563688_bai-giang-kinh-te-vi-mo-1.docx', 'page_num': 17, 'chunk_index': 25, 'content': 'gạo, do đó, họ mặc nhiên coi giá lúa gạo là cho trước và chấp nhận giá', 'url': '/documents/55?page=17&highlight=25'}
2025-05-07 00:08:30 [app.services.api_service] INFO: Tài liệu 5 - Preview: gạo, do đó, họ mặc nhiên coi giá lúa gạo là cho trước và chấp nhận giá
2025-05-07 00:08:30 [app.services.api_service] INFO: Sending request to Google API: gemini-2.0-flash
2025-05-07 00:08:33 [app.services.api_service] INFO: Google API response received in 3.11 seconds
2025-05-07 00:08:33 [app.services.api_service] INFO: Nhận phản hồi từ Gemini API (gemini-2.0-flash)
